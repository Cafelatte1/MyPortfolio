{"cells":[{"cell_type":"markdown","source":["# RAPIDS Install"],"metadata":{"id":"bi5RrJ13y11C"}},{"cell_type":"code","source":["# # This get the RAPIDS-Colab install files and test check your GPU.  Run this and the next cell only.\n","# # Please read the output of this cell.  If your Colab Instance is not RAPIDS compatible, it will warn you and give you remediation steps.\n","# !git clone https://github.com/rapidsai/rapidsai-csp-utils.git\n","# !python rapidsai-csp-utils/colab/env-check.py\n","\n","# # This will update the Colab environment and restart the kernel.  Don't run the next cell until you see the session crash.\n","# !bash rapidsai-csp-utils/colab/update_gcc.sh\n","# import os\n","# os._exit(00)"],"metadata":{"id":"8ZgKeE-8y1cN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # This will install CondaColab.  This will restart your kernel one last time.  Run this cell by itself and only run the next cell once you see the session crash.\n","# import condacolab\n","# condacolab.install()"],"metadata":{"id":"cv_mXDu0y8Qh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # you can now run the rest of the cells as normal\n","# import condacolab\n","# condacolab.check()\n","\n","# # Installing RAPIDS is now 'python rapidsai-csp-utils/colab/install_rapids.py <release> <packages>'\n","# # The <release> options are 'stable' and 'nightly'.  Leaving it blank or adding any other words will default to stable.\n","# !python rapidsai-csp-utils/colab/install_rapids.py stable"],"metadata":{"id":"p4oHwlRIy-b2"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"4kPoYaEW-VNV"},"source":["# matplot korean patch"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2v3KXqwH-U4h"},"outputs":[],"source":["# !sudo apt-get install -y fonts-nanum\n","# !sudo fc-cache -fv\n","# !rm ~/.cache/matplotlib -rf\n","# os.kill(os.getpid(), 9)"]},{"cell_type":"markdown","metadata":{"id":"1YabxNE7gPsR"},"source":["# install packages"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wL_iJtS1gPZ-"},"outputs":[],"source":["import os\n","# python global seed\n","os.environ['PYTHONHASHSEED'] = str(42)\n","# tensorflow seed (not working for GPU)\n","# os.environ['TF_DETERMINISTIC_OPS'] = '1'\n","# os.environ['TF_CUDNN_DETERMINISTIC'] = '1'\n","# RAPIDS config\n","os.environ['NUMBAPRO_NVVM'] = '/usr/local/cuda/nvvm/lib64/libnvvm.so'\n","os.environ['NUMBAPRO_LIBDEVICE'] = '/usr/local/cuda/nvvm/libdevice/'\n","os.environ['CONDA_PREFIX'] = '/usr/local'\n","# weight and bias\n","os.environ[\"WANDB_API_KEY\"] = \"6f810b088fcc6b9eaaa56c1e52cfd37836606240\""]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":49453,"status":"ok","timestamp":1652569429732,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"0wAbq2XKgPXx","outputId":"25a8de92-625c-483f-b106-4673fc9bf6ae"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n","\u001b[K     |████████████████████████████████| 462 kB 10.3 MB/s \n","\u001b[K     |████████████████████████████████| 85 kB 3.9 MB/s \n","\u001b[K     |████████████████████████████████| 1.1 MB 8.3 MB/s \n","\u001b[K     |████████████████████████████████| 133 kB 8.3 MB/s \n","\u001b[K     |████████████████████████████████| 308 kB 6.9 MB/s \n","\u001b[K     |████████████████████████████████| 81 kB 11.4 MB/s \n","\u001b[K     |████████████████████████████████| 210 kB 87.5 MB/s \n","\u001b[K     |████████████████████████████████| 78 kB 7.3 MB/s \n","\u001b[K     |████████████████████████████████| 146 kB 72.2 MB/s \n","\u001b[K     |████████████████████████████████| 49 kB 7.3 MB/s \n","\u001b[K     |████████████████████████████████| 112 kB 86.4 MB/s \n","\u001b[?25h  Building wheel for pyperclip (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[K     |████████████████████████████████| 1.8 MB 8.1 MB/s \n","\u001b[K     |████████████████████████████████| 181 kB 89.1 MB/s \n","\u001b[K     |████████████████████████████████| 145 kB 86.6 MB/s \n","\u001b[K     |████████████████████████████████| 63 kB 2.0 MB/s \n","\u001b[?25h  Building wheel for pathtools (setup.py) ... \u001b[?25l\u001b[?25hdone\n","\u001b[K     |████████████████████████████████| 49 kB 3.8 MB/s \n","\u001b[?25h"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')\n","# TextVectorization layer in tf 2.6 don't support \"sparse=True\" option which is used on TF-IDF\n","# !pip install -q tensorflow==2.6\n","!pip install -q tensorflow==2.8\n","!pip install -q tensorflow-recommenders==0.6\n","# !pip install -q scann==1.2.3\n","!pip install -q tensorflow-datasets\n","!pip install -q tensorflow-addons\n","!pip install -q tensorflow-hub\n","!pip install -q keras-tuner\n","!pip install -q statsmodels\n","!pip install -q optuna\n","!pip install -q wandb\n","!pip install -q missingpy"]},{"cell_type":"markdown","metadata":{"id":"JNEEXszigDeY"},"source":["# loading libraries"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EPAeXXs4mN37"},"outputs":[],"source":["def config_missingpy():\n","    try:\n","        with open(\"/usr/local/lib/python3.7/site-packages/missingpy/knnimpute.py\", 'r') as file:\n","        # read a list of lines into data\n","            data = file.readlines()\n","            # now change the 2nd line, note that you have to add a newline\n","            data[12] = 'from sklearn.neighbors._base import _check_weights\\n'\n","            data[13] = 'from sklearn.neighbors._base import _get_weights\\n'\n","        # and write everything back\n","        with open(\"/usr/local/lib/python3.7/site-packages/missingpy/knnimpute.py\", 'w') as file:\n","            file.writelines(data)\n","    except:\n","        print(\"path error : /usr/local/lib/python3.7/site-packages/missingpy/knnimpute.py\")\n","    try:\n","        with open(\"/usr/local/lib/python3.7/dist-packages/missingpy/knnimpute.py\", 'r') as file:\n","        # read a list of lines into data\n","            data = file.readlines()\n","            # now change the 2nd line, note that you have to add a newline\n","            data[12] = 'from sklearn.neighbors._base import _check_weights\\n'\n","            data[13] = 'from sklearn.neighbors._base import _get_weights\\n'\n","        # and write everything back\n","        with open(\"/usr/local/lib/python3.7/dist-packages/missingpy/knnimpute.py\", 'w') as file:\n","            file.writelines(data)\n","    except:\n","        print(\"path error : /usr/local/lib/python3.7/site-packages/missingpy/knnimpute.py\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9198,"status":"ok","timestamp":1652569438925,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"OWBG0B0-fyWo","outputId":"c907993d-32c3-4d39-87d0-a7a4cea1ce2f"},"outputs":[{"output_type":"stream","name":"stdout","text":["path error : /usr/local/lib/python3.7/site-packages/missingpy/knnimpute.py\n","RAPIDS Import ERROR\n","matplotlib korean patch failed\n","Found GPU at: /device:GPU:0\n"]}],"source":["import sys\n","import shutil\n","from glob import glob\n","from IPython.display import Image, display\n","import gc\n","import wandb\n","from scipy import stats\n","from scipy.special import boxcox\n","\n","from multiprocessing import cpu_count\n","import copy\n","import pickle\n","import warnings\n","from datetime import datetime, timedelta\n","from time import time, sleep, mktime\n","from matplotlib import font_manager as fm, rc, rcParams\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","from tqdm import tqdm\n","import re\n","import random as rnd\n","import psutil\n","from optuna import Trial, create_study\n","from optuna.samplers import TPESampler\n","\n","import numpy as np\n","from numpy import array, nan, random as np_rnd, where\n","import pandas as pd\n","from pandas import DataFrame as dataframe, Series as series, isna, read_csv\n","from pandas.tseries.offsets import DateOffset\n","\n","from sklearn.model_selection import train_test_split as tts, StratifiedKFold, StratifiedShuffleSplit\n","from sklearn.preprocessing import LabelEncoder, OneHotEncoder, StandardScaler, MinMaxScaler, RobustScaler, KBinsDiscretizer\n","from sklearn import metrics\n","from sklearn.compose import ColumnTransformer\n","from sklearn.cluster import KMeans as skl_kmeans\n","from sklearn.metrics import silhouette_score as skl_silhouette_score\n","config_missingpy(); from missingpy import MissForest\n","from sklearn.impute import KNNImputer\n","from optuna import Trial, create_study\n","\n","try:\n","    import cudf as cd\n","    import cupy as cp\n","    from cuml.cluster import KMeans\n","    from cuml.neighbors import NearestNeighbors\n","    from cuml.metrics.cluster import silhouette_score\n","except:\n","    print(\"RAPIDS Import ERROR\")\n","\n","# ===== tensorflow =====\n","import tensorflow as tf\n","from tensorflow import random as tf_rnd\n","from tensorflow.keras.models import Model\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras import layers\n","from tensorflow.keras import activations\n","from tensorflow.keras import optimizers\n","from tensorflow.keras import metrics as tf_metrics\n","from tensorflow.keras import callbacks as tf_callbacks\n","from tqdm.keras import TqdmCallback\n","import tensorflow_addons as tfa\n","from tensorflow.keras.utils import plot_model\n","from keras.utils.layer_utils import count_params\n","\n","# import keras_tuner as kt\n","# from keras_tuner import HyperModel\n","import tensorflow_hub as tf_hub\n","import tensorflow_recommenders as tfrs\n","\n","warnings.filterwarnings(action='ignore')\n","rcParams['axes.unicode_minus'] = False\n","pd.set_option('display.max_columns', 100)\n","pd.set_option('display.max_rows', 100)\n","pd.set_option('display.width', 1000)\n","pd.set_option('max_colwidth', 200)\n","plt.rc('font', family='NanumSquareB')\n","\n","# font setting\n","try:\n","    font_path = '/usr/share/fonts/truetype/nanum/NanumSquareB.ttf'\n","    font_obj = fm.FontProperties(fname=font_path, size=12).get_name()\n","    rc('font', family=font_obj)\n","except:\n","    print(\"matplotlib korean patch failed\")\n","\n","# GPU check\n","device_name = tf.test.gpu_device_name()\n","if device_name != '/device:GPU:0':\n","    print('GPU device not found')\n","else:\n","    print('Found GPU at: {}'.format(device_name))\n","\n","# GPU memory setting\n","gpus = tf.config.list_physical_devices('GPU')\n","if gpus:\n","  try:\n","    tf.config.experimental.set_memory_growth(gpus[0], True)\n","  except RuntimeError as e:\n","    print(e)"]},{"cell_type":"markdown","metadata":{"id":"NAhgen7zgmM5"},"source":["# loading custom functions"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"36xRk64Rgmdu"},"outputs":[],"source":["# ===== utility functions =====\n","# label encoding for categorical column with excepting na value\n","def seed_everything(seed=42):\n","    # python random module\n","    rnd.seed(seed)\n","    # numpy random\n","    np_rnd.seed(seed)\n","    # tf random\n","    tf_rnd.set_seed(seed)\n","    # RAPIDS random\n","    try:\n","        cp.random.seed(seed)\n","    except:\n","        pass\n","def which(bool_list):\n","    return where(bool_list)[0]\n","def easyIO(x=None, path=None, op=\"r\"):\n","    tmp = None\n","    if op == \"r\":\n","        with open(path, \"rb\") as f:\n","            tmp = pickle.load(f)\n","        return tmp\n","    elif op == \"w\":\n","        with open(path, \"wb\") as f:\n","            pickle.dump(x, f)\n","    else:\n","        print(\"Unknown operation type\")\n","def diff(first, second):\n","    second = set(second)\n","    return [item for item in first if item not in second]\n","def findIdx(data_x, col_names):\n","    return [int(i) for i, j in enumerate(data_x) if j in col_names]\n","def orderElems(for_order, using_ref):\n","    return [i for i in using_ref if i in for_order]\n","# concatenate by row\n","def cbr(df1, df2):\n","    if type(df1) == series:\n","        tmp_concat = series(pd.concat([dataframe(df1), dataframe(df2)], axis=0, ignore_index=True).iloc[:,0])\n","        tmp_concat.reset_index(drop=True, inplace=True)\n","    elif type(df1) == dataframe:\n","        tmp_concat = pd.concat([df1, df2], axis=0, ignore_index=True)\n","        tmp_concat.reset_index(drop=True, inplace=True)\n","    elif type(df1) == np.ndarray:\n","        tmp_concat = np.concatenate([df1, df2], axis=0)\n","    else:\n","        print(\"Unknown Type: return 1st argument\")\n","        tmp_concat = df1\n","    return tmp_concat\n","def change_width(ax, new_value):\n","    for patch in ax.patches :\n","        current_width = patch.get_width()\n","        adj_value = current_width - new_value\n","        # we change the bar width\n","        patch.set_width(new_value)\n","        # we recenter the bar\n","        patch.set_x(patch.get_x() + adj_value * .5)\n","def week_of_month(date):\n","    month = date.month\n","    week = 0\n","    while date.month == month:\n","        week += 1\n","        date -= timedelta(days=7)\n","    return week\n","def getSeason(date):\n","    month = date.month\n","    if month in [3, 4, 5]:\n","        return \"Spring\"\n","    elif month in [6, 7, 8]:\n","        return \"Summer\"\n","    elif month in [9, 10, 11]:\n","        return \"Fall\"\n","    else:\n","        return \"Winter\"\n","def createFolder(directory):\n","    try:\n","        if not os.path.exists(directory):\n","            os.makedirs(directory)\n","    except OSError:\n","        print('Error: Creating directory. ' + directory)\n","def softmax(x):\n","    max = np.max(x, axis=1, keepdims=True)  # returns max of each row and keeps same dims\n","    e_x = np.exp(x - max)  # subtracts each row with its max value\n","    sum = np.sum(e_x, axis=1, keepdims=True)  # returns sum of each row and keeps same dims\n","    f_x = e_x / sum\n","    return f_x\n","def sigmoid(x):\n","    return 1/(1 + np.exp(-x))\n","def dispPerformance(result_dic):\n","    perf_table = dataframe()\n","    index_names = []\n","    for k, v in result_dic.items():\n","        index_names.append(k)\n","        perf_table = pd.concat([perf_table, series(v[\"performance\"]).to_frame().T], ignore_index=True, axis=0)\n","    perf_table.index = index_names\n","    perf_table.sort_values(perf_table.columns[0], inplace=True)\n","    print(perf_table)\n","    return perf_table\n","def powspace(start, stop, power, num):\n","    start = np.power(start, 1/float(power))\n","    stop = np.power(stop, 1/float(power))\n","    return np.power(np.linspace(start, stop, num=num), power)\n","def xgb_custom_lossfunction(alpha = 1):\n","    def support_under_mse(label, pred):\n","        # grad : 1차 미분\n","        # hess : 2차 미분\n","        residual = (label - pred).astype(\"float\")\n","        grad = np.where(residual > 0, -2 * alpha * residual, -2 * residual)\n","        hess = np.where(residual > 0, 2 * alpha, 2.0)\n","        return grad, hess\n","    return support_under_mse\n","def pd_flatten(df):\n","    df = df.unstack()\n","    df.index = [str(i) + \"_\" + str(j) for i, j in df.index]\n","    return df\n","def tf_losses_rmse(y_true, y_pred, sample_weight=None):\n","    return tf.sqrt(tf.reduce_mean((y_true - y_pred) ** 2)) if sample_weight is None else tf.sqrt(tf.reduce_mean(((y_true - y_pred) ** 2) * sample_weight))\n","def tf_loss_nmae(y_true, y_pred, sample_weight=False):\n","    mae = tf.reduce_mean(tf.math.abs(y_true - y_pred))\n","    score = tf.math.divide(mae, tf.reduce_mean(tf.math.abs(y_true)))\n","    return score\n","def text_extractor(string, lang=\"eng\", spacing=True):\n","    # # 괄호를 포함한 괄호 안 문자 제거 정규식\n","    # re.sub(r'\\([^)]*\\)', '', remove_text)\n","    # # <>를 포함한 <> 안 문자 제거 정규식\n","    # re.sub(r'\\<[^)]*\\>', '', remove_text)\n","    if lang == \"eng\":\n","        text_finder = re.compile('[^ A-Za-z]') if spacing else re.compile('[^A-Za-z]')\n","    elif lang == \"kor\":\n","        text_finder = re.compile('[^ ㄱ-ㅣ가-힣+]') if spacing else re.compile('[^ㄱ-ㅣ가-힣+]')\n","    # default : kor + eng\n","    else:\n","        text_finder = re.compile('[^ A-Za-zㄱ-ㅣ가-힣+]') if spacing else re.compile('[^A-Za-zㄱ-ㅣ가-힣+]')\n","    return text_finder.sub('', string)\n","def memory_usage(message='debug'):\n","    # current process RAM usage\n","    p = psutil.Process()\n","    rss = p.memory_info().rss / 2 ** 20 # Bytes to MB\n","    print(f\"[{message}] memory usage: {rss: 10.3f} MB\")\n","    return rss\n","class MyLabelEncoder:\n","    def __init__(self, preset={}):\n","        # dic_cat format -> {\"col_name\": {\"value\": replace}}\n","        self.dic_cat = preset\n","    def fit_transform(self, data_x, col_names):\n","        tmp_x = copy.deepcopy(data_x)\n","        for i in col_names:\n","            # if key is not in dic, update dic\n","            if i not in self.dic_cat.keys():\n","                tmp_dic = dict.fromkeys(sorted(set(tmp_x[i]).difference([nan])))\n","                label_cnt = 0\n","                for j in tmp_dic.keys():\n","                    tmp_dic[j] = label_cnt\n","                    label_cnt += 1\n","                self.dic_cat[i] = tmp_dic\n","            # transform value which is not in dic to nan\n","            tmp_x[i] = tmp_x[i].astype(\"object\")\n","            conv = tmp_x[i].replace(self.dic_cat[i])\n","            for conv_idx, j in enumerate(conv):\n","                if j not in self.dic_cat[i].values():\n","                    conv[conv_idx] = nan\n","            # final return\n","            tmp_x[i] = conv.astype(\"float\")\n","        return tmp_x\n","    def transform(self, data_x):\n","        tmp_x = copy.deepcopy(data_x)\n","        for i in self.dic_cat.keys():\n","            # transform value which is not in dic to nan\n","            tmp_x[i] = tmp_x[i].astype(\"object\")\n","            conv = tmp_x[i].replace(self.dic_cat[i])\n","            for conv_idx, j in enumerate(conv):\n","                if j not in self.dic_cat[i].values():\n","                    conv[conv_idx] = nan\n","            # final return\n","            tmp_x[i] = conv.astype(\"float\")\n","        return tmp_x\n","    def clear(self):\n","        self.dic_cat = {}\n","class MyOneHotEncoder:\n","    def __init__(self, label_preset={}):\n","        self.dic_cat = {}\n","        self.label_preset = label_preset\n","    def fit_transform(self, data_x, col_names):\n","        tmp_x = dataframe()\n","        for i in data_x:\n","            if i not in col_names:\n","                tmp_x = pd.concat([tmp_x, dataframe(data_x[i])], axis=1)\n","            else:\n","                if not ((data_x[i].dtype.name == \"object\") or (data_x[i].dtype.name == \"category\")):\n","                    print(F\"WARNING : {i} is not object or category\")\n","                self.dic_cat[i] = OneHotEncoder(sparse=False, handle_unknown=\"ignore\")\n","                conv = self.dic_cat[i].fit_transform(dataframe(data_x[i])).astype(\"int\")\n","                col_list = []\n","                for j in self.dic_cat[i].categories_[0]:\n","                    if i in self.label_preset.keys():\n","                        for k, v in self.label_preset[i].items():\n","                            if v == j:\n","                                col_list.append(str(i) + \"_\" + str(k))\n","                    else:\n","                        col_list.append(str(i) + \"_\" + str(j))\n","                conv = dataframe(conv, columns=col_list)\n","                tmp_x = pd.concat([tmp_x, conv], axis=1)\n","        return tmp_x\n","    def transform(self, data_x):\n","        tmp_x = dataframe()\n","        for i in data_x:\n","            if not i in list(self.dic_cat.keys()):\n","                tmp_x = pd.concat([tmp_x, dataframe(data_x[i])], axis=1)\n","            else:\n","                if not ((data_x[i].dtype.name == \"object\") or (data_x[i].dtype.name == \"category\")):\n","                    print(F\"WARNING : {i} is not object or category\")\n","                conv = self.dic_cat[i].transform(dataframe(data_x[i])).astype(\"int\")\n","                col_list = []\n","                for j in self.dic_cat[i].categories_[0]:\n","                    if i in self.label_preset.keys():\n","                        for k, v in self.label_preset[i].items():\n","                            if v == j: col_list.append(str(i) + \"_\" + str(k))\n","                    else:\n","                        col_list.append(str(i) + \"_\" + str(j))\n","                conv = dataframe(conv, columns=col_list)\n","                tmp_x = pd.concat([tmp_x, conv], axis=1)\n","        return tmp_x\n","    def clear(self):\n","        self.dic_cat = {}\n","        self.label_preset = {}\n","class MyKNNImputer:\n","    def __init__(self, k=5):\n","        self.imputer = KNNImputer(n_neighbors=k)\n","        self.dic_cat = {}\n","    def fit_transform(self, x, cat_vars=None):\n","        if cat_vars is None:\n","            x_imp = dataframe(self.imputer.fit_transform(x), columns=x.columns)\n","        else:\n","            naIdx = dict.fromkeys(cat_vars)\n","            for i in cat_vars:\n","                self.dic_cat[i] = diff(list(sorted(set(x[i]))), [nan])\n","                naIdx[i] = list(which(array(x[i].isna())))\n","            x_imp = dataframe(self.imputer.fit_transform(x), columns=x.columns)\n","\n","            # if imputed categorical value are not in the range, adjust the value\n","            for i in cat_vars:\n","                x_imp[i] = x_imp[i].apply(lambda x: int(round(x, 0)))\n","                for j in naIdx[i]:\n","                    if x_imp[i][j] not in self.dic_cat[i]:\n","                        if x_imp[i][j] < self.dic_cat[i][0]:\n","                            x_imp[i][naIdx[i]] = self.dic_cat[i][0]\n","                        elif x_imp[i][j] > self.dic_cat[i][0]:\n","                            x_imp[i][naIdx[i]] = self.dic_cat[i][len(self.dic_cat[i]) - 1]\n","        return x_imp\n","    def transform(self, x):\n","        if len(self.dic_cat.keys()) == 0:\n","            x_imp = dataframe(self.imputer.transform(x), columns=x.columns)\n","        else:\n","            naIdx = dict.fromkeys(self.dic_cat.keys())\n","            for i in self.dic_cat.keys():\n","                naIdx[i] = list(which(array(x[i].isna())))\n","            x_imp = dataframe(self.imputer.transform(x), columns=x.columns)\n","\n","            # if imputed categorical value are not in the range, adjust the value\n","            for i in self.dic_cat.keys():\n","                x_imp[i] = x_imp[i].apply(lambda x: int(round(x, 0)))\n","                for j in naIdx[i]:\n","                    if x_imp[i][j] not in self.dic_cat[i]:\n","                        if x_imp[i][j] < self.dic_cat[i][0]:\n","                            x_imp[i][naIdx[i]] = self.dic_cat[i][0]\n","                        elif x_imp[i][j] > self.dic_cat[i][0]:\n","                            x_imp[i][naIdx[i]] = self.dic_cat[i][len(self.dic_cat[i]) - 1]\n","        return x_imp\n","    def clear(self):\n","        self.imputer = None\n","        self.dic_cat = {}\n","def remove_outlier(df, std=3, mode=\"remove\"):\n","    tmp_df = df.copy()\n","    if mode == \"remove\":\n","        outlier_mask = (np.abs(stats.zscore(tmp_df)) > std).all(axis=1)\n","        print(\"found outlier :\", outlier_mask.sum())\n","        tmp_df = tmp_df[~outlier_mask]\n","    elif mode == \"interpolate\":\n","        tmp_outlier = []\n","        for i in tmp_df:\n","            outlier_mask = (np.abs(stats.zscore(tmp_df[i])) > std)\n","            tmp_outlier.append(outlier_mask.sum())\n","            if tmp_outlier[-1] == 0:\n","                continue\n","            tmp_df[i][outlier_mask] = np.nan\n","            tmp_df[i] = tmp_df[i].interpolate(method='linear').bfill()\n","        print(\"found outlier :\", np.sum(outlier_mask))\n","    return tmp_df\n","\n","seed_everything()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4vbCHUCqp5gj"},"outputs":[],"source":["# class RandomCropAndResize(tf.keras.layers.Layer):\n","#     def __init__(self, crop_ratio=0.8, resize_img_size=128, resize_channels=3, **kwargs):\n","#         super(RandomCropAndResize, self).__init__(**kwargs)\n","#         self.img_size = resize_img_size\n","#         self.channels = resize_channels\n","#         self.crop_size = int(self.img_size * self.crop_ratio)\n","#     def call(self, input_image, training=False):\n","#         if training:\n","#             input_image = tf.image.random_crop(input_image, [self.crop_size, self.crop_size, self.channels])\n","#             input_image = tf.image.resize(input_image, [self.resize_img_size, self.resize_img_size])\n","#             return input_image\n","#         else:\n","#             return input_image\n","#     def get_config(self):\n","#         config = super().get_config()\n","#         config.update({\n","#             \"img_size\": self.img_size,\n","#             \"channels\": self.channels,\n","#             \"crop_size\": self.crop_size\n","#         })\n","#         return config\n","def RandomAngleDistortion(zoom_factor=0.25, rotation_factor=0.25, flip_type=\"horizontal_and_vertical\", flip_flag=True, seed=42):\n","    if flip_flag:\n","        model = Sequential([\n","            layers.RandomZoom(zoom_factor, zoom_factor, seed=seed),\n","            layers.RandomRotation(factor=(-rotation_factor, rotation_factor)),\n","            layers.RandomFlip(mode=flip_type, seed=seed)\n","        ])\n","    else:\n","        model = Sequential([\n","            layers.RandomZoom(zoom_factor, zoom_factor, seed=seed),\n","            layers.RandomRotation(factor=(-rotation_factor, rotation_factor))\n","        ]) \n","    return model\n","class RandomColorDistortion(tf.keras.layers.Layer):\n","    def __init__(self, saturation_factor=(0.75, 1.25), contrast_factor=(0.75, 1.25), brightness_factor=0.25, hue_factor=0.25, hue_flag=True, seed=42, **kwargs):\n","        super(RandomColorDistortion, self).__init__(**kwargs)\n","        self.saturation_factor = saturation_factor\n","        self.contrast_factor = contrast_factor\n","        self.brightness_factor = brightness_factor\n","        self.hue_factor = hue_factor\n","        self.hue_flag = hue_flag\n","        self.seed = seed\n","    def call(self, input_image, training=False):\n","        if training:\n","            input_image = tf.image.random_saturation(input_image, self.saturation_factor[0], self.saturation_factor[1])\n","            input_image = tf.image.random_contrast(input_image, self.contrast_factor[0], self.contrast_factor[1])\n","            input_image = tf.image.random_brightness(input_image, self.brightness_factor)\n","            input_image = tf.image.random_hue(input_image, self.hue_factor) if self.hue_flag else input_image\n","            return input_image\n","        else:\n","            return input_image\n","    def get_config(self):\n","        config = super().get_config()\n","        config.update({\n","            \"saturation_factor\": self.saturation_factor,\n","            \"contrast_factor\": self.contrast_factor,\n","            \"brightness_factor\": self.brightness_factor,\n","            \"hue_factor\": self.hue_factor,\n","            \"hue_flag\": self.hue_flag,\n","            \"seed\": self.seed,\n","        })\n","        return config\n","# class RandomColorDistortion(tf.keras.layers.Layer):\n","#     def __init__(self, saturation_factor=(0.75, 1.25), contrast_factor=(0.75, 1.25), brightness_factor=0.25, hue_factor=0.25, hue_flag=True, seed=(42,42), **kwargs):\n","#         super(RandomColorDistortion, self).__init__(**kwargs)\n","#         self.saturation_factor = saturation_factor\n","#         self.contrast_factor = contrast_factor\n","#         self.brightness_factor = brightness_factor\n","#         self.hue_factor = hue_factor\n","#         self.hue_flag = hue_flag\n","#         self.seed = seed\n","#     def call(self, input_image, training=False):\n","#         if training:\n","#             input_image = tf.image.stateless_random_saturation(input_image, self.saturation_factor[0], self.saturation_factor[1], seed=self.seed)\n","#             input_image = tf.image.stateless_random_contrast(input_image, self.contrast_factor[0], self.contrast_factor[1], seed=self.seed)\n","#             input_image = tf.image.stateless_random_brightness(input_image, self.brightness_factor, seed=self.seed)\n","#             input_image = tf.image.stateless_random_hue(input_image, self.hue_factor, seed=self.seed) if self.hue_flag else input_image\n","#             return input_image\n","#         else:\n","#             return input_image\n","#     def get_config(self):\n","#         config = super().get_config()\n","#         config.update({\n","#             \"saturation_factor\": self.saturation_factor,\n","#             \"contrast_factor\": self.contrast_factor,\n","#             \"brightness_factor\": self.brightness_factor,\n","#             \"hue_factor\": self.hue_factor,\n","#             \"hue_flag\": self.hue_flag,\n","#             \"seed\": self.seed\n","#         })\n","#         return config"]},{"cell_type":"markdown","metadata":{"id":"gVw1gnJSgDuR"},"source":["# loading datasets"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gUFRmUn74904"},"outputs":[],"source":["# 시간별 데이터 압축 방법 - 아이디어\n","# flatten\n","# 이동평균 flatten\n","# max\n","# min\n","# avg\n","# median\n","# 절삭 평균 (n% 극단값 제거 후 평균)\n","# 변화율\n","# 모델 ftting 후 해당 모델의 파라미터 값 (ex. 선형회귀모델의 계수, 절편)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ay7GYh9-k4Eh"},"outputs":[],"source":["folder_path = \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/\"\n","seed_everything()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"-zwFwDdabVs0"},"outputs":[],"source":["root_path_train = \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/train_test_set/train/\"\n","root_path_test = \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/train_test_set/test/\"\n","img_root_path = \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/train_test_set/\"\n","def get_image_path(file_name, train=True):\n","    if train:\n","        return img_root_path + \"train/\" + file_name.split(\"_\")[0] + \"/image/\" + file_name\n","    else:\n","        return img_root_path + \"test/\" + \"image/\" + file_name"]},{"cell_type":"code","source":["short_term = 10\n","group_minutes = 15\n","group_nums = int(1440 / group_minutes)\n","group_type = \"last\""],"metadata":{"id":"m48MOgxzPxIH"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"P7JY1wKcrhbR"},"outputs":[],"source":["def get_data_dic(short_term=5, group_minutes=60, group_type=\"median\", train=True):\n","    # 'short_term' is deprecated\n","    num_groups = int(1440 / group_minutes)\n","    concat_dic = dict.fromkeys([\"id_table\", \"metadata_short\", \"target\"] + [\"metadata_timegroup_\" + str(i) for i in range(num_groups)], dataframe().copy())\n","    if train:\n","        for root_case_path in os.listdir(root_path_train):\n","            tmp_img_path = root_path_train + root_case_path + \"/image/\"\n","            tmp_meta_path = root_path_train + root_case_path + \"/meta/\"\n","            for img_obj, meta_obj in zip(os.listdir(tmp_img_path), os.listdir(tmp_meta_path)):\n","                rawdata_meta = read_csv(tmp_meta_path + meta_obj, parse_dates=[\"시간\"])\n","                concat_dic[\"id_table\"] = concat_dic[\"id_table\"].append([[img_obj, rawdata_meta[\"시간\"].iloc[0]]])\n","                # interval data\n","                for i in range(num_groups):\n","                    if group_type==\"median\":\n","                        tmp_rawdata = rawdata_meta.iloc[(group_minutes * i):(group_minutes * (i+1))]\n","                        tmp_metadata = tmp_rawdata.select_dtypes([\"float32\", \"float64\"]).median().to_frame().T.astype(\"float32\")\n","                        tmp_metadata[\"id\"] = [img_obj]\n","                        tmp_metadata[\"timestamp\"] = [tmp_rawdata[\"시간\"].iloc[0]]\n","                    elif group_type==\"first\":\n","                        tmp_rawdata = rawdata_meta.iloc[(group_minutes * i)]\n","                        tmp_metadata = tmp_rawdata.to_frame().T\n","                        tmp_metadata.iloc[:,1:] = tmp_metadata.iloc[:,1:].astype(\"float32\")\n","                        tmp_metadata[tmp_metadata.select_dtypes([\"float32\", \"float64\"]).columns] = tmp_metadata.select_dtypes([\"float32\", \"float64\"]).astype(\"float32\")\n","                        tmp_metadata.columns = [\"timestamp\"] + list(tmp_metadata.columns[1:])\n","                        tmp_metadata[\"id\"] = [img_obj]\n","                    elif group_type==\"last\":\n","                        tmp_rawdata = rawdata_meta.iloc[(group_minutes * (i+1))-1]\n","                        tmp_metadata = tmp_rawdata.to_frame().T\n","                        tmp_metadata.iloc[:,1:] = tmp_metadata.iloc[:,1:].astype(\"float32\")\n","                        tmp_metadata[tmp_metadata.select_dtypes([\"float32\", \"float64\"]).columns] = tmp_metadata.select_dtypes([\"float32\", \"float64\"]).astype(\"float32\")\n","                        tmp_metadata.columns = [\"timestamp\"] + list(tmp_metadata.columns[1:])\n","                        tmp_metadata[\"id\"] = [img_obj]\n","                    concat_dic[\"metadata_timegroup_\" + str(i)] = concat_dic[\"metadata_timegroup_\" + str(i)].append(tmp_metadata)\n","                # # short term data\n","                # tmp_rawdata = rawdata_meta.iloc[:short_term]\n","                # tmp_metadata = tmp_rawdata.select_dtypes([\"float32\", \"float64\"]).median().to_frame().T.astype(\"float32\")\n","                # tmp_metadata[\"id\"] = [img_obj]\n","                # tmp_metadata[\"timestamp\"] = [tmp_rawdata[\"시간\"].iloc[0]]\n","                # concat_dic[\"metadata_short\"] = concat_dic[\"metadata_short\"].append(tmp_metadata)\n","            concat_dic[\"target\"] = concat_dic[\"target\"].append(read_csv(root_path_train + root_case_path + \"/label.csv\"))\n","        concat_dic[\"id_table\"].columns = [\"id\", \"timestamp\"]\n","        concat_dic[\"id_table\"].reset_index(drop=True, inplace=True)\n","        concat_dic[\"target\"].columns = [\"id\", \"timestamp\"]\n","        concat_dic[\"target\"].reset_index(drop=True, inplace=True)\n","        # concat_dic[\"metadata_short\"] = concat_dic[\"metadata_short\"][[\"id\", \"timestamp\"] + list(concat_dic[\"metadata_short\"].columns[:-2])]\n","        # concat_dic[\"metadata_short\"].reset_index(drop=True, inplace=True)\n","        concat_dic[\"id_table\"] = concat_dic[\"id_table\"].merge(concat_dic[\"target\"], how=\"left\", on=\"id\")\n","        concat_dic[\"id_table\"].columns = [\"id\", \"timestamp\", \"target\"]\n","        concat_dic[\"id_table\"][\"target\"] = concat_dic[\"id_table\"][\"target\"].astype(\"float32\")\n","        for i in range(num_groups):\n","            concat_dic[\"metadata_timegroup_\" + str(i)] = concat_dic[\"metadata_timegroup_\" + str(i)][[\"id\", \"timestamp\"] + list(concat_dic[\"metadata_timegroup_\" + str(i)].drop([\"id\", \"timestamp\"], axis=1).columns)]\n","            concat_dic[\"metadata_timegroup_\" + str(i)].reset_index(drop=True, inplace=True)\n","        return concat_dic\n","    else:\n","        tmp_img_path = root_path_test + \"image/\"\n","        tmp_meta_path = root_path_test + \"meta/\"\n","        for img_obj, meta_obj in zip(os.listdir(tmp_img_path), os.listdir(tmp_meta_path)):  \n","                rawdata_meta = read_csv(tmp_meta_path + meta_obj, parse_dates=[\"시간\"])\n","                concat_dic[\"id_table\"] = concat_dic[\"id_table\"].append([[img_obj, rawdata_meta[\"시간\"].iloc[0]]])\n","                # interval data\n","                for i in range(num_groups):\n","                    if group_type==\"median\":\n","                        tmp_rawdata = rawdata_meta.iloc[(group_minutes * i):(group_minutes * (i+1))]\n","                        tmp_metadata = tmp_rawdata.select_dtypes([\"float32\", \"float64\"]).median().to_frame().T.astype(\"float32\")\n","                        tmp_metadata[\"id\"] = [img_obj]\n","                        tmp_metadata[\"timestamp\"] = [tmp_rawdata[\"시간\"].iloc[0]]\n","                    elif group_type==\"first\":\n","                        tmp_rawdata = rawdata_meta.iloc[(group_minutes * i)]\n","                        tmp_metadata = tmp_rawdata.to_frame().T\n","                        tmp_metadata.iloc[:,1:] = tmp_metadata.iloc[:,1:].astype(\"float32\")\n","                        tmp_metadata[tmp_metadata.select_dtypes([\"float32\", \"float64\"]).columns] = tmp_metadata.select_dtypes([\"float32\", \"float64\"]).astype(\"float32\")\n","                        tmp_metadata.columns = [\"timestamp\"] + list(tmp_metadata.columns[1:])\n","                        tmp_metadata[\"id\"] = [img_obj]\n","                    elif group_type==\"last\":\n","                        tmp_rawdata = rawdata_meta.iloc[(group_minutes * (i+1))-1]\n","                        tmp_metadata = tmp_rawdata.to_frame().T\n","                        tmp_metadata.iloc[:,1:] = tmp_metadata.iloc[:,1:].astype(\"float32\")\n","                        tmp_metadata[tmp_metadata.select_dtypes([\"float32\", \"float64\"]).columns] = tmp_metadata.select_dtypes([\"float32\", \"float64\"]).astype(\"float32\")\n","                        tmp_metadata.columns = [\"timestamp\"] + list(tmp_metadata.columns[1:])\n","                        tmp_metadata[\"id\"] = [img_obj]\n","                    concat_dic[\"metadata_timegroup_\" + str(i)] = concat_dic[\"metadata_timegroup_\" + str(i)].append(tmp_metadata)\n","                # # short term data\n","                # tmp_rawdata = rawdata_meta.iloc[:short_term]\n","                # tmp_metadata = tmp_rawdata.select_dtypes([\"float32\", \"float64\"]).median().to_frame().T.astype(\"float32\")\n","                # tmp_metadata[\"id\"] = [img_obj]\n","                # tmp_metadata[\"timestamp\"] = [tmp_rawdata[\"시간\"].iloc[0]]\n","                # concat_dic[\"metadata_short\"] = concat_dic[\"metadata_short\"].append(tmp_metadata)\n","        concat_dic[\"id_table\"].columns = [\"id\", \"timestamp\"]\n","        concat_dic[\"id_table\"].reset_index(drop=True, inplace=True)\n","        # concat_dic[\"metadata_short\"] = concat_dic[\"metadata_short\"][[\"id\", \"timestamp\"] + list(concat_dic[\"metadata_short\"].columns[:-2])]\n","        # concat_dic[\"metadata_short\"].reset_index(drop=True, inplace=True)\n","        for i in range(num_groups):\n","            concat_dic[\"metadata_timegroup_\" + str(i)] = concat_dic[\"metadata_timegroup_\" + str(i)][[\"id\", \"timestamp\"] + list(concat_dic[\"metadata_timegroup_\" + str(i)].drop([\"id\", \"timestamp\"], axis=1).columns)]\n","            concat_dic[\"metadata_timegroup_\" + str(i)].reset_index(drop=True, inplace=True)\n","        return concat_dic"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Z85I-wkYa_AK"},"outputs":[],"source":["# full_x = get_data_dic(short_term=short_term, group_minutes=group_minutes, group_type=\"last\", train=True)\n","# test_x = get_data_dic(short_term=short_term, group_minutes=group_minutes, group_type=\"last\", train=False)\n","# easyIO(full_x, \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/dataset/full_x_\" + str(group_minutes) + \"_\" + group_type + \".pkl\", \"w\")\n","# easyIO(test_x, \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/dataset/test_x_\" + str(group_minutes) + \"_\" + group_type + \".pkl\", \"w\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"N8DTr3esMiMj"},"outputs":[],"source":["full_x = easyIO(None, \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/dataset/full_x_\" + str(group_minutes) + \"_\" + group_type + \".pkl\", \"r\")\n","test_x = easyIO(None, \"/content/drive/MyDrive/Colab Notebooks/projects/Dacon/plant_leaf_weight_prediction/dataset/test_x_\" + str(group_minutes) + \"_\" + group_type + \".pkl\", \"r\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"f9Yp_YmJgnf9"},"outputs":[],"source":["idx_var = \"id\"\n","target_var = \"target\"\n","date_var = [\"timestamp\"]\n","num_vars = [\"내부온도관측치\", \"외부온도관측치\", \"내부습도관측치\", \"외부습도관측치\", \"CO2관측치\", \"EC관측치\", \"최근분무량\",\n","            \"화이트 LED동작강도\", \"레드 LED동작강도\", \"블루 LED동작강도\", \"냉방온도\", \"냉방부하\", \"난방온도\", \"난방부하\",\n","            \"총추정광량\", \"백색광추정광량\", \"적색광추정광량\", \"청색광추정광량\"]\n","bin_vars = []\n","ord_vars = []\n","cat_vars = []\n","# cat_vars = [\"quarter\", \"month\", \"week_of_month\", \"weekday\"]"]},{"cell_type":"code","source":["full_x.keys()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"TDzXPjVCvVSx","executionInfo":{"status":"ok","timestamp":1652569442928,"user_tz":-540,"elapsed":14,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"88f612c6-0c71-4dc1-cb90-57917a90bdbb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["dict_keys(['id_table', 'metadata_short', 'target', 'metadata_timegroup_0', 'metadata_timegroup_1', 'metadata_timegroup_2', 'metadata_timegroup_3', 'metadata_timegroup_4', 'metadata_timegroup_5', 'metadata_timegroup_6', 'metadata_timegroup_7', 'metadata_timegroup_8', 'metadata_timegroup_9', 'metadata_timegroup_10', 'metadata_timegroup_11', 'metadata_timegroup_12', 'metadata_timegroup_13', 'metadata_timegroup_14', 'metadata_timegroup_15', 'metadata_timegroup_16', 'metadata_timegroup_17', 'metadata_timegroup_18', 'metadata_timegroup_19', 'metadata_timegroup_20', 'metadata_timegroup_21', 'metadata_timegroup_22', 'metadata_timegroup_23', 'metadata_timegroup_24', 'metadata_timegroup_25', 'metadata_timegroup_26', 'metadata_timegroup_27', 'metadata_timegroup_28', 'metadata_timegroup_29', 'metadata_timegroup_30', 'metadata_timegroup_31', 'metadata_timegroup_32', 'metadata_timegroup_33', 'metadata_timegroup_34', 'metadata_timegroup_35', 'metadata_timegroup_36', 'metadata_timegroup_37', 'metadata_timegroup_38', 'metadata_timegroup_39', 'metadata_timegroup_40', 'metadata_timegroup_41', 'metadata_timegroup_42', 'metadata_timegroup_43', 'metadata_timegroup_44', 'metadata_timegroup_45', 'metadata_timegroup_46', 'metadata_timegroup_47', 'metadata_timegroup_48', 'metadata_timegroup_49', 'metadata_timegroup_50', 'metadata_timegroup_51', 'metadata_timegroup_52', 'metadata_timegroup_53', 'metadata_timegroup_54', 'metadata_timegroup_55', 'metadata_timegroup_56', 'metadata_timegroup_57', 'metadata_timegroup_58', 'metadata_timegroup_59', 'metadata_timegroup_60', 'metadata_timegroup_61', 'metadata_timegroup_62', 'metadata_timegroup_63', 'metadata_timegroup_64', 'metadata_timegroup_65', 'metadata_timegroup_66', 'metadata_timegroup_67', 'metadata_timegroup_68', 'metadata_timegroup_69', 'metadata_timegroup_70', 'metadata_timegroup_71', 'metadata_timegroup_72', 'metadata_timegroup_73', 'metadata_timegroup_74', 'metadata_timegroup_75', 'metadata_timegroup_76', 'metadata_timegroup_77', 'metadata_timegroup_78', 'metadata_timegroup_79', 'metadata_timegroup_80', 'metadata_timegroup_81', 'metadata_timegroup_82', 'metadata_timegroup_83', 'metadata_timegroup_84', 'metadata_timegroup_85', 'metadata_timegroup_86', 'metadata_timegroup_87', 'metadata_timegroup_88', 'metadata_timegroup_89', 'metadata_timegroup_90', 'metadata_timegroup_91', 'metadata_timegroup_92', 'metadata_timegroup_93', 'metadata_timegroup_94', 'metadata_timegroup_95'])"]},"metadata":{},"execution_count":19}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1652569442928,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"3e1CdV7bzTwH","outputId":"b2deafd8-a31a-47ba-fb41-8dcf06401d9a"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 1592 entries, 0 to 1591\n","Data columns (total 3 columns):\n"," #   Column     Non-Null Count  Dtype         \n","---  ------     --------------  -----         \n"," 0   id         1592 non-null   object        \n"," 1   timestamp  1592 non-null   datetime64[ns]\n"," 2   target     1592 non-null   float32       \n","dtypes: datetime64[ns](1), float32(1), object(1)\n","memory usage: 43.5+ KB\n"]}],"source":["full_x[\"id_table\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1652569442928,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"GJWGz1FlTyFv","outputId":"d391d840-ff15-4713-97bb-3a44328fda13"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["              id           timestamp      target\n","0  CASE01_01.png 2021-05-07 02:46:00   49.193001\n","1  CASE01_02.png 2021-05-08 02:46:00   59.764000\n","2  CASE01_03.png 2021-05-09 02:46:00   72.209000\n","3  CASE01_04.png 2021-05-10 02:46:00   85.737000\n","4  CASE01_05.png 2021-05-11 02:46:00  102.537003"],"text/html":["\n","  <div id=\"df-ace52aa9-e46e-4f9d-a35f-50dad404e45c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>timestamp</th>\n","      <th>target</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>CASE01_01.png</td>\n","      <td>2021-05-07 02:46:00</td>\n","      <td>49.193001</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>CASE01_02.png</td>\n","      <td>2021-05-08 02:46:00</td>\n","      <td>59.764000</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CASE01_03.png</td>\n","      <td>2021-05-09 02:46:00</td>\n","      <td>72.209000</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>CASE01_04.png</td>\n","      <td>2021-05-10 02:46:00</td>\n","      <td>85.737000</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>CASE01_05.png</td>\n","      <td>2021-05-11 02:46:00</td>\n","      <td>102.537003</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ace52aa9-e46e-4f9d-a35f-50dad404e45c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ace52aa9-e46e-4f9d-a35f-50dad404e45c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ace52aa9-e46e-4f9d-a35f-50dad404e45c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":21}],"source":["full_x[\"id_table\"].head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NGWbsa-sgjri"},"outputs":[],"source":["# full_x[\"metadata_short\"][\"quarter\"] = full_x[\"metadata_short\"][\"timestamp\"].dt.quarter.astype(\"object\")\n","# full_x[\"metadata_short\"][\"month\"] = full_x[\"metadata_short\"][\"timestamp\"].dt.month.astype(\"object\")\n","# full_x[\"metadata_short\"][\"week_of_month\"] = full_x[\"metadata_short\"][\"timestamp\"].apply(week_of_month).astype(\"object\")\n","# full_x[\"metadata_short\"][\"weekday\"] = full_x[\"metadata_short\"][\"timestamp\"].dt.weekday.astype(\"object\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oopU5A7PhRos"},"outputs":[],"source":["# for i in range(group_nums):\n","#     full_x[\"metadata_timegroup_\" + str(i)][\"quarter\"] = full_x[\"metadata_timegroup_\" + str(i)][\"timestamp\"].dt.quarter.astype(\"object\")\n","#     full_x[\"metadata_timegroup_\" + str(i)][\"month\"] = full_x[\"metadata_timegroup_\" + str(i)][\"timestamp\"].dt.month.astype(\"object\")\n","#     full_x[\"metadata_timegroup_\" + str(i)][\"week_of_month\"] = full_x[\"metadata_timegroup_\" + str(i)][\"timestamp\"].apply(week_of_month).astype(\"object\")\n","#     full_x[\"metadata_timegroup_\" + str(i)][\"weekday\"] = full_x[\"metadata_timegroup_\" + str(i)][\"timestamp\"].dt.weekday.astype(\"object\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1652569442929,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"oJCww80IhnKU","outputId":"ea489f47-acde-42a4-86ee-e0367109483b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["              id           timestamp    내부온도관측치    외부온도관측치    내부습도관측치  외부습도관측치  CO2관측치      EC관측치  최근분무량  화이트 LED동작강도  레드 LED동작강도  블루 LED동작강도  냉방온도  냉방부하  난방온도       난방부하  총추정광량  백색광추정광량  적색광추정광량  청색광추정광량\n","0  CASE01_01.png 2021-05-07 03:00:00  18.500000  41.700001  77.500000      0.0   586.0  18.600000    0.0        201.0       201.0         0.0  14.0   0.0  15.0  12.500000    0.0      0.0      0.0      NaN\n","1  CASE01_02.png 2021-05-08 03:00:00  17.600000  47.900002  78.800003      0.0   582.0  15.600000    0.0        201.0       201.0         NaN  14.0   0.0  15.0   8.000002    0.0      0.0      0.0      NaN\n","2  CASE01_03.png 2021-05-09 03:00:00  17.900000  55.500000  76.900002      NaN   564.0  17.100000    0.0        201.0       201.0         NaN  14.0   0.0  15.0   9.499998    0.0      0.0      0.0      NaN\n","3  CASE01_04.png 2021-05-10 03:00:00  18.100000  50.500000  79.599998      0.0   610.0  18.400000    0.0        201.0       201.0         NaN  14.0   0.0  15.0  10.500002    0.0      0.0      0.0      NaN\n","4  CASE01_05.png 2021-05-11 03:00:00  18.299999  66.599998  89.599998      0.0   564.0  17.799999    0.0        201.0       201.0         NaN  14.0   0.0  15.0  11.499996    0.0      0.0      0.0      NaN"],"text/html":["\n","  <div id=\"df-f1cf42db-ea0d-4d23-90cc-877d38ef9aa4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>timestamp</th>\n","      <th>내부온도관측치</th>\n","      <th>외부온도관측치</th>\n","      <th>내부습도관측치</th>\n","      <th>외부습도관측치</th>\n","      <th>CO2관측치</th>\n","      <th>EC관측치</th>\n","      <th>최근분무량</th>\n","      <th>화이트 LED동작강도</th>\n","      <th>레드 LED동작강도</th>\n","      <th>블루 LED동작강도</th>\n","      <th>냉방온도</th>\n","      <th>냉방부하</th>\n","      <th>난방온도</th>\n","      <th>난방부하</th>\n","      <th>총추정광량</th>\n","      <th>백색광추정광량</th>\n","      <th>적색광추정광량</th>\n","      <th>청색광추정광량</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>CASE01_01.png</td>\n","      <td>2021-05-07 03:00:00</td>\n","      <td>18.500000</td>\n","      <td>41.700001</td>\n","      <td>77.500000</td>\n","      <td>0.0</td>\n","      <td>586.0</td>\n","      <td>18.600000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>0.0</td>\n","      <td>14.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>12.500000</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>CASE01_02.png</td>\n","      <td>2021-05-08 03:00:00</td>\n","      <td>17.600000</td>\n","      <td>47.900002</td>\n","      <td>78.800003</td>\n","      <td>0.0</td>\n","      <td>582.0</td>\n","      <td>15.600000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>NaN</td>\n","      <td>14.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>8.000002</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CASE01_03.png</td>\n","      <td>2021-05-09 03:00:00</td>\n","      <td>17.900000</td>\n","      <td>55.500000</td>\n","      <td>76.900002</td>\n","      <td>NaN</td>\n","      <td>564.0</td>\n","      <td>17.100000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>NaN</td>\n","      <td>14.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>9.499998</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>CASE01_04.png</td>\n","      <td>2021-05-10 03:00:00</td>\n","      <td>18.100000</td>\n","      <td>50.500000</td>\n","      <td>79.599998</td>\n","      <td>0.0</td>\n","      <td>610.0</td>\n","      <td>18.400000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>NaN</td>\n","      <td>14.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>10.500002</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>CASE01_05.png</td>\n","      <td>2021-05-11 03:00:00</td>\n","      <td>18.299999</td>\n","      <td>66.599998</td>\n","      <td>89.599998</td>\n","      <td>0.0</td>\n","      <td>564.0</td>\n","      <td>17.799999</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>NaN</td>\n","      <td>14.0</td>\n","      <td>0.0</td>\n","      <td>15.0</td>\n","      <td>11.499996</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f1cf42db-ea0d-4d23-90cc-877d38ef9aa4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f1cf42db-ea0d-4d23-90cc-877d38ef9aa4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f1cf42db-ea0d-4d23-90cc-877d38ef9aa4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":24}],"source":["full_x[\"metadata_timegroup_0\"].head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":11,"status":"ok","timestamp":1652569442929,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"5BaFCkWukR4R","outputId":"bcd92e3c-061d-4711-e275-1c485ace2b6d"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1592 entries, 0 to 1591\n","Data columns (total 20 columns):\n"," #   Column       Non-Null Count  Dtype         \n","---  ------       --------------  -----         \n"," 0   id           1592 non-null   object        \n"," 1   timestamp    1592 non-null   datetime64[ns]\n"," 2   내부온도관측치      1276 non-null   float32       \n"," 3   외부온도관측치      1296 non-null   float32       \n"," 4   내부습도관측치      1278 non-null   float32       \n"," 5   외부습도관측치      1290 non-null   float32       \n"," 6   CO2관측치       1296 non-null   float32       \n"," 7   EC관측치        1286 non-null   float32       \n"," 8   최근분무량        1297 non-null   float32       \n"," 9   화이트 LED동작강도  1247 non-null   float32       \n"," 10  레드 LED동작강도   1233 non-null   float32       \n"," 11  블루 LED동작강도   1217 non-null   float32       \n"," 12  냉방온도         1272 non-null   float32       \n"," 13  냉방부하         1252 non-null   float32       \n"," 14  난방온도         1272 non-null   float32       \n"," 15  난방부하         1252 non-null   float32       \n"," 16  총추정광량        1271 non-null   float32       \n"," 17  백색광추정광량      1271 non-null   float32       \n"," 18  적색광추정광량      1271 non-null   float32       \n"," 19  청색광추정광량      1253 non-null   float32       \n","dtypes: datetime64[ns](1), float32(18), object(1)\n","memory usage: 136.9+ KB\n"]}],"source":["full_x[\"metadata_timegroup_0\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1652569442929,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"fSBqNVckjPcD","outputId":"cb8b06da-bab0-4552-eccc-f57f57572ca2"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1592 entries, 0 to 1591\n","Data columns (total 20 columns):\n"," #   Column       Non-Null Count  Dtype         \n","---  ------       --------------  -----         \n"," 0   id           1592 non-null   object        \n"," 1   timestamp    1592 non-null   datetime64[ns]\n"," 2   내부온도관측치      1284 non-null   float32       \n"," 3   외부온도관측치      1296 non-null   float32       \n"," 4   내부습도관측치      1281 non-null   float32       \n"," 5   외부습도관측치      1292 non-null   float32       \n"," 6   CO2관측치       1296 non-null   float32       \n"," 7   EC관측치        1288 non-null   float32       \n"," 8   최근분무량        1296 non-null   float32       \n"," 9   화이트 LED동작강도  1244 non-null   float32       \n"," 10  레드 LED동작강도   1241 non-null   float32       \n"," 11  블루 LED동작강도   1229 non-null   float32       \n"," 12  냉방온도         1274 non-null   float32       \n"," 13  냉방부하         1260 non-null   float32       \n"," 14  난방온도         1274 non-null   float32       \n"," 15  난방부하         1260 non-null   float32       \n"," 16  총추정광량        1274 non-null   float32       \n"," 17  백색광추정광량      1274 non-null   float32       \n"," 18  적색광추정광량      1274 non-null   float32       \n"," 19  청색광추정광량      1256 non-null   float32       \n","dtypes: datetime64[ns](1), float32(18), object(1)\n","memory usage: 136.9+ KB\n"]}],"source":["full_x[\"metadata_timegroup_23\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":10,"status":"ok","timestamp":1652569442929,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"-85fnIO6nsc9","outputId":"2e1376aa-cd65-4ff4-821e-1a4b1952edfb"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["              id           timestamp    내부온도관측치    외부온도관측치    내부습도관측치  외부습도관측치  CO2관측치      EC관측치  최근분무량  화이트 LED동작강도  레드 LED동작강도  블루 LED동작강도       냉방온도        냉방부하       난방온도       난방부하       총추정광량  백색광추정광량    적색광추정광량  청색광추정광량\n","0  CASE01_01.png 2021-05-07 08:45:00  23.900000  48.900002  76.000000      0.0   407.0  22.500000    0.0        201.0       201.0         0.0  18.410643  352.588501  20.100122  10.551816  309.410004   16.548  26.630501      NaN\n","1  CASE01_02.png 2021-05-08 08:45:00  23.799999  39.599998  78.699997      0.0   360.0  20.100000    0.0        201.0       201.0         0.0  18.401276  352.588501  20.090235   9.603889  309.410004   16.548  26.630501      NaN\n","2  CASE01_03.png 2021-05-09 08:45:00  23.299999  47.099998  68.800003      0.0   396.0  19.700001    0.0          NaN       201.0         0.0  18.413605  352.588501  20.103251  10.535420  309.410004   16.548  26.630501      NaN\n","3  CASE01_04.png 2021-05-10 08:45:00  23.200001  49.700001  78.500000      0.0   451.0  18.100000    0.0        201.0       201.0         0.0  18.391935  352.588501  20.080376   6.655768  309.410004   16.548  26.630501      NaN\n","4  CASE01_05.png 2021-05-11 08:45:00  23.400000  75.300003  82.000000      0.0   395.0  17.600000    0.0        201.0         NaN         0.0  18.390736  352.588501  20.079109   7.662479  309.410004   16.548  26.630501      NaN"],"text/html":["\n","  <div id=\"df-e55a11ef-34a8-471f-b892-1453f2ad3f1f\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>timestamp</th>\n","      <th>내부온도관측치</th>\n","      <th>외부온도관측치</th>\n","      <th>내부습도관측치</th>\n","      <th>외부습도관측치</th>\n","      <th>CO2관측치</th>\n","      <th>EC관측치</th>\n","      <th>최근분무량</th>\n","      <th>화이트 LED동작강도</th>\n","      <th>레드 LED동작강도</th>\n","      <th>블루 LED동작강도</th>\n","      <th>냉방온도</th>\n","      <th>냉방부하</th>\n","      <th>난방온도</th>\n","      <th>난방부하</th>\n","      <th>총추정광량</th>\n","      <th>백색광추정광량</th>\n","      <th>적색광추정광량</th>\n","      <th>청색광추정광량</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>CASE01_01.png</td>\n","      <td>2021-05-07 08:45:00</td>\n","      <td>23.900000</td>\n","      <td>48.900002</td>\n","      <td>76.000000</td>\n","      <td>0.0</td>\n","      <td>407.0</td>\n","      <td>22.500000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>0.0</td>\n","      <td>18.410643</td>\n","      <td>352.588501</td>\n","      <td>20.100122</td>\n","      <td>10.551816</td>\n","      <td>309.410004</td>\n","      <td>16.548</td>\n","      <td>26.630501</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>CASE01_02.png</td>\n","      <td>2021-05-08 08:45:00</td>\n","      <td>23.799999</td>\n","      <td>39.599998</td>\n","      <td>78.699997</td>\n","      <td>0.0</td>\n","      <td>360.0</td>\n","      <td>20.100000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>0.0</td>\n","      <td>18.401276</td>\n","      <td>352.588501</td>\n","      <td>20.090235</td>\n","      <td>9.603889</td>\n","      <td>309.410004</td>\n","      <td>16.548</td>\n","      <td>26.630501</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>CASE01_03.png</td>\n","      <td>2021-05-09 08:45:00</td>\n","      <td>23.299999</td>\n","      <td>47.099998</td>\n","      <td>68.800003</td>\n","      <td>0.0</td>\n","      <td>396.0</td>\n","      <td>19.700001</td>\n","      <td>0.0</td>\n","      <td>NaN</td>\n","      <td>201.0</td>\n","      <td>0.0</td>\n","      <td>18.413605</td>\n","      <td>352.588501</td>\n","      <td>20.103251</td>\n","      <td>10.535420</td>\n","      <td>309.410004</td>\n","      <td>16.548</td>\n","      <td>26.630501</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>CASE01_04.png</td>\n","      <td>2021-05-10 08:45:00</td>\n","      <td>23.200001</td>\n","      <td>49.700001</td>\n","      <td>78.500000</td>\n","      <td>0.0</td>\n","      <td>451.0</td>\n","      <td>18.100000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>201.0</td>\n","      <td>0.0</td>\n","      <td>18.391935</td>\n","      <td>352.588501</td>\n","      <td>20.080376</td>\n","      <td>6.655768</td>\n","      <td>309.410004</td>\n","      <td>16.548</td>\n","      <td>26.630501</td>\n","      <td>NaN</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>CASE01_05.png</td>\n","      <td>2021-05-11 08:45:00</td>\n","      <td>23.400000</td>\n","      <td>75.300003</td>\n","      <td>82.000000</td>\n","      <td>0.0</td>\n","      <td>395.0</td>\n","      <td>17.600000</td>\n","      <td>0.0</td>\n","      <td>201.0</td>\n","      <td>NaN</td>\n","      <td>0.0</td>\n","      <td>18.390736</td>\n","      <td>352.588501</td>\n","      <td>20.079109</td>\n","      <td>7.662479</td>\n","      <td>309.410004</td>\n","      <td>16.548</td>\n","      <td>26.630501</td>\n","      <td>NaN</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e55a11ef-34a8-471f-b892-1453f2ad3f1f')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e55a11ef-34a8-471f-b892-1453f2ad3f1f button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e55a11ef-34a8-471f-b892-1453f2ad3f1f');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":27}],"source":["full_x[\"metadata_timegroup_23\"].head()"]},{"cell_type":"code","source":["test_x[\"metadata_timegroup_0\"].head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"l9Me9k_ooo1_","executionInfo":{"status":"ok","timestamp":1652569442930,"user_tz":-540,"elapsed":10,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"7dfd57ca-288c-45ff-ac53-a1259b7c0d93"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        id           timestamp  내부온도관측치  외부온도관측치    내부습도관측치    외부습도관측치  CO2관측치     EC관측치         최근분무량  화이트 LED동작강도  레드 LED동작강도  블루 LED동작강도  냉방온도       냉방부하  난방온도  난방부하       총추정광량     백색광추정광량    적색광추정광량    청색광추정광량\n","0  001.png 2021-05-05 09:13:00     25.6     22.1  48.099998  47.000000   351.0  0.000000   4607.569824        100.0        10.0        21.0  25.0   3.000002  23.0   0.0  358.854492  309.410004  16.548000  32.896500\n","1  002.png 2021-06-25 17:13:00     28.0     30.6  61.400002  42.000000   473.0  0.000000    434.640015         70.0        20.0        10.0  26.0  15.000000  25.0   0.0  265.347992  216.587006  33.096001  15.665000\n","2  003.png 2021-09-07 03:00:00     24.6     25.5  80.699997  59.700001   487.0  1.791887    126.000000          0.0         0.0         0.0  16.0  53.000000  14.0   0.0    0.000000    0.000000   0.000000   0.000000\n","3  004.png 2021-04-23 17:13:00     25.1     22.9  62.400002  47.400002   367.0  0.610124  10701.700195         93.0        26.0        27.0  25.0   1.999998  23.0   0.0  373.071594  287.751312  43.024799  42.295502\n","4  005.png 2021-04-28 03:00:00     20.6     22.0  76.500000  35.000000   421.0  0.537842    769.000000          0.0         0.0         0.0  20.0   3.000002  18.0   0.0    0.000000    0.000000   0.000000   0.000000"],"text/html":["\n","  <div id=\"df-38d685d1-cb46-420b-9038-a301501e80cc\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>timestamp</th>\n","      <th>내부온도관측치</th>\n","      <th>외부온도관측치</th>\n","      <th>내부습도관측치</th>\n","      <th>외부습도관측치</th>\n","      <th>CO2관측치</th>\n","      <th>EC관측치</th>\n","      <th>최근분무량</th>\n","      <th>화이트 LED동작강도</th>\n","      <th>레드 LED동작강도</th>\n","      <th>블루 LED동작강도</th>\n","      <th>냉방온도</th>\n","      <th>냉방부하</th>\n","      <th>난방온도</th>\n","      <th>난방부하</th>\n","      <th>총추정광량</th>\n","      <th>백색광추정광량</th>\n","      <th>적색광추정광량</th>\n","      <th>청색광추정광량</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>001.png</td>\n","      <td>2021-05-05 09:13:00</td>\n","      <td>25.6</td>\n","      <td>22.1</td>\n","      <td>48.099998</td>\n","      <td>47.000000</td>\n","      <td>351.0</td>\n","      <td>0.000000</td>\n","      <td>4607.569824</td>\n","      <td>100.0</td>\n","      <td>10.0</td>\n","      <td>21.0</td>\n","      <td>25.0</td>\n","      <td>3.000002</td>\n","      <td>23.0</td>\n","      <td>0.0</td>\n","      <td>358.854492</td>\n","      <td>309.410004</td>\n","      <td>16.548000</td>\n","      <td>32.896500</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>002.png</td>\n","      <td>2021-06-25 17:13:00</td>\n","      <td>28.0</td>\n","      <td>30.6</td>\n","      <td>61.400002</td>\n","      <td>42.000000</td>\n","      <td>473.0</td>\n","      <td>0.000000</td>\n","      <td>434.640015</td>\n","      <td>70.0</td>\n","      <td>20.0</td>\n","      <td>10.0</td>\n","      <td>26.0</td>\n","      <td>15.000000</td>\n","      <td>25.0</td>\n","      <td>0.0</td>\n","      <td>265.347992</td>\n","      <td>216.587006</td>\n","      <td>33.096001</td>\n","      <td>15.665000</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>003.png</td>\n","      <td>2021-09-07 03:00:00</td>\n","      <td>24.6</td>\n","      <td>25.5</td>\n","      <td>80.699997</td>\n","      <td>59.700001</td>\n","      <td>487.0</td>\n","      <td>1.791887</td>\n","      <td>126.000000</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>16.0</td>\n","      <td>53.000000</td>\n","      <td>14.0</td>\n","      <td>0.0</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>004.png</td>\n","      <td>2021-04-23 17:13:00</td>\n","      <td>25.1</td>\n","      <td>22.9</td>\n","      <td>62.400002</td>\n","      <td>47.400002</td>\n","      <td>367.0</td>\n","      <td>0.610124</td>\n","      <td>10701.700195</td>\n","      <td>93.0</td>\n","      <td>26.0</td>\n","      <td>27.0</td>\n","      <td>25.0</td>\n","      <td>1.999998</td>\n","      <td>23.0</td>\n","      <td>0.0</td>\n","      <td>373.071594</td>\n","      <td>287.751312</td>\n","      <td>43.024799</td>\n","      <td>42.295502</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>005.png</td>\n","      <td>2021-04-28 03:00:00</td>\n","      <td>20.6</td>\n","      <td>22.0</td>\n","      <td>76.500000</td>\n","      <td>35.000000</td>\n","      <td>421.0</td>\n","      <td>0.537842</td>\n","      <td>769.000000</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>20.0</td>\n","      <td>3.000002</td>\n","      <td>18.0</td>\n","      <td>0.0</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-38d685d1-cb46-420b-9038-a301501e80cc')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-38d685d1-cb46-420b-9038-a301501e80cc button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-38d685d1-cb46-420b-9038-a301501e80cc');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":28}]},{"cell_type":"code","source":["test_x[\"metadata_timegroup_23\"].head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"W5zyaJawooz6","executionInfo":{"status":"ok","timestamp":1652569442930,"user_tz":-540,"elapsed":10,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"a64b0013-0cec-4686-b5ae-901980ddef4f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        id           timestamp    내부온도관측치  외부온도관측치    내부습도관측치    외부습도관측치  CO2관측치     EC관측치         최근분무량  화이트 LED동작강도  레드 LED동작강도  블루 LED동작강도       냉방온도       냉방부하      난방온도  난방부하       총추정광량     백색광추정광량  적색광추정광량    청색광추정광량\n","0  001.png 2021-05-05 14:58:00  25.299999     23.0  58.299999  36.700001   394.0  0.000000   7677.140137        100.0        18.0        38.0  25.000000   1.499996  23.00000   0.0  398.723389  309.410004  29.7864  59.527000\n","1  002.png 2021-06-25 22:58:00  27.000000     28.9  60.900002  50.700001   506.0  0.000000    762.570007          0.0         0.0         0.0  21.000000  35.000000  20.00000   0.0    0.000000    0.000000   0.0000   0.000000\n","2  003.png 2021-09-07 08:45:00  26.900000     25.6  75.500000  62.400002   452.0  1.780509    119.570000        100.0        10.0        17.0  21.819456  42.312344  18.43751   0.0  352.588501  309.410004  16.5480  26.630501\n","3  004.png 2021-04-23 22:58:00  20.600000     21.9  75.599998  44.900002   435.0  0.603906  12995.839844          0.0         0.0         0.0  20.000000   3.000002  18.00000   0.0    0.000000    0.000000   0.0000   0.000000\n","4  005.png 2021-04-28 08:45:00  24.600000     22.1  58.000000  38.299999   401.0  0.544837   4601.140137        100.0        10.0        17.0  25.000000   0.000000  23.00000   0.0  352.588501  309.410004  16.5480  26.630501"],"text/html":["\n","  <div id=\"df-ab4d25cc-135a-40cb-be36-410f396b371c\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>timestamp</th>\n","      <th>내부온도관측치</th>\n","      <th>외부온도관측치</th>\n","      <th>내부습도관측치</th>\n","      <th>외부습도관측치</th>\n","      <th>CO2관측치</th>\n","      <th>EC관측치</th>\n","      <th>최근분무량</th>\n","      <th>화이트 LED동작강도</th>\n","      <th>레드 LED동작강도</th>\n","      <th>블루 LED동작강도</th>\n","      <th>냉방온도</th>\n","      <th>냉방부하</th>\n","      <th>난방온도</th>\n","      <th>난방부하</th>\n","      <th>총추정광량</th>\n","      <th>백색광추정광량</th>\n","      <th>적색광추정광량</th>\n","      <th>청색광추정광량</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>001.png</td>\n","      <td>2021-05-05 14:58:00</td>\n","      <td>25.299999</td>\n","      <td>23.0</td>\n","      <td>58.299999</td>\n","      <td>36.700001</td>\n","      <td>394.0</td>\n","      <td>0.000000</td>\n","      <td>7677.140137</td>\n","      <td>100.0</td>\n","      <td>18.0</td>\n","      <td>38.0</td>\n","      <td>25.000000</td>\n","      <td>1.499996</td>\n","      <td>23.00000</td>\n","      <td>0.0</td>\n","      <td>398.723389</td>\n","      <td>309.410004</td>\n","      <td>29.7864</td>\n","      <td>59.527000</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>002.png</td>\n","      <td>2021-06-25 22:58:00</td>\n","      <td>27.000000</td>\n","      <td>28.9</td>\n","      <td>60.900002</td>\n","      <td>50.700001</td>\n","      <td>506.0</td>\n","      <td>0.000000</td>\n","      <td>762.570007</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>21.000000</td>\n","      <td>35.000000</td>\n","      <td>20.00000</td>\n","      <td>0.0</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.0000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>003.png</td>\n","      <td>2021-09-07 08:45:00</td>\n","      <td>26.900000</td>\n","      <td>25.6</td>\n","      <td>75.500000</td>\n","      <td>62.400002</td>\n","      <td>452.0</td>\n","      <td>1.780509</td>\n","      <td>119.570000</td>\n","      <td>100.0</td>\n","      <td>10.0</td>\n","      <td>17.0</td>\n","      <td>21.819456</td>\n","      <td>42.312344</td>\n","      <td>18.43751</td>\n","      <td>0.0</td>\n","      <td>352.588501</td>\n","      <td>309.410004</td>\n","      <td>16.5480</td>\n","      <td>26.630501</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>004.png</td>\n","      <td>2021-04-23 22:58:00</td>\n","      <td>20.600000</td>\n","      <td>21.9</td>\n","      <td>75.599998</td>\n","      <td>44.900002</td>\n","      <td>435.0</td>\n","      <td>0.603906</td>\n","      <td>12995.839844</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>20.000000</td>\n","      <td>3.000002</td>\n","      <td>18.00000</td>\n","      <td>0.0</td>\n","      <td>0.000000</td>\n","      <td>0.000000</td>\n","      <td>0.0000</td>\n","      <td>0.000000</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>005.png</td>\n","      <td>2021-04-28 08:45:00</td>\n","      <td>24.600000</td>\n","      <td>22.1</td>\n","      <td>58.000000</td>\n","      <td>38.299999</td>\n","      <td>401.0</td>\n","      <td>0.544837</td>\n","      <td>4601.140137</td>\n","      <td>100.0</td>\n","      <td>10.0</td>\n","      <td>17.0</td>\n","      <td>25.000000</td>\n","      <td>0.000000</td>\n","      <td>23.00000</td>\n","      <td>0.0</td>\n","      <td>352.588501</td>\n","      <td>309.410004</td>\n","      <td>16.5480</td>\n","      <td>26.630501</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-ab4d25cc-135a-40cb-be36-410f396b371c')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-ab4d25cc-135a-40cb-be36-410f396b371c button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-ab4d25cc-135a-40cb-be36-410f396b371c');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":29}]},{"cell_type":"markdown","metadata":{"id":"N0VL1Z7a73Rc"},"source":["# EDA"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EkmdHuBAnnGK"},"outputs":[],"source":["createFolder(folder_path + \"EDA/graphs/\")\n","createFolder(folder_path + \"EDA/csv_output/\")"]},{"cell_type":"markdown","metadata":{"id":"d64xj25F0SN2"},"source":["**Time group 별 target 과 유의성 파악**"]},{"cell_type":"markdown","metadata":{"id":"gPbPCidVR9VN"},"source":["**Time group 0**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hOyyLrOh0SBU"},"outputs":[],"source":["# viz_df = pd.concat([full_x[\"metadata_timegroup_0\"].copy(), full_x[\"id_table\"][[\"target\"]]], axis=1).dropna()\n","# viz_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hV6O175P0R_J"},"outputs":[],"source":["# for i in viz_df.select_dtypes([\"float32\", \"float64\"]):\n","#     tmp_df = dataframe()\n","#     tmp_df[\"x\"] = viz_df[i]\n","#     tmp_df[\"y\"] = viz_df[\"target\"]\n","#     if i == \"target\":\n","#         continue\n","#     tmp_df = tmp_df[tmp_df[\"y\"] > 0]\n","#     if i == \"최근분무량\":\n","#         tmp_df = tmp_df[tmp_df[\"x\"] < 100000]\n","#     # else:\n","#     #     outlier_mask = (np.abs(stats.zscore(tmp_df[\"x\"])) > 3.0)\n","#     #     if outlier_mask.sum() > 0:\n","#     #         print(\"outlier \", i, outlier_mask.sum())\n","#     #     tmp_df = tmp_df[~outlier_mask]\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(tmp_df[\"x\"], tmp_df[\"y\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" & target 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.savefig(folder_path + \"EDA/graphs/time_group_0_\" + i)"]},{"cell_type":"markdown","metadata":{"id":"qwpZ73rnTkcr"},"source":["**Time group 12**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rtmYIzem0R6k"},"outputs":[],"source":["# viz_df = pd.concat([full_x[\"metadata_timegroup_12\"].copy(), full_x[\"id_table\"][[\"target\"]]], axis=1).dropna()\n","# viz_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"d3_0ow2W0R4X"},"outputs":[],"source":["# for i in viz_df.select_dtypes([\"float32\", \"float64\"]):\n","#     tmp_df = dataframe()\n","#     tmp_df[\"x\"] = viz_df[i]\n","#     tmp_df[\"y\"] = viz_df[\"target\"]\n","#     if i == \"target\":\n","#         continue\n","#     tmp_df = tmp_df[tmp_df[\"y\"] > 0]\n","#     if i == \"최근분무량\":\n","#         tmp_df = tmp_df[tmp_df[\"x\"] < 100000]\n","#     # else:\n","#     #     outlier_mask = (np.abs(stats.zscore(tmp_df[\"x\"])) > 3.0)\n","#     #     if outlier_mask.sum() > 0:\n","#     #         print(\"outlier \", i, outlier_mask.sum())\n","#     #     tmp_df = tmp_df[~outlier_mask]\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(tmp_df[\"x\"], tmp_df[\"y\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" & target 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.savefig(folder_path + \"EDA/graphs/time_group_12_\" + i)"]},{"cell_type":"markdown","metadata":{"id":"WuEUkhJE2lB_"},"source":["**Time group 23**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"mpwd6gFD2lTO"},"outputs":[],"source":["# viz_df = pd.concat([full_x[\"metadata_timegroup_23\"].copy(), full_x[\"id_table\"][[\"target\"]]], axis=1).dropna()\n","# viz_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yIzebot42lqu"},"outputs":[],"source":["# for i in viz_df.select_dtypes([\"float32\", \"float64\"]):\n","#     tmp_df = dataframe()\n","#     tmp_df[\"x\"] = viz_df[i]\n","#     tmp_df[\"y\"] = viz_df[\"target\"]\n","#     if i == \"target\":\n","#         continue\n","#     tmp_df = tmp_df[tmp_df[\"y\"] > 0]\n","#     if i == \"최근분무량\":\n","#         tmp_df = tmp_df[tmp_df[\"x\"] < 100000]\n","#     # else:\n","#     #     outlier_mask = (np.abs(stats.zscore(tmp_df[\"x\"])) > 3.0)\n","#     #     if outlier_mask.sum() > 0:\n","#     #         print(\"outlier \", i, outlier_mask.sum())\n","#     #     tmp_df = tmp_df[~outlier_mask]\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(tmp_df[\"x\"], tmp_df[\"y\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" & target 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.savefig(folder_path + \"EDA/graphs/time_group_23_\" + i)"]},{"cell_type":"markdown","metadata":{"id":"sMwejqI6Pk9z"},"source":["**Time group 별 target 과의 상관관계 table export**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xG-Gpzg1PlPq"},"outputs":[],"source":["# corr_df = dataframe()\n","# for group_idx in range(group_nums):\n","#     viz_df = pd.concat([full_x[\"metadata_timegroup_\" + str(group_idx)].copy(), full_x[\"id_table\"][[\"target\"]]], axis=1).dropna()\n","#     tmp_corr = series()\n","#     for i in viz_df.select_dtypes([\"number\"]):\n","#         tmp_df = dataframe()\n","#         tmp_df[\"x\"] = viz_df[i]\n","#         tmp_df[\"y\"] = viz_df[\"target\"]\n","#         if i == \"target\":\n","#             continue\n","#         tmp_df = tmp_df[tmp_df[\"y\"] > 0]\n","#         if i == \"최근분무량\":\n","#             tmp_df = tmp_df[tmp_df[\"x\"] < 100000]\n","#         # else:\n","#         #     outlier_mask = (np.abs(stats.zscore(tmp_df[\"x\"])) > 3.0)\n","#         #     if outlier_mask.sum() > 0:\n","#         #         print(\"outlier \", i, outlier_mask.sum())\n","#         #     tmp_df = tmp_df[~outlier_mask]\n","#         tmp_corr = tmp_corr.append(series({i: tmp_df[\"x\"].corr(tmp_df[\"y\"])}))\n","#     tmp_corr.name = \"group_\" + str(group_idx)\n","#     corr_df = pd.concat([corr_df, tmp_corr], axis=1)\n","# corr_df.to_csv(folder_path + \"EDA/csv_output/time_group_corr.csv\", index=True, encoding=\"euc-kr\")"]},{"cell_type":"markdown","metadata":{"id":"efEg-UGEDznO"},"source":["**feature 간 상관관계 시각화**"]},{"cell_type":"markdown","metadata":{"id":"Drm7U-ynoAj2"},"source":["**heatmap on time group 0**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Jh8U87QH-wtJ"},"outputs":[],"source":["# plt.figure(figsize=(16, 9))\n","# graph = sns.heatmap(pd.concat([full_x[\"metadata_timegroup_0\"], full_x[\"id_table\"][[\"target\"]]], axis=1).corr().round(2), annot=True, cmap=\"YlGnBu\", annot_kws={\"fontsize\": 13, \"fontweight\": \"bold\"})\n","# graph.set_xticklabels(graph.get_xticklabels(), fontsize=12, fontweight=\"bold\")\n","# graph.set_yticklabels(graph.get_yticklabels(), fontsize=12, fontweight=\"bold\")\n","# plt.savefig(folder_path + \"EDA/graphs/corr_heatmap_time_group_0\")"]},{"cell_type":"markdown","metadata":{"id":"joNrBWC6n_41"},"source":["**heatmap on time group 12**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iDrsZHckn6pY"},"outputs":[],"source":["# plt.figure(figsize=(16, 9))\n","# graph = sns.heatmap(pd.concat([full_x[\"metadata_timegroup_12\"], full_x[\"id_table\"][[\"target\"]]], axis=1).corr().round(2), annot=True, cmap=\"YlGnBu\", annot_kws={\"fontsize\": 13, \"fontweight\": \"bold\"})\n","# graph.set_xticklabels(graph.get_xticklabels(), fontsize=12, fontweight=\"bold\")\n","# graph.set_yticklabels(graph.get_yticklabels(), fontsize=12, fontweight=\"bold\")\n","# plt.savefig(folder_path + \"EDA/graphs/corr_heatmap_time_group_12\")"]},{"cell_type":"markdown","metadata":{"id":"_3IPyjMGn7uY"},"source":["**heatmap on time group 23**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"PB-ULFben6mx"},"outputs":[],"source":["# plt.figure(figsize=(16, 9))\n","# graph = sns.heatmap(pd.concat([full_x[\"metadata_timegroup_23\"], full_x[\"id_table\"][[\"target\"]]], axis=1).corr().round(2), annot=True, cmap=\"YlGnBu\", annot_kws={\"fontsize\": 13, \"fontweight\": \"bold\"})\n","# graph.set_xticklabels(graph.get_xticklabels(), fontsize=12, fontweight=\"bold\")\n","# graph.set_yticklabels(graph.get_yticklabels(), fontsize=12, fontweight=\"bold\")\n","# plt.savefig(folder_path + \"EDA/graphs/corr_heatmap_time_group_23\")"]},{"cell_type":"markdown","metadata":{"id":"2_yvIEuSgQDJ"},"source":["**월별 feature 와의 상관관계 파악**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"catD5QumoL1O"},"outputs":[],"source":["# viz_df = pd.concat([full_x[\"metadata_short\"].copy(), full_x[\"id_table\"][[\"target\"]].copy()], axis=1).dropna()\n","# viz_df = viz_df[(viz_df[\"target\"] > 0) & viz_df[\"최근분무량\"] < 100000]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5P-mRMne56M2"},"outputs":[],"source":["# viz_df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"i4yuTmzxoLxE"},"outputs":[],"source":["# viz_df.groupby(\"month\").median().to_csv(folder_path + \"EDA/csv_output/month_median.csv\", index=True, encoding=\"euc-kr\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ofY2vhwnoLuD"},"outputs":[],"source":["# viz_df.groupby(\"month\").mean().to_csv(folder_path + \"EDA/csv_output/month_mean.csv\", index=True, encoding=\"euc-kr\")"]},{"cell_type":"markdown","metadata":{"id":"LWHjrCl7MrEt"},"source":["# Feature Engineering"]},{"cell_type":"markdown","metadata":{"id":"lvnQVkKSLYqv"},"source":["**가장 높은 상관관계를 갖는 각 feature에 대한 시간 선택 (안 함)**\n","\n","\n","\n","*   내부온도관측치 - time_group_22\n","*   내부습도관측치 - time_group_15\n","*   CO2관측치 - time_group_20\n","*   EC관측치 - time_group_20\n","*   최근분무량 - time_group_3\n","*   화이트 LED동작강도 - time_group_22\n","*   레드 LED동작강도 - time_group_7\n","*   블루 LED동작강도 - time_group_8\n","*   냉방온도 - time_group_9\n","*   냉방부하 - time_group_9\n","*   난방온도 - time_group_21\n","*   난방부하 - time_group_7\n","\n"]},{"cell_type":"code","source":["full_x[\"metadata_timegroup_0\"].info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vfYkY3ZyL-us","executionInfo":{"status":"ok","timestamp":1652423476086,"user_tz":-540,"elapsed":20,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"353f5e30-155b-496c-ccf4-712915aa0925"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1592 entries, 0 to 1591\n","Data columns (total 20 columns):\n"," #   Column       Non-Null Count  Dtype         \n","---  ------       --------------  -----         \n"," 0   id           1592 non-null   object        \n"," 1   timestamp    1592 non-null   datetime64[ns]\n"," 2   내부온도관측치      1276 non-null   float32       \n"," 3   외부온도관측치      1296 non-null   float32       \n"," 4   내부습도관측치      1278 non-null   float32       \n"," 5   외부습도관측치      1290 non-null   float32       \n"," 6   CO2관측치       1296 non-null   float32       \n"," 7   EC관측치        1286 non-null   float32       \n"," 8   최근분무량        1297 non-null   float32       \n"," 9   화이트 LED동작강도  1247 non-null   float32       \n"," 10  레드 LED동작강도   1233 non-null   float32       \n"," 11  블루 LED동작강도   1217 non-null   float32       \n"," 12  냉방온도         1272 non-null   float32       \n"," 13  냉방부하         1252 non-null   float32       \n"," 14  난방온도         1272 non-null   float32       \n"," 15  난방부하         1252 non-null   float32       \n"," 16  총추정광량        1271 non-null   float32       \n"," 17  백색광추정광량      1271 non-null   float32       \n"," 18  적색광추정광량      1271 non-null   float32       \n"," 19  청색광추정광량      1253 non-null   float32       \n","dtypes: datetime64[ns](1), float32(18), object(1)\n","memory usage: 136.9+ KB\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KZ5YtqJsPUWu"},"outputs":[],"source":["# default\n","selected_features = tuple([(i, 0) for i in full_x[\"metadata_timegroup_0\"].drop([\"id\", \"timestamp\"], axis=1).columns])\n","# # selected\n","# selected_features = (\n","#     (\"내부온도관측치\", 22),\n","#     (\"내부습도관측치\", 15),\n","#     (\"CO2관측치\", 20),\n","#     (\"EC관측치\", 20),\n","#     (\"최근분무량\", 3),\n","#     (\"화이트 LED동작강도\", 22),\n","#     (\"레드 LED동작강도\", 7),\n","#     (\"블루 LED동작강도\", 8),\n","#     (\"냉방온도\", 9),\n","#     (\"냉방부하\", 9),\n","#     (\"난방온도\", 21),\n","#     (\"난방부하\", 7),\n","#     (\"총추정광량\", 21)\n","# )\n","num_vars = [i[0] for i in selected_features]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"oO9_f1iSMv1t"},"outputs":[],"source":["# 다른 코드 호환을 위한 부분 (deprecated)\n","full_x[\"train_data\"] = dataframe()\n","test_x[\"test_data\"] = dataframe()\n","for i in selected_features:\n","    full_x[\"train_data\"] = pd.concat([full_x[\"train_data\"], full_x[\"metadata_timegroup_\" + str(i[1])][[i[0]]]], axis=1)\n","    test_x[\"test_data\"] = pd.concat([test_x[\"test_data\"], test_x[\"metadata_timegroup_\" + str(i[1])][[i[0]]]], axis=1)\n","full_x[\"train_data\"] = pd.concat([full_x[\"train_data\"], full_x[\"id_table\"][[\"id\", \"target\"]]], axis=1)\n","test_x[\"test_data\"] = pd.concat([test_x[\"test_data\"], test_x[\"id_table\"][[\"id\"]]], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"IQTuvVAt3mG_","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652361683250,"user_tz":-540,"elapsed":435,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"821dc354-9efb-422d-e769-717760c25953"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1592 entries, 0 to 1591\n","Data columns (total 20 columns):\n"," #   Column       Non-Null Count  Dtype  \n","---  ------       --------------  -----  \n"," 0   내부온도관측치      1276 non-null   float32\n"," 1   외부온도관측치      1296 non-null   float32\n"," 2   내부습도관측치      1278 non-null   float32\n"," 3   외부습도관측치      1290 non-null   float32\n"," 4   CO2관측치       1296 non-null   float32\n"," 5   EC관측치        1286 non-null   float32\n"," 6   최근분무량        1297 non-null   float32\n"," 7   화이트 LED동작강도  1247 non-null   float32\n"," 8   레드 LED동작강도   1233 non-null   float32\n"," 9   블루 LED동작강도   1217 non-null   float32\n"," 10  냉방온도         1272 non-null   float32\n"," 11  냉방부하         1252 non-null   float32\n"," 12  난방온도         1272 non-null   float32\n"," 13  난방부하         1252 non-null   float32\n"," 14  총추정광량        1271 non-null   float32\n"," 15  백색광추정광량      1271 non-null   float32\n"," 16  적색광추정광량      1271 non-null   float32\n"," 17  청색광추정광량      1253 non-null   float32\n"," 18  id           1592 non-null   object \n"," 19  target       1592 non-null   float32\n","dtypes: float32(19), object(1)\n","memory usage: 130.7+ KB\n"]}],"source":["full_x[\"train_data\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4_TnJSFFYIhi","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652361683250,"user_tz":-540,"elapsed":5,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"ea0a55d5-8b1d-4591-8ef5-f9854db09464"},"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 460 entries, 0 to 459\n","Data columns (total 19 columns):\n"," #   Column       Non-Null Count  Dtype  \n","---  ------       --------------  -----  \n"," 0   내부온도관측치      456 non-null    float32\n"," 1   외부온도관측치      455 non-null    float32\n"," 2   내부습도관측치      455 non-null    float32\n"," 3   외부습도관측치      455 non-null    float32\n"," 4   CO2관측치       455 non-null    float32\n"," 5   EC관측치        455 non-null    float32\n"," 6   최근분무량        457 non-null    float32\n"," 7   화이트 LED동작강도  431 non-null    float32\n"," 8   레드 LED동작강도   427 non-null    float32\n"," 9   블루 LED동작강도   433 non-null    float32\n"," 10  냉방온도         448 non-null    float32\n"," 11  냉방부하         448 non-null    float32\n"," 12  난방온도         448 non-null    float32\n"," 13  난방부하         448 non-null    float32\n"," 14  총추정광량        448 non-null    float32\n"," 15  백색광추정광량      448 non-null    float32\n"," 16  적색광추정광량      448 non-null    float32\n"," 17  청색광추정광량      448 non-null    float32\n"," 18  id           460 non-null    object \n","dtypes: float32(18), object(1)\n","memory usage: 36.1+ KB\n"]}],"source":["test_x[\"test_data\"].info()"]},{"cell_type":"markdown","metadata":{"id":"UbeZSKl7f7Y3"},"source":["**선택 feature 시각화**"]},{"cell_type":"markdown","metadata":{"id":"hBe2X10Zl7PS"},"source":["**1. Before removing anomaly**"]},{"cell_type":"markdown","metadata":{"id":"wHqB9dbEjrev"},"source":["**feature distribution**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"78LxkJvsjy7K"},"outputs":[],"source":["# for i in full_x[\"train_data\"].select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.histplot(full_x[\"train_data\"][i])\n","#     graph.set_title(i + \" 분포 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(full_x[\"train_data\"][i]), np.max(full_x[\"train_data\"][i])+1, (np.max(full_x[\"train_data\"][i])+1-np.min(full_x[\"train_data\"][i]))/10),\n","#             fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")\n","#     plt.savefig(folder_path + \"EDA/graphs/trainFeature_before_remove_anomaly_\" + i)"]},{"cell_type":"markdown","metadata":{"id":"3lhZPQKojurM"},"source":["**target - feature plot**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"iHFALIn8f7s3"},"outputs":[],"source":["# for i in full_x[\"train_data\"].select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     tmp_df = dataframe()\n","#     tmp_df[\"x\"] = full_x[\"train_data\"][i]\n","#     tmp_df[\"y\"] = full_x[\"train_data\"][\"target\"]\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(tmp_df[\"x\"], tmp_df[\"y\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" - target 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(full_x[\"train_data\"][i]), np.max(full_x[\"train_data\"][i])+1, (np.max(full_x[\"train_data\"][i])+1-np.min(full_x[\"train_data\"][i]))/10),\n","#             fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")\n","#     plt.savefig(folder_path + \"EDA/graphs/trainTarget_before_remove_anomaly_\" + i)"]},{"cell_type":"markdown","metadata":{"id":"XofDc6nwr1CJ"},"source":["**NA sample analysis & imputing**"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1652361683251,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"ZC6mFF2s4Xaa","outputId":"f8acf092-2071-40a9-c0de-c4fec02b38ef"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(295, 20)"]},"metadata":{},"execution_count":52}],"source":["full_x[\"train_data\"][full_x[\"train_data\"].drop([\"id\", \"target\"], axis=1).isna().all(axis=1)].shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5,"status":"ok","timestamp":1652361683251,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"wXhrsGfFeR9g","outputId":"465bbc96-d8ac-4c13-bd92-fa0eb967dd2d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Text(0.5, 1.0, \"target distribution all features' values are nan\")"]},"metadata":{},"execution_count":53},{"output_type":"display_data","data":{"text/plain":["<Figure size 864x576 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["ax = full_x[\"train_data\"][\"target\"][full_x[\"train_data\"].drop([\"id\", \"target\"], axis=1).isna().all(axis=1)].plot.hist(figsize=(12,8), edgecolor=\"black\")\n","ax.set_title(\"target distribution all features' values are nan\", fontsize=20, fontweight=\"bold\", pad=15)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":347,"status":"ok","timestamp":1652361683594,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"AqjlhRtveR7Y","outputId":"5c08c6e9-4b8c-4d6e-e0fb-d7cdf08c2263"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Text(0.5, 1.0, \"target distribution all features' values are not nan\")"]},"metadata":{},"execution_count":54},{"output_type":"display_data","data":{"text/plain":["<Figure size 864x576 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["ax = full_x[\"train_data\"][\"target\"][~full_x[\"train_data\"].drop([\"id\", \"target\"], axis=1).isna().all(axis=1)].plot.hist(figsize=(12,8), edgecolor=\"black\")\n","ax.set_title(\"target distribution all features' values are not nan\", fontsize=20, fontweight=\"bold\", pad=15)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XAyXfFKRubZ_"},"outputs":[],"source":["# full_x[\"train_data\"].head()"]},{"cell_type":"markdown","metadata":{"id":"T8aMMvKUNReq"},"source":["# Imputation - MissForest Imputing"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AKfAXJ2yXTVg"},"outputs":[],"source":["# missforest_imputor = MissForest(max_iter=10, n_estimators=1000, max_depth=6, max_features=0.8,\n","#                                 min_samples_split=0.05, min_samples_leaf=5, random_state=42)\n","# imputed_df = pd.concat([full_x[\"train_data\"][[\"id\"]], dataframe(missforest_imputor.fit_transform(full_x[\"train_data\"].drop(\"id\", axis=1)), columns=full_x[\"train_data\"].drop(\"id\", axis=1).columns)], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"UrqCrIDzutzB"},"outputs":[],"source":["# imputed_df[imputed_df.select_dtypes([\"float32\", \"float64\"]).columns] = imputed_df.select_dtypes([\"float32\", \"float64\"]).astype(\"float32\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8za4I5BVqv8H"},"outputs":[],"source":["# imputed_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"2nmadEfCN6XN"},"outputs":[],"source":["# full_x[\"train_data\"] = imputed_df\n","# full_x[\"train_data\"] = full_x[\"train_data\"][full_x[\"train_data\"][\"id\"] != \"CASE45_17.png\"]\n","# full_x[\"train_data\"].reset_index(drop=True, inplace=True)"]},{"cell_type":"markdown","metadata":{"id":"qK2Rw2IqtO6R"},"source":["**visualization after NA imputing**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"tviecNshzUwk"},"outputs":[],"source":["# for i in imputed_df.select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(imputed_df[i], imputed_df[\"target\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" target과 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15) \n","#     # graph.set_xticks(graph.get_xticks()[::1])\n","#     plt.xticks(np.arange(np.min(imputed_df[i]), np.max(imputed_df[i])+1, (np.max(imputed_df[i])+1-np.min(imputed_df[i]))/10))\n","#     # graph.set_xticklabels(graph.get_xticklabels()[::1], rotation=45)"]},{"cell_type":"markdown","metadata":{"id":"DJ_wQSHffv2d"},"source":["# Imputation - Normal Distribution Imputing"]},{"cell_type":"markdown","metadata":{"id":"7fYAM86ywzDX"},"source":["**feature가 모두 NA인 sample을 랜덤포레스트 방법으로 imputing 시, sample 내 다른 feature를 활용활 수 없는 상황이므로 각 feature에 대해 평균과 비슷하게 imputing이 되어버리는 문제가 발생**"]},{"cell_type":"markdown","metadata":{"id":"SXjflVpfz9pk"},"source":["**차라리 augmentation 비슷한 방법으로 target group별 평균 및 표준편차를 구해, 정규분포 랜덤값으로 NA값을 imputing 하는 것으로 결정**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0Mj5F_zur1TY"},"outputs":[],"source":["# imputed_df = full_x[\"train_data\"].copy()\n","# # imputed_df[\"target_group\"] = pd.cut(np.log1p(imputed_df[\"target\"]), bins=10).astype(\"object\")\n","# imputed_df[\"target_group\"] = pd.cut(imputed_df[\"target\"], bins=10).astype(\"object\")\n","# target_group_mean = imputed_df.groupby(\"target_group\").mean()\n","# target_group_std = np.sqrt(imputed_df.groupby(\"target_group\").std())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RYgMot99CSA5"},"outputs":[],"source":["# imputed_df[\"target_group\"].value_counts().sort_index()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"1_AU5g8R2att"},"outputs":[],"source":["# np_rnd.seed(1)\n","# for i in imputed_df[\"target_group\"].value_counts().sort_index().index:\n","#     for j in imputed_df.columns:\n","#         na_mask = imputed_df[imputed_df[\"target_group\"] == i][j].isna()\n","#         if na_mask.sum() <= 0:\n","#             continue\n","#         imputed_df.loc[(imputed_df[\"target_group\"] == i) & na_mask, j] = np_rnd.normal(target_group_mean.loc[i, j], max(1.0, target_group_std.loc[i, j]), na_mask.sum())\n","#         # imputed_df.loc[(imputed_df[\"target_group\"] == i) & na_mask, j] = target_group_mean.loc[i, j] + np.abs(np_rnd.normal(0, max(1.0, target_group_std.loc[i, j]), na_mask.sum()))\n","#         imputed_df[j] = imputed_df[j].apply(lambda x: max(x, full_x[\"train_data\"][j].min()))\n","#         imputed_df[j] = imputed_df[j].apply(lambda x: min(x, full_x[\"train_data\"][j].max()))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"RV4i4T7yr1p8"},"outputs":[],"source":["# imputed_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"J-UmoGKar1n4"},"outputs":[],"source":["# for i in imputed_df.select_dtypes([\"float32\", \"float64\"]):\n","#     if i in (\"id\", \"target\"):\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(imputed_df[i], imputed_df[\"target\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" target과 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15) \n","#     # graph.set_xticks(graph.get_xticks()[::1])\n","#     plt.xticks(np.arange(np.min(imputed_df[i]), np.max(imputed_df[i])+1, (np.max(imputed_df[i])+1-np.min(imputed_df[i]))/10))\n","#     # graph.set_xticklabels(graph.get_xticklabels()[::1], rotation=45)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YXPZI_VcyOjp"},"outputs":[],"source":["# imputed_df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"L92gSdKaxnVY"},"outputs":[],"source":["# missforest_imputor = MissForest(max_iter=10, n_estimators=1000, max_depth=6, max_features=0.8,\n","#                                 min_samples_split=0.05, min_samples_leaf=5, random_state=42)\n","# missforest_imputor.fit(imputed_df.drop([\"id\", target_var, \"target_group\"], axis=1))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"V10--KfFhzTk"},"outputs":[],"source":["# for i in test_x[\"test_data\"]:\n","#     if i == \"id\":\n","#         continue\n","#     test_x[\"test_data\"][i] = test_x[\"test_data\"][i].fillna(full_x[\"train_data\"][i].median())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AinoXoDVg8BU"},"outputs":[],"source":["# full_x[\"train_data\"] = imputed_df.drop(\"target_group\", axis=1)\n","# full_x[\"train_data\"] = full_x[\"train_data\"][full_x[\"train_data\"][\"id\"] != \"CASE45_17.png\"]\n","# full_x[\"train_data\"].reset_index(drop=True, inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"DuT1C1N2hzBT"},"outputs":[],"source":["# full_x[\"train_data\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YQoqwzYkhy-o"},"outputs":[],"source":["# test_x[\"test_data\"].info()"]},{"cell_type":"markdown","metadata":{"id":"-dneoNYlf0dp"},"source":["# Imputation - Drop na values and MissForest Imputing"]},{"cell_type":"markdown","metadata":{"id":"RYUnkwGNMpAP"},"source":["**Drop samples which all the features' are na values and imputing missforest**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MvPRYh7kS5a1"},"outputs":[],"source":["# full_x[\"train_data\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xIooHO6rP17j"},"outputs":[],"source":["# imputed_df = full_x[\"train_data\"].copy()\n","# imputed_df = imputed_df[~imputed_df.drop([\"id\", \"target\"], axis=1).isna().all(axis=1)]\n","# imputed_df.reset_index(drop=True, inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"kkP1YQRIQJC9"},"outputs":[],"source":["# imputed_df.drop([\"id\", \"target\"], axis=1).isna().all(axis=1).sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ogrXnJZDQbYy"},"outputs":[],"source":["# imputed_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"uD-su789QzgA"},"outputs":[],"source":["# missforest_imputor = MissForest(max_iter=10, n_estimators=1000, max_depth=6, max_features=0.8,\n","#                                 min_samples_split=0.05, min_samples_leaf=5, random_state=42)\n","# imputed_df = pd.concat([imputed_df[[\"id\", target_var]], dataframe(missforest_imputor.fit_transform(imputed_df.drop([\"id\", target_var], axis=1)), columns=imputed_df.drop([\"id\", target_var], axis=1).columns)], axis=1)"]},{"cell_type":"markdown","metadata":{"id":"wFv7vu0kQ1bJ"},"source":["**replace original df with imputed df**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ObvFgYyMSKx4"},"outputs":[],"source":["# imputed_df.info()"]},{"cell_type":"markdown","metadata":{"id":"HtEKbKWG7dnZ"},"source":["# Imputation(Present) - using random normal noise & knn obejcts on target"]},{"cell_type":"markdown","metadata":{"id":"UI1FhQDO6cX2"},"source":["**create time series data**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qGRKnOw21mpS","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652361705986,"user_tz":-540,"elapsed":22396,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"739cac14-6003-4c7f-c675-92cdc9014eca"},"outputs":[{"output_type":"stream","name":"stdout","text":["(1592, 96, 18)\n"]}],"source":["train_timeseries = np.empty((full_x[\"train_data\"].shape[0], group_nums, len(num_vars)))\n","# time group 별 dataframe들을 모두 row-by로 concat한 후 id 를 인덱스로 설정\n","all_timeseries_df = pd.concat([full_x[\"metadata_timegroup_\" + str(i)] for i in range(group_nums)], axis=0).set_index(\"id\")\n","for idx, value in enumerate(full_x[\"train_data\"][\"id\"]):\n","    # 각 sample id 별로 추출하여 3차원 배열에 넣기 (num_vars에 입력된 순서대로 뽑아 입력)\n","    tmp_df = all_timeseries_df.loc[value, num_vars]\n","    # na값이 전체 길이의 50%를 초과하지 않으면 forward fill 적용\n","    for i in tmp_df:\n","        if tmp_df[i].isna().sum() <= len(tmp_df[i]) * 0.5:\n","            tmp_df[i] = tmp_df[i].ffill().bfill()\n","    train_timeseries[idx] = tmp_df.to_numpy(dtype=\"float32\")\n","print(train_timeseries.shape)"]},{"cell_type":"code","source":["full_x_img = full_x[\"id_table\"][\"id\"]\n","full_y = full_x[\"id_table\"][[\"target\"]]"],"metadata":{"id":"y2skz49Kwyck"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rZw_7tfxeFls"},"outputs":[],"source":["tmp_timeseries = dataframe(np.concatenate([i for i in train_timeseries], axis=0), columns=num_vars)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B7x20Zohei9-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1652361705987,"user_tz":-540,"elapsed":17,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"1bfd4200-47f3-495e-ad9a-e4531141e0b8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(152832, 18)"]},"metadata":{},"execution_count":81}],"source":["tmp_timeseries.shape"]},{"cell_type":"markdown","source":["**시계열 데이터를 feature 별로 concat 하여 시각화**"],"metadata":{"id":"g53u5Pc5XrCd"}},{"cell_type":"code","execution_count":null,"metadata":{"id":"3aejKD2vei8C"},"outputs":[],"source":["# # histogram\n","# for i in tmp_timeseries.select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.histplot(tmp_timeseries[i])\n","#     graph.set_title(i + \" 분포 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(tmp_timeseries[i]), np.max(tmp_timeseries[i])+1, (np.max(tmp_timeseries[i])+1-np.min(tmp_timeseries[i]))/20),\n","#             fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")"]},{"cell_type":"code","source":["# # boxplot\n","# for i in tmp_timeseries.select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.boxplot(tmp_timeseries[i])\n","#     graph.set_title(i + \" 분포 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(tmp_timeseries[i]), np.max(tmp_timeseries[i])+1, (np.max(tmp_timeseries[i])+1-np.min(tmp_timeseries[i]))/20),\n","#             fontsize=12, fontweight=\"bold\")\n","#     # plt.yticks(fontsize=12, fontweight=\"bold\")"],"metadata":{"id":"rV2azCvbrvz8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # violin plot\n","# for i in tmp_timeseries.select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.violinplot(tmp_timeseries[i])\n","#     graph.set_title(i + \" 분포 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(tmp_timeseries[i]), np.max(tmp_timeseries[i])+1, (np.max(tmp_timeseries[i])+1-np.min(tmp_timeseries[i]))/20),\n","#             fontsize=12, fontweight=\"bold\")\n","#     # plt.yticks(fontsize=12, fontweight=\"bold\")"],"metadata":{"id":"PEScI2FUJKn4"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# plt.figure(figsize=(16, 9))\n","# graph = sns.heatmap(tmp_timeseries.corr().round(2), annot=True, cmap=\"YlGnBu\", annot_kws={\"fontsize\": 13, \"fontweight\": \"bold\"})\n","# graph.set_xticklabels(graph.get_xticklabels(), fontsize=12, fontweight=\"bold\", rotation=45)\n","# graph.set_yticklabels(graph.get_yticklabels(), fontsize=12, fontweight=\"bold\")"],"metadata":{"id":"_goHIADp2PIY"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16,"status":"ok","timestamp":1652361705988,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"6G0ZVK4Ogw2m","outputId":"2bff92c0-9694-43ff-fdf5-b10ea56ad3fd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.000000         9418\n","74.559998          29\n","80.989998         139\n","87.419998          55\n","106.709999          2\n","                 ... \n","14559.559570       14\n","642939.500000       4\n","642945.937500       6\n","642991.000000       8\n","642997.375000       2\n","Name: 최근분무량, Length: 336, dtype: int64"]},"metadata":{},"execution_count":86}],"source":["tmp_timeseries[\"최근분무량\"].value_counts().sort_index()"]},{"cell_type":"code","source":["tmp_timeseries[\"외부습도관측치\"].value_counts().sort_index()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HHJDqUtq64Jm","executionInfo":{"status":"ok","timestamp":1652361705988,"user_tz":-540,"elapsed":13,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"eed7796e-8628-4cdd-e6fe-30425b9317da"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.000000      1685\n","5.500000         2\n","5.600000         6\n","5.800000        10\n","5.900000         8\n","              ... \n","92.300003        1\n","92.500000        1\n","92.599998        1\n","92.699997        1\n","201.000000      43\n","Name: 외부습도관측치, Length: 2609, dtype: int64"]},"metadata":{},"execution_count":87}]},{"cell_type":"code","source":["tmp_timeseries[\"EC관측치\"].value_counts().sort_index()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_GTKd4AV86p5","executionInfo":{"status":"ok","timestamp":1652361705988,"user_tz":-540,"elapsed":11,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"c0b451f6-f308-44d4-81e3-601c0ed09706"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.000000     11413\n","0.000756         1\n","0.000770        18\n","0.000905        33\n","0.000939         2\n","             ...  \n","30.000000        2\n","30.200001        3\n","30.299999        1\n","30.500000        1\n","30.900000        1\n","Name: EC관측치, Length: 14314, dtype: int64"]},"metadata":{},"execution_count":88}]},{"cell_type":"code","source":["del tmp_timeseries"],"metadata":{"id":"J5kdA6wDXqVU"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**필요한 feature만 추출 후 다시 train timeseries 데이터 생성**"],"metadata":{"id":"4Il3WJiw1xSh"}},{"cell_type":"code","source":["# num_vars = [\"내부온도관측치\", \"내부습도관측치\", \"CO2관측치\", \"EC관측치\", \"최근분무량\",\n","#             \"화이트 LED동작강도\", \"레드 LED동작강도\", \"블루 LED동작강도\",\n","#             \"냉방온도\", \"냉방부하\", \"난방온도\", \"난방부하\"]"],"metadata":{"id":"9zZE08P71zzN"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_timeseries = np.empty((full_x[\"train_data\"].shape[0], group_nums, len(num_vars)))\n","# time group 별 dataframe들을 모두 row-by로 concat한 후 id 를 인덱스로 설정\n","all_timeseries_df = pd.concat([full_x[\"metadata_timegroup_\" + str(i)] for i in range(group_nums)], axis=0).set_index(\"id\")\n","for idx, value in enumerate(full_x[\"train_data\"][\"id\"]):\n","    # 각 sample id 별로 추출하여 3차원 배열에 넣기 (num_vars에 입력된 순서대로 뽑아 입력)\n","    tmp_df = all_timeseries_df.loc[value, num_vars]\n","    # na값이 전체 길이의 50%를 초과하지 않으면 forward fill 적용\n","    for i in tmp_df:\n","        if tmp_df[i].isna().sum() <= len(tmp_df[i]) * 0.5:\n","            tmp_df[i] = tmp_df[i].ffill().bfill()\n","    train_timeseries[idx] = tmp_df.to_numpy(dtype=\"float32\")\n","print(train_timeseries.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uabWm7K61xCb","executionInfo":{"status":"ok","timestamp":1652361729351,"user_tz":-540,"elapsed":23372,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"9d606e74-5a67-47d7-8a85-72e439cb28c9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["(1592, 96, 18)\n"]}]},{"cell_type":"code","source":["notAll_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","for i in range(train_timeseries.shape[0]):\n","    if np.isnan(train_timeseries[i]).sum() == train_timeseries.shape[1] * train_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(train_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"],"metadata":{"id":"K3p-L12dv8mb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"7pk0NIkuv8jz","executionInfo":{"status":"ok","timestamp":1652361729352,"user_tz":-540,"elapsed":12,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"cdafdacb-13c6-4209-9ca1-45dba80d5374"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","283\n","하나 이상의 데이터가 nan 인 샘플\n","40\n"]}]},{"cell_type":"markdown","source":["**시계열 데이터 분포에 근거하여 이상치를 nan으로 대치 후 foward fill**"],"metadata":{"id":"VSJkesZ4XXzs"}},{"cell_type":"code","source":["def insert_nan_anomaly(x):\n","    tmp_df = dataframe(x, columns=num_vars)\n","    tmp_df[\"최근분무량\"][tmp_df[\"최근분무량\"] > 100000.0] = nan\n","    # na값이 전체 길이의 50%를 초과하지 않으면 forward fill 적용\n","    for i in tmp_df:\n","        if tmp_df[i].isna().sum() <= len(tmp_df[i]) * 0.5:\n","            tmp_df[i] = tmp_df[i].ffill().bfill()\n","    return array(tmp_df)"],"metadata":{"id":"04sGr9zsErTB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for i in range(train_timeseries.shape[0]):\n","    train_timeseries[i] = insert_nan_anomaly(train_timeseries[i])"],"metadata":{"id":"JBje4bESF-IH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["notAll_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","for i in range(train_timeseries.shape[0]):\n","    if np.isnan(train_timeseries[i]).sum() == train_timeseries.shape[1] * train_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(train_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"],"metadata":{"id":"NVd4IV-XwHE2"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_y68qnFZwIJw","executionInfo":{"status":"ok","timestamp":1652361746306,"user_tz":-540,"elapsed":11,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"f536c8b6-dbee-4523-98aa-f4dee4b8ed9d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","283\n","하나 이상의 데이터가 nan 인 샘플\n","40\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OnvubQyWKLa_"},"outputs":[],"source":["# anomaly_vec = anomaly_vec[0] & anomaly_vec[1] & anomaly_vec[2]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"hLC2DyNjiISO"},"outputs":[],"source":["# print(\"samples before removig anoamlies :\", train_timeseries.shape[0])\n","# print(\"samples after removig anoamlies :\", sum(anomaly_vec))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"e4y6aEfciAJm"},"outputs":[],"source":["# train_timeseries = train_timeseries[anomaly_vec]\n","# full_x[\"train_data\"] = full_x[\"train_data\"][anomaly_vec]\n","# full_x[\"train_data\"].reset_index(drop=True, inplace=True)"]},{"cell_type":"code","source":["train_timeseries.shape[1] * train_timeseries.shape[2]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jQ4T32p63sed","executionInfo":{"status":"ok","timestamp":1652361746307,"user_tz":-540,"elapsed":9,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"d15bc559-fbb8-4ac4-dc2e-f01eb6be8a09"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1728"]},"metadata":{},"execution_count":101}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zcroQuyPlutd"},"outputs":[],"source":["notAll_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","for i in range(train_timeseries.shape[0]):\n","    if np.isnan(train_timeseries[i]).sum() == train_timeseries.shape[1] * train_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(train_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aU9c1TxP3o9I","executionInfo":{"status":"ok","timestamp":1652361746307,"user_tz":-540,"elapsed":7,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"3230a401-3f29-47f1-c1e7-7c2a06a7f57c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","283\n","하나 이상의 데이터가 nan 인 샘플\n","40\n"]}]},{"cell_type":"markdown","source":["**test timeseries 데이터 생성**"],"metadata":{"id":"l-Ec3PtY2S13"}},{"cell_type":"code","source":["test_timeseries = np.empty((test_x[\"test_data\"].shape[0], group_nums, len(num_vars)))\n","all_timeseries_df = pd.concat([test_x[\"metadata_timegroup_\" + str(i)] for i in range(group_nums)], axis=0).set_index(\"id\")\n","for idx, value in enumerate(test_x[\"test_data\"][\"id\"]):\n","    # fill & bfill 후 nan 값이 남아있는 timeseries 데이터는 모든 데이터가 nan 값이기 때문임\n","    tmp_df = all_timeseries_df.loc[value, num_vars]\n","    # na값이 전체 길이의 50%를 초과하지 않으면 forward fill 적용\n","    for i in tmp_df:\n","        if tmp_df[i].isna().sum() <= len(tmp_df[i]) * 0.5:\n","            tmp_df[i] = tmp_df[i].ffill().bfill()\n","    test_timeseries[idx] = tmp_df.to_numpy(dtype=\"float32\")\n","print(test_timeseries.shape)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aq6Fqcf31JfZ","executionInfo":{"status":"ok","timestamp":1652361750798,"user_tz":-540,"elapsed":4496,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"8a4dad20-f653-4896-e262-67682df70030"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["(460, 96, 18)\n"]}]},{"cell_type":"code","source":["test_x_img = test_x[\"id_table\"][\"id\"]"],"metadata":{"id":"A0rXodQ41USB"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["notAll_na_list = np.ones(test_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(test_timeseries.shape[0], dtype=\"bool\")\n","for i in range(test_timeseries.shape[0]):\n","    if np.isnan(test_timeseries[i]).sum() == test_timeseries.shape[1] * test_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(test_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"],"metadata":{"id":"FvPgpAJV1wkZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["np.isnan(test_timeseries).sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yTSTqSL5TmjW","executionInfo":{"status":"ok","timestamp":1652361750799,"user_tz":-540,"elapsed":16,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"af7cac55-fb51-4ada-8526-57463f4188ca"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1485"]},"metadata":{},"execution_count":107}]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6CZgNUDh1y6B","executionInfo":{"status":"ok","timestamp":1652361750799,"user_tz":-540,"elapsed":14,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"653d0261-4b1e-4a54-f33c-189627a599d4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","0\n","하나 이상의 데이터가 nan 인 샘플\n","2\n"]}]},{"cell_type":"markdown","source":["# 1. drop NA"],"metadata":{"id":"Sv6hj7cT5PR5"}},{"cell_type":"code","source":["# train_timeseries = train_timeseries[all_na_list]\n","# full_x_img = full_x_img[all_na_list]; full_x_img.reset_index(drop=True, inplace=True)\n","# full_y = full_y[all_na_list]; full_y.reset_index(drop=True, inplace=True)"],"metadata":{"id":"Mm9FsXZf6Y62"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**image 이상치 & target이 0인 sample drop**"],"metadata":{"id":"YjzPSUN7vgfm"}},{"cell_type":"code","source":["# train_timeseries = train_timeseries[full_x_img != \"CASE45_17.png\"]\n","# full_y = full_y[full_x_img != \"CASE45_17.png\"]; full_y.reset_index(drop=True, inplace=True)\n","# full_x_img = full_x_img[full_x_img != \"CASE45_17.png\"]; full_x_img.reset_index(drop=True, inplace=True)\n","\n","# train_timeseries = train_timeseries[full_y[\"target\"] == 0]\n","# full_x_img = full_x_img[full_y[\"target\"] == 0]; full_x_img.reset_index(drop=True, inplace=True)\n","# full_y = full_y[full_y[\"target\"] == 0]; full_y.reset_index(drop=True, inplace=True)"],"metadata":{"id":"hGN9UPFWv3gi"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# train_timeseries.shape"],"metadata":{"id":"5sU61R0y6bJa"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NwJ_6QomcLSR"},"outputs":[],"source":["# viz_df = dataframe(np.concatenate([i for i in train_timeseries], axis=0), columns=num_vars)\n","# for i in viz_df:\n","#     print(viz_df[i].value_counts())\n","#     print()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Tcc0ZbvOcIos"},"outputs":[],"source":["# for i in viz_df.select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.histplot(viz_df[i])\n","#     graph.set_title(i + \" 분포 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(viz_df[i]), np.max(viz_df[i])+1, (np.max(viz_df[i])+1-np.min(viz_df[i]))/10),\n","#             fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")\n","#     # plt.savefig(folder_path + \"EDA/graphs/trainFeature_before_remove_anomaly_\" + i)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Nf_aPu14RuuJ"},"outputs":[],"source":["# test_timeseries = np.empty((test_x[\"test_data\"].shape[0], group_nums, len(num_vars)))\n","# all_timeseries_df = pd.concat([test_x[\"metadata_timegroup_\" + str(i)] for i in range(group_nums)], axis=0).set_index(\"id\")\n","# for idx, value in enumerate(test_x[\"test_data\"][\"id\"]):\n","#     # if (~tmp_df.loc[value, num_vars].isna()).sum().sum() == 0:\n","#     #     print(\"all values are nan :\", value)\n","#     # elif tmp_df.loc[value, num_vars].isna().sum().sum() >= len(num_vars) * 24 // 2:\n","#     #     print(\"na values are half :\", value)\n","#     # fill & bfill 후 nan 값이 남아있는 timeseries 데이터는 모든 데이터가 nan 값이기 때문임\n","#     test_timeseries[idx] = all_timeseries_df.loc[value, num_vars].ffill().bfill().to_numpy(dtype=\"float32\")\n","# print(test_timeseries.shape)"]},{"cell_type":"code","source":["# test_x_img = test_x[\"id_table\"][\"id\"]"],"metadata":{"id":"Uwu_dMWiFiAV"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"b5tFjS7clmU0"},"outputs":[],"source":["# all_na_list = np.ones(test_timeseries.shape[0], dtype=\"bool\")\n","# exist_na_list = np.ones(test_timeseries.shape[0], dtype=\"bool\")\n","# for i in range(test_timeseries.shape[0]):\n","#     if np.isnan(test_timeseries[i]).sum() == test_timeseries.shape[1] * test_timeseries.shape[2]:\n","#         all_na_list[i] = False\n","#     elif np.isnan(test_timeseries[i]).sum() > test_timeseries.shape[1] * test_timeseries.shape[2]:\n","#         exist_na_list[i] = False"]},{"cell_type":"code","source":["# print(\"모든 데이터가 nan 인 샘플\")\n","# print(np.invert(all_na_list).sum())\n","# print(\"하나 이상의 데이터가 nan 인 샘플\")\n","# print(np.invert(exist_na_list).sum())"],"metadata":{"id":"iv1w1SJn6qIu"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# ct = ColumnTransformer([\n","#     (\"내부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","#     (\"내부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","#     (\"CO2관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","#     (\"EC관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","#     (\"최근분무량_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","#     (\"화이트 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","#     (\"레드 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","#     (\"블루 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","#     (\"냉방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","#     (\"냉방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","#     (\"난방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","#     (\"난방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","# ])"],"metadata":{"id":"_7Pls7717ZWR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# ct.fit(pd.concat([dataframe(i, columns=num_vars) for i in train_timeseries], axis=0).dropna())"],"metadata":{"id":"DdwPWmmV7h_4"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# 2. KNN Imputing"],"metadata":{"id":"dzczjMD_5UbD"}},{"cell_type":"code","source":["# remove image anomaly\n","train_timeseries = train_timeseries[full_x_img != \"CASE45_17.png\"]\n","full_y = full_y[full_x_img != \"CASE45_17.png\"]; full_y.reset_index(drop=True, inplace=True)\n","full_x_img = full_x_img[full_x_img != \"CASE45_17.png\"]; full_x_img.reset_index(drop=True, inplace=True)\n","# remove target 0\n","train_timeseries = train_timeseries[full_y[\"target\"] != 0.0]\n","full_x_img = full_x_img[full_y[\"target\"] != 0.0]; full_x_img.reset_index(drop=True, inplace=True)\n","full_y = full_y[full_y[\"target\"] != 0.0]; full_y.reset_index(drop=True, inplace=True)"],"metadata":{"id":"4lgZyXsCwfcr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["full_x_img"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"P7M-fzN57v02","executionInfo":{"status":"ok","timestamp":1652361751337,"user_tz":-540,"elapsed":16,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"31fecb76-e787-4df6-ddc5-1f9a2a83a395"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0       CASE01_01.png\n","1       CASE01_02.png\n","2       CASE01_03.png\n","3       CASE01_04.png\n","4       CASE01_05.png\n","            ...      \n","1578    CASE74_25.png\n","1579    CASE74_26.png\n","1580    CASE74_27.png\n","1581    CASE75_01.png\n","1582    CASE75_02.png\n","Name: id, Length: 1583, dtype: object"]},"metadata":{},"execution_count":121}]},{"cell_type":"code","source":["full_y.info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"D9NhSIBY7xNb","executionInfo":{"status":"ok","timestamp":1652361751338,"user_tz":-540,"elapsed":15,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"5bf89c35-9c08-4253-c4ac-c7d7b41e6a57"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","RangeIndex: 1583 entries, 0 to 1582\n","Data columns (total 1 columns):\n"," #   Column  Non-Null Count  Dtype  \n","---  ------  --------------  -----  \n"," 0   target  1583 non-null   float32\n","dtypes: float32(1)\n","memory usage: 6.3 KB\n"]}]},{"cell_type":"markdown","metadata":{"id":"gLVJZsMDdv9d"},"source":["**imputing 전, 사전 discretizer fit 작업 (imputing 된 값이 군집에 영향을 미칠 수 있으므로)**"]},{"cell_type":"code","source":["ct = ColumnTransformer([\n","    (\"내부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","    (\"외부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"외부온도관측치\"]),\n","    (\"내부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","    (\"외부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"외부습도관측치\"]),\n","    (\"CO2관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","    (\"EC관측치_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","    (\"최근분무량_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","    (\"화이트 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","    (\"레드 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","    (\"블루 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","    (\"냉방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","    (\"냉방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","    (\"난방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","    (\"난방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","    (\"총추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"총추정광량\"]),\n","    (\"백색광추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"백색광추정광량\"]),\n","    (\"적색광추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"적색광추정광량\"]),\n","    (\"청색광추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"청색광추정광량\"]),\n","])"],"metadata":{"id":"rEzv7YU29x8D"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TyBJ5p35dvt2"},"outputs":[],"source":["# ct = ColumnTransformer([\n","#     (\"내부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","#     (\"내부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","#     (\"CO2관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","#     (\"EC관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","#     (\"최근분무량_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","#     (\"화이트 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","#     (\"레드 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","#     (\"블루 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","#     (\"냉방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","#     (\"냉방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","#     (\"난방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","#     (\"난방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","# ])"]},{"cell_type":"code","source":["cat_vars = [i[0] for i in ct._transformers]"],"metadata":{"id":"l7VyFIzC0Qa_"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":1712,"status":"ok","timestamp":1652361753040,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"lrSncj5hIxxo","colab":{"base_uri":"https://localhost:8080/"},"outputId":"8a57a662-e02c-4eeb-8a7a-a8040448f28b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["ColumnTransformer(transformers=[('내부온도관측치_discret',\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=100,\n","                                                  strategy='kmeans'),\n","                                 ['내부온도관측치']),\n","                                ('외부온도관측치_discret',\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=100,\n","                                                  strategy='kmeans'),\n","                                 ['외부온도관측치']),\n","                                ('내부습도관측치_discret',\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=100,\n","                                                  strategy='kmeans'),\n","                                 ['내부습도관측치']),\n","                                ('외부습도관측치_discret',\n","                                 KBinsDiscre...\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=10,\n","                                                  strategy='kmeans'),\n","                                 ['총추정광량']),\n","                                ('백색광추정광량_discret',\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=10,\n","                                                  strategy='kmeans'),\n","                                 ['백색광추정광량']),\n","                                ('적색광추정광량_discret',\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=10,\n","                                                  strategy='kmeans'),\n","                                 ['적색광추정광량']),\n","                                ('청색광추정광량_discret',\n","                                 KBinsDiscretizer(encode='ordinal', n_bins=10,\n","                                                  strategy='kmeans'),\n","                                 ['청색광추정광량'])])"]},"metadata":{},"execution_count":126}],"source":["ct.fit(pd.concat([dataframe(i, columns=num_vars) for i in train_timeseries], axis=0).dropna())"]},{"cell_type":"markdown","metadata":{"id":"OlY6peww6MHM"},"source":["**결측된 데이터가 있는 특정 샘플에 대해 knn을 찾고 random normal imputing 시행 (image + target 값 사용)**"]},{"cell_type":"code","source":["# 모든 데이터가 nan인 index 산출\n","notAll_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","for i in range(train_timeseries.shape[0]):\n","    if np.isnan(train_timeseries[i]).sum() == train_timeseries.shape[1] * train_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(train_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"],"metadata":{"id":"R4hk-WFT4n6u"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4sq1JRfl61C2","executionInfo":{"status":"ok","timestamp":1652361753041,"user_tz":-540,"elapsed":10,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"296786e0-705f-42ac-d377-6125913f82b9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","278\n","하나 이상의 데이터가 nan 인 샘플\n","40\n"]}]},{"cell_type":"code","source":["np.isnan(train_timeseries[notAll_na_list & notAny_na_list]).sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fvbViEkhtr_Z","executionInfo":{"status":"ok","timestamp":1652361753041,"user_tz":-540,"elapsed":9,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"9c284ada-79db-4d4e-a914-a2d9b6797991"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":129}]},{"cell_type":"code","source":["candidates_mask = notAll_na_list & notAny_na_list"],"metadata":{"id":"7LVY5vZUtoys"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0zIpcmXAhCpQ"},"outputs":[],"source":["knn_candidates = full_y[[\"target\"]][candidates_mask].copy()"]},{"cell_type":"code","source":["# minmax normalization\n","knn_scaler = MinMaxScaler()\n","knn_candidates = dataframe(knn_scaler.fit_transform(knn_candidates), index=knn_candidates.index)"],"metadata":{"id":"9HOt9KxL5S12"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["img_size = 128\n","channels = 3\n","knn_img = np.empty((candidates_mask.sum(), img_size * img_size * channels))\n","for idx, value in enumerate(full_x_img[candidates_mask].apply(lambda x: get_image_path(x, train=True))):\n","    image = tf.io.read_file(value)\n","    image = tf.io.decode_image(image, channels=channels, expand_animations=False)\n","    image = tf.cast(image, tf.float32)\n","    image = tf.image.resize_with_pad(image, img_size, img_size, antialias=True).numpy().flatten() / 255.0\n","    knn_img[idx] = image"],"metadata":{"id":"oOo0M-I77pRr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["knn_candidates = pd.concat([dataframe(knn_img, index=knn_candidates.index), knn_candidates], axis=1).astype(\"float32\")\n","knn_candidates.columns = list(range(knn_candidates.shape[1]))\n","del knn_img"],"metadata":{"id":"qktyAANZ7pPh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["knn_candidates.info()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jWKEE6BA-6py","executionInfo":{"status":"ok","timestamp":1652361948053,"user_tz":-540,"elapsed":3010,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"4d244f03-5ee8-402f-a79a-cb70e2b2b8ab"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["<class 'pandas.core.frame.DataFrame'>\n","Int64Index: 1265 entries, 20 to 1582\n","Columns: 49153 entries, 0 to 49152\n","dtypes: float32(49153)\n","memory usage: 237.2 MB\n"]}]},{"cell_type":"code","source":["knn_candidates.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":300},"id":"Q4ZNtzOE7kuJ","executionInfo":{"status":"ok","timestamp":1652361948054,"user_tz":-540,"elapsed":11,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"fff16839-2a7f-4232-f69e-6a1307631b78"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["    0      1      2      3      4      5      6      7      8      9      10     11     12     13     14     15     16     17     18     19     20     21     22     23     24     25     26     27     28     29     30     31     32     33     34     35     36     37     38     39     40     41     42     43     44     45     46     47     48     49     ...  49103  49104  49105  49106  49107  49108  49109  49110  49111  49112  49113  49114  49115  49116  49117  49118  49119  49120  49121  49122  49123  49124  49125  49126  49127  49128  49129  49130  49131  49132  49133  49134  49135  49136  49137  49138  49139  49140  49141  49142  49143  49144  49145  49146  49147  49148  49149  49150  49151     49152\n","20    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.024120\n","21    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.033482\n","22    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.045772\n","23    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.057711\n","24    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  ...    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  0.068771\n","\n","[5 rows x 49153 columns]"],"text/html":["\n","  <div id=\"df-dbf8cb2f-b770-4a71-820f-2d6bd6564ba4\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>0</th>\n","      <th>1</th>\n","      <th>2</th>\n","      <th>3</th>\n","      <th>4</th>\n","      <th>5</th>\n","      <th>6</th>\n","      <th>7</th>\n","      <th>8</th>\n","      <th>9</th>\n","      <th>10</th>\n","      <th>11</th>\n","      <th>12</th>\n","      <th>13</th>\n","      <th>14</th>\n","      <th>15</th>\n","      <th>16</th>\n","      <th>17</th>\n","      <th>18</th>\n","      <th>19</th>\n","      <th>20</th>\n","      <th>21</th>\n","      <th>22</th>\n","      <th>23</th>\n","      <th>24</th>\n","      <th>25</th>\n","      <th>26</th>\n","      <th>27</th>\n","      <th>28</th>\n","      <th>29</th>\n","      <th>30</th>\n","      <th>31</th>\n","      <th>32</th>\n","      <th>33</th>\n","      <th>34</th>\n","      <th>35</th>\n","      <th>36</th>\n","      <th>37</th>\n","      <th>38</th>\n","      <th>39</th>\n","      <th>40</th>\n","      <th>41</th>\n","      <th>42</th>\n","      <th>43</th>\n","      <th>44</th>\n","      <th>45</th>\n","      <th>46</th>\n","      <th>47</th>\n","      <th>48</th>\n","      <th>49</th>\n","      <th>...</th>\n","      <th>49103</th>\n","      <th>49104</th>\n","      <th>49105</th>\n","      <th>49106</th>\n","      <th>49107</th>\n","      <th>49108</th>\n","      <th>49109</th>\n","      <th>49110</th>\n","      <th>49111</th>\n","      <th>49112</th>\n","      <th>49113</th>\n","      <th>49114</th>\n","      <th>49115</th>\n","      <th>49116</th>\n","      <th>49117</th>\n","      <th>49118</th>\n","      <th>49119</th>\n","      <th>49120</th>\n","      <th>49121</th>\n","      <th>49122</th>\n","      <th>49123</th>\n","      <th>49124</th>\n","      <th>49125</th>\n","      <th>49126</th>\n","      <th>49127</th>\n","      <th>49128</th>\n","      <th>49129</th>\n","      <th>49130</th>\n","      <th>49131</th>\n","      <th>49132</th>\n","      <th>49133</th>\n","      <th>49134</th>\n","      <th>49135</th>\n","      <th>49136</th>\n","      <th>49137</th>\n","      <th>49138</th>\n","      <th>49139</th>\n","      <th>49140</th>\n","      <th>49141</th>\n","      <th>49142</th>\n","      <th>49143</th>\n","      <th>49144</th>\n","      <th>49145</th>\n","      <th>49146</th>\n","      <th>49147</th>\n","      <th>49148</th>\n","      <th>49149</th>\n","      <th>49150</th>\n","      <th>49151</th>\n","      <th>49152</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>20</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.024120</td>\n","    </tr>\n","    <tr>\n","      <th>21</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.033482</td>\n","    </tr>\n","    <tr>\n","      <th>22</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.045772</td>\n","    </tr>\n","    <tr>\n","      <th>23</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.057711</td>\n","    </tr>\n","    <tr>\n","      <th>24</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>...</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.068771</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 49153 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dbf8cb2f-b770-4a71-820f-2d6bd6564ba4')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dbf8cb2f-b770-4a71-820f-2d6bd6564ba4 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dbf8cb2f-b770-4a71-820f-2d6bd6564ba4');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":136}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7za6leaR8hWh"},"outputs":[],"source":["# # 적당한 neighbor 갯수를 찾기 위해 KMeans 클러스터링 수행\n","# sil = []\n","# kmax = 20\n","\n","# # dissimilarity would not be defined for a single cluster, thus, minimum number of clusters should be 2\n","# for k in range(2, kmax+1):\n","#     model_kmeans = KMeans(n_clusters=k, random_state=42)\n","#     model_kmeans.fit(cd.DataFrame.from_pandas(knn_candidates))\n","#     sil.append(silhouette_score(cd.DataFrame.from_pandas(knn_candidates), model_kmeans.labels_, metric='euclidean'))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"o1hiT3Ra82CC"},"outputs":[],"source":["# print(series(sil, index=range(2, kmax+1)).sort_index(ascending=True))"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":27123,"status":"ok","timestamp":1652361975172,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"JIgfycJl824Q","colab":{"base_uri":"https://localhost:8080/"},"outputId":"ad1df587-6b59-4d25-e214-af3e5e017717"},"outputs":[{"output_type":"stream","name":"stdout","text":["1    565\n","3    199\n","2    166\n","0    136\n","6    131\n","5     44\n","4     24\n","dtype: int32\n"]}],"source":["# get best cluster model\n","# size=64*64*3, k=11\n","# size=128*128*3, k=7, 0.255565\n","model_kmeans = KMeans(n_clusters=7, random_state=42).fit(cd.DataFrame.from_pandas(knn_candidates)).labels_.value_counts()\n","print(model_kmeans)"]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":30137,"status":"ok","timestamp":1652362005304,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"IArLVZOeSkGY","colab":{"base_uri":"https://localhost:8080/"},"outputId":"c12c8c6d-ab09-40c7-d35d-e09c1e15b1a7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["NearestNeighbors()"]},"metadata":{},"execution_count":140}],"source":["knn_finder = NearestNeighbors(n_neighbors=model_kmeans.min())\n","knn_finder.fit(cd.DataFrame.from_pandas(knn_candidates))"]},{"cell_type":"code","source":["knn_candidates.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"nPWBQhGfide1","executionInfo":{"status":"ok","timestamp":1652362005304,"user_tz":-540,"elapsed":13,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"880e7aa1-ad67-4e94-9644-203cfd9ade35"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1265, 49153)"]},"metadata":{},"execution_count":141}]},{"cell_type":"code","source":["queries_mask = np.invert(notAll_na_list) | np.invert(notAny_na_list)"],"metadata":{"id":"ojD4pHdxugvF"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# create query dataset\n","knn_queries = full_y[[\"target\"]][queries_mask].copy()"],"metadata":{"id":"Rm_k2009eK3P"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["knn_queries = dataframe(knn_scaler.transform(knn_queries), index=knn_queries.index)"],"metadata":{"id":"0kTKV0BdeUbf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["img_size = 128\n","channels = 3\n","knn_img = np.empty((queries_mask.sum(), img_size * img_size * channels))\n","for idx, value in enumerate(full_x_img[queries_mask].apply(lambda x: get_image_path(x, train=True))):\n","    image = tf.io.read_file(value)\n","    image = tf.io.decode_image(image, channels=channels, expand_animations=False)\n","    image = tf.cast(image, tf.float32)\n","    image = tf.image.resize_with_pad(image, img_size, img_size, antialias=True).numpy().flatten() / 255.0\n","    knn_img[idx] = image"],"metadata":{"id":"MXYfo8v8eKz8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["knn_queries = pd.concat([dataframe(knn_img, index=knn_queries.index), knn_queries], axis=1).astype(\"float32\")\n","knn_queries.columns = list(range(knn_queries.shape[1]))\n","del knn_img"],"metadata":{"id":"mXgyerYSe2KH"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["queries_result_table = knn_finder.kneighbors(cd.DataFrame.from_pandas(knn_queries), return_distance=False).to_numpy()"],"metadata":{"id":"vEKNesrDvAWj"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# train data imputation\n","seed_everything()\n","for i in range(queries_result_table.shape[0]):\n","    target_arr = train_timeseries[knn_queries.index[i]]\n","    target_na_mask = np.isnan(target_arr)\n","    knn_arr = train_timeseries[knn_candidates.index[queries_result_table[i]]]\n","\n","    mean_arr = train_timeseries[knn_candidates.index[queries_result_table[i]]].mean(axis=0)\n","    max_arr = train_timeseries[knn_candidates.index[queries_result_table[i]]].max(axis=0)\n","    min_arr = train_timeseries[knn_candidates.index[queries_result_table[i]]].min(axis=0)\n","    noise_arr = tf.random.truncated_normal(shape=mean_arr.shape).numpy()\n","    imputed_arr = np.clip(mean_arr + noise_arr, min_arr, max_arr)\n","\n","    target_arr[target_na_mask] = 0\n","    imputed_arr[np.invert(target_na_mask)] = 0\n","    train_timeseries[knn_queries.index[i]] = target_arr + imputed_arr"],"metadata":{"id":"OMAWy1Vbus2k"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"executionInfo":{"elapsed":10,"status":"ok","timestamp":1652362088888,"user":{"displayName":"김영준","userId":"06606532799291918175"},"user_tz":-540},"id":"Z07Vuxbrx1ip","colab":{"base_uri":"https://localhost:8080/"},"outputId":"0458634d-67e3-454c-9ee2-28fbd2a1ea38"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":149}],"source":["np.isnan(train_timeseries).sum()"]},{"cell_type":"code","source":["# 모든 데이터가 nan인 index 산출\n","notAll_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(train_timeseries.shape[0], dtype=\"bool\")\n","for i in range(train_timeseries.shape[0]):\n","    if np.isnan(train_timeseries[i]).sum() == train_timeseries.shape[1] * train_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(train_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"],"metadata":{"id":"VVGIgrUqpnws"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4EzaTlqbpqWn","executionInfo":{"status":"ok","timestamp":1652362088888,"user_tz":-540,"elapsed":8,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"24999507-c404-4df8-de79-f41b67942843"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","0\n","하나 이상의 데이터가 nan 인 샘플\n","0\n"]}]},{"cell_type":"code","source":["# test data imputation using MissForest\n","missforest_imputor = MissForest(max_iter=10, n_estimators=1000, max_depth=6, max_features=0.75,\n","                                min_samples_split=0.01, min_samples_leaf=3, random_state=42)\n","missforest_imputor.fit(np.concatenate([i for i in train_timeseries], axis=0))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"L9DYTzz0OtNF","executionInfo":{"status":"ok","timestamp":1652362088889,"user_tz":-540,"elapsed":7,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"cac22d61-41ff-4ff9-8557-d7c11427ea01"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["MissForest(max_depth=6, max_features=0.75, min_samples_leaf=3,\n","           min_samples_split=0.01, n_estimators=1000, random_state=42)"]},"metadata":{},"execution_count":152}]},{"cell_type":"code","source":["notAll_na_list = np.ones(test_timeseries.shape[0], dtype=\"bool\")\n","notAny_na_list = np.ones(test_timeseries.shape[0], dtype=\"bool\")\n","for i in range(test_timeseries.shape[0]):\n","    if np.isnan(test_timeseries[i]).sum() == test_timeseries.shape[1] * test_timeseries.shape[2]:\n","        notAll_na_list[i] = False\n","    elif np.isnan(test_timeseries[i]).sum() > 0:\n","        notAny_na_list[i] = False"],"metadata":{"id":"eRFLa9DVQpLk"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(\"모든 데이터가 nan 인 샘플\")\n","print(np.invert(notAll_na_list).sum())\n","print(\"하나 이상의 데이터가 nan 인 샘플\")\n","print(np.invert(notAny_na_list).sum())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"d1RDv8NiQpwl","executionInfo":{"status":"ok","timestamp":1652362088889,"user_tz":-540,"elapsed":5,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"3aef1bab-8f06-4618-b8aa-3ae8e4f90ee5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["모든 데이터가 nan 인 샘플\n","0\n","하나 이상의 데이터가 nan 인 샘플\n","2\n"]}]},{"cell_type":"code","source":["for i in series(range(test_timeseries.shape[0]))[np.invert(notAll_na_list) | np.invert(notAny_na_list)]:\n","    test_timeseries[i] = missforest_imputor.transform(test_timeseries[i])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2NUlyAbnQYK-","executionInfo":{"status":"ok","timestamp":1652362384039,"user_tz":-540,"elapsed":295153,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"925231c5-de52-4ad6-d0fc-38d6c431257e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Iteration: 0\n","Iteration: 1\n","Iteration: 2\n","Iteration: 3\n","Iteration: 4\n","Iteration: 5\n","Iteration: 6\n","Iteration: 0\n","Iteration: 1\n","Iteration: 2\n","Iteration: 3\n","Iteration: 4\n","Iteration: 5\n","Iteration: 6\n"]}]},{"cell_type":"code","source":["np.isnan(test_timeseries).sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e-0eRNCvWOkW","executionInfo":{"status":"ok","timestamp":1652362384039,"user_tz":-540,"elapsed":12,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"7c4022ff-9431-4608-e542-bd812d825d93"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":156}]},{"cell_type":"markdown","metadata":{"id":"-NWxiyMbHBBO"},"source":["**imputing 전 시각화**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Po_Tfr0iHApa"},"outputs":[],"source":["# for i in imputed_df.select_dtypes([\"float32\", \"float64\"]):\n","#     if i in (\"id\", \"target\"):\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(imputed_df[i], imputed_df[\"target\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" - target 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15) \n","#     # graph.set_xticks(graph.get_xticks()[::1])\n","#     plt.xticks(np.arange(np.min(imputed_df[i]), np.max(imputed_df[i])+1, (np.max(imputed_df[i])+1-np.min(imputed_df[i]))/10),\n","#                fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")\n","#     # graph.set_xticklabels(graph.get_xticklabels()[::1], rotation=45)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"V23_Zh3wp2rg"},"outputs":[],"source":["# # 기존 특정 시간대만 뽑은 full_x[\"train_data\"] (imputed_df)도 만약 nan값이 하나라도 있으면 이를 timeseries 데이터에서 대치\n","# for i in list(imputed_df[\"id\"][imputed_df.drop([\"id\", \"target\"], axis=1).isna().any(axis=1)].index):\n","#     replace_vec = []\n","#     for idx, (var_name, var_idx) in enumerate(selected_features):  \n","#         replace_vec.append(train_timeseries[i][var_idx, idx])\n","#         # if train_timeseries[i][var_idx, idx] > 1200:\n","#         #     print(i, idx, var_name, var_idx)\n","#     imputed_df.loc[i, num_vars] = replace_vec"]},{"cell_type":"markdown","metadata":{"id":"RcIO1wgfHofP"},"source":["**imputing 후 시각화**"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"W-Moar3Ns6hP"},"outputs":[],"source":["# imputed_df.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"HVQuSMtp2r5_"},"outputs":[],"source":["# for i in imputed_df.select_dtypes([\"float32\", \"float64\"]):\n","#     if i == \"target\":\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.histplot(imputed_df[i])\n","#     graph.set_title(i + \" 분포 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     plt.xticks(np.arange(np.min(imputed_df[i]), np.max(imputed_df[i])+1, (np.max(imputed_df[i])+1-np.min(imputed_df[i]))/10),\n","#                fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")\n","#     # plt.savefig(folder_path + \"EDA/graphs/trainFeature_after_remove_anomaly_\" + i)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gudxCiE5s6e3"},"outputs":[],"source":["# for i in imputed_df.select_dtypes([\"float32\", \"float64\"]):\n","#     if i in (\"id\", \"target\"):\n","#         continue\n","#     plt.figure(figsize=(16, 9))\n","#     graph = sns.regplot(imputed_df[i], imputed_df[\"target\"], color=\"green\",\n","#                 scatter_kws={'s':15}, line_kws={\"color\": \"orange\"})\n","#     graph.set_title(i + \" - target 시각화\", fontsize=15, fontweight=\"bold\", pad=15)\n","#     graph.set_xlabel(graph.get_xlabel(), fontsize=12, fontweight=\"bold\", labelpad=15)\n","#     graph.set_ylabel(graph.get_ylabel(), fontsize=12, fontweight=\"bold\", labelpad=15) \n","#     # graph.set_xticks(graph.get_xticks()[::1])\n","#     plt.xticks(np.arange(np.min(imputed_df[i]), np.max(imputed_df[i])+1, (np.max(imputed_df[i])+1-np.min(imputed_df[i]))/10),\n","#                fontsize=12, fontweight=\"bold\")\n","#     plt.yticks(fontsize=12, fontweight=\"bold\")\n","#     # graph.set_xticklabels(graph.get_xticklabels()[::1], rotation=45)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TdueUroDp2mR"},"outputs":[],"source":["# missforest_imputor = MissForest(max_iter=10, n_estimators=1000, max_depth=6, max_features=0.8,\n","#                                 min_samples_split=0.05, min_samples_leaf=5, random_state=42)\n","# missforest_imputor.fit(imputed_df.drop([\"id\", target_var], axis=1))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ai2nJn20lbNI"},"outputs":[],"source":["# np.isnan(test_timeseries).sum()"]},{"cell_type":"code","source":["del model_kmeans, knn_finder, knn_candidates, knn_queries, missforest_imputor"],"metadata":{"id":"9RDIrW0Tmhm-"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ZGkufV4tegkg"},"source":["# Replace original df"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gBCmq1d-MN6o"},"outputs":[],"source":["# full_x[\"train_data\"] = imputed_df\n","# full_x[\"train_data\"].head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"K98dHptwbEOH"},"outputs":[],"source":["# full_x[\"train_data\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"INGYMU8ydQw-"},"outputs":[],"source":["# test_x[\"test_data\"][test_x[\"test_data\"].isna().any(axis=1)]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wPz_6ePtmRlL"},"outputs":[],"source":["# for i in list(test_x[\"test_data\"][\"id\"][test_x[\"test_data\"].drop([\"id\"], axis=1).isna().any(axis=1)].index):\n","#     replace_vec = []\n","#     for idx, (var_name, var_idx) in enumerate(selected_features):\n","#         replace_vec.append(test_timeseries[i][var_idx, idx])\n","#     test_x[\"test_data\"].loc[i, num_vars] = replace_vec"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ur-EIVsbfJdk"},"outputs":[],"source":["# test_x[\"test_data\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qtBVleXpaYzv"},"outputs":[],"source":["# test_x[\"test_data\"] = pd.concat([test_x[\"test_data\"][[\"id\"]], dataframe(missforest_imputor.transform(test_x[\"test_data\"].drop([\"id\"], axis=1)), columns=test_x[\"test_data\"].drop([\"id\"], axis=1).columns)], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6q5YCtEzhVcW"},"outputs":[],"source":["# train_timeseries = train_timeseries[full_x[\"train_data\"][\"id\"] != \"CASE45_17.png\"]\n","# full_x[\"train_data\"] = full_x[\"train_data\"][full_x[\"train_data\"][\"id\"] != \"CASE45_17.png\"]\n","# full_x[\"train_data\"].reset_index(drop=True, inplace=True)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ouvd_6nPuu3C"},"outputs":[],"source":["# full_x[\"train_data\"].info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8OeaBXo2Yyz4"},"outputs":[],"source":["# test_x[\"test_data\"].info()"]},{"cell_type":"markdown","metadata":{"id":"M926gqsUf_D9"},"source":["# Feature Diescretization\n"]},{"cell_type":"markdown","metadata":{"id":"lrf6V3GqgaK-"},"source":["**try1**\n","*   내부온도관측치 -> 20\n","*   내부습도관측치 -> 20\n","*   CO2관측치 -> 20\n","*   EC관측치 -> 10\n","*   최근분무량 -> 10\n","*   화이트 LED동작강도 - 5\n","*   레드 LED동작강도 - 7\n","*   블루 LED동작강도 - 7\n","*   냉방온도 - 9\n","*   냉방부하 - 20\n","*   난방온도 - 8\n","*   난방부하 -> 5\n","\n","**try2**\n","\n","*   20 -> 10\n","\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"FDFbW7sCWLQ5"},"outputs":[],"source":["# full_y = full_x[\"train_data\"][[target_var]]\n","# full_y[target_var].hist()\n","# # target transformation\n","# full_y[target_var] = np.log1p(full_y[target_var])\n","# full_x = full_x[\"train_data\"].drop(target_var, axis=1)\n","# test_x = test_x[\"test_data\"]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yzNMyCwC7vOf"},"outputs":[],"source":["# full_y[target_var].hist()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"057q81fMWVWT"},"outputs":[],"source":["# embed_size = 64\n","# ct = ColumnTransformer([\n","#     (\"내부온도관측치_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","#     (\"내부습도관측치_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","#     (\"CO2관측치_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","#     (\"EC관측치_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","#     (\"최근분무량_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","#     (\"화이트 LED동작강도_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","#     (\"레드 LED동작강도_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","#     (\"블루 LED동작강도_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","#     (\"냉방온도_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","#     (\"냉방부하_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","#     (\"난방온도_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","#     (\"난방부하_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","#     (\"총추정광량_discret\", KBinsDiscretizer(embed_size, encode=\"ordinal\", strategy=\"kmeans\"), [\"총추정광량\"])\n","# ])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9NYVhjW8obzB"},"outputs":[],"source":["# ct.fit(pd.concat([dataframe(i, columns=num_vars) for i in train_timeseries], axis=0).dropna())"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"xKhvauYWaEAu"},"outputs":[],"source":["# full_x = pd.concat([full_x[[\"id\"]], full_x.drop(\"id\", axis=1), dataframe(ct.transform(full_x).astype(\"int32\"), columns=[i[0] for i in ct.transformers_])], axis=1)\n","# test_x = pd.concat([test_x[[\"id\"]], test_x.drop(\"id\", axis=1), dataframe(ct.transform(test_x).astype(\"int32\"), columns=[i[0] for i in ct.transformers_])], axis=1)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Ygaa_cAdkH3A"},"outputs":[],"source":["# full_x[\"냉방부하_binary\"] = full_x[\"냉방부하\"].apply(lambda x: 0.0 if x==0.0 else 1.0)\n","# full_x[\"난방부하_binary\"] = full_x[\"난방부하\"].apply(lambda x: 0.0 if x==0.0 else 1.0)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"waH2GnTlo6wI"},"outputs":[],"source":["# test_x[\"냉방부하_binary\"] = test_x[\"냉방부하\"].apply(lambda x: 0.0 if x==0.0 else 1.0)\n","# test_x[\"난방부하_binary\"] = test_x[\"난방부하\"].apply(lambda x: 0.0 if x==0.0 else 1.0)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EGp6fP0tWikz"},"outputs":[],"source":["# full_x.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Pf4Orp-KWgEU"},"outputs":[],"source":["# test_x.info()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"VZzOFcwlIIeV"},"outputs":[],"source":["train_timeseries = np.concatenate([np.concatenate([i, ct.transform(dataframe(i, columns=num_vars))], axis=1)[np.newaxis, ...] for i in train_timeseries], axis=0)\n","test_timeseries = np.concatenate([np.concatenate([i, ct.transform(dataframe(i, columns=num_vars))], axis=1)[np.newaxis, ...] for i in test_timeseries], axis=0)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LwW0sPy-lrV-"},"outputs":[],"source":["tmp_list = []\n","for idx, value in enumerate(train_timeseries):\n","    tmp_list.append(np.concatenate([\n","        value,\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"EC관측치\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"최근분무량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"화이트 LED동작강도\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"레드 LED동작강도\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"블루 LED동작강도\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"냉방부하\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"난방부하\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"총추정광량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"백색광추정광량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"적색광추정광량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"청색광추정광량\")]])[..., np.newaxis],\n","    ], axis=1)[np.newaxis, ...])\n","train_timeseries = np.concatenate(tmp_list, axis=0)\n","tmp_list = []\n","for idx, value in enumerate(test_timeseries):\n","    tmp_list.append(np.concatenate([\n","        value,\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"EC관측치\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"최근분무량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"화이트 LED동작강도\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"레드 LED동작강도\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"블루 LED동작강도\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"냉방부하\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"난방부하\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"총추정광량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"백색광추정광량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"적색광추정광량\")]])[..., np.newaxis],\n","        array([1.0 if j==0.0 else 0.0 for j in value[:,num_vars.index(\"청색광추정광량\")]])[..., np.newaxis],\n","    ], axis=1)[np.newaxis, ...])\n","test_timeseries = np.concatenate(tmp_list, axis=0)\n","del tmp_list"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4UEfGNJknoXf"},"outputs":[],"source":["bin_vars = [\"EC관측치_binary\", \"최근분무량_binary\", \"화이트 LED동작강도_binary\", \"레드 LED동작강도_binary\", \"블루 LED동작강도_binary\",\n","            \"냉방부하_binary\", \"난방부하_binary\", \"총추정광량_binary\", \"백색광추정광량_binary\", \"적색광추정광량_binary\", \"청색광추정광량_binary\"]"]},{"cell_type":"code","source":["# label log transformation\n","full_y[\"target\"] = np.log1p(full_y[\"target\"])"],"metadata":{"id":"Mgdo0BPcpDzC"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_timeseries.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e_yTIt83BhLY","executionInfo":{"status":"ok","timestamp":1652362447172,"user_tz":-540,"elapsed":21,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"519be5ec-0c52-484c-e0f6-9cac5d009243"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1583, 96, 47)"]},"metadata":{},"execution_count":187}]},{"cell_type":"code","source":["np.isnan(train_timeseries).sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZLMIy4Abm0gV","executionInfo":{"status":"ok","timestamp":1652362447172,"user_tz":-540,"elapsed":16,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"64251db5-a24f-44cc-cc0f-98230e644489"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":188}]},{"cell_type":"code","source":["full_x_img.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9I8dJDuKBiPm","executionInfo":{"status":"ok","timestamp":1652362447172,"user_tz":-540,"elapsed":14,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"799485b3-4faf-43c6-b1b0-e0e00b4c10c8"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1583,)"]},"metadata":{},"execution_count":189}]},{"cell_type":"code","source":["full_x_img.isna().sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4LrmsA_nm2Tj","executionInfo":{"status":"ok","timestamp":1652362447172,"user_tz":-540,"elapsed":12,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"fb133729-0aa4-4bee-fb00-43079abe0f96"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":190}]},{"cell_type":"code","source":["full_y.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"p2jtxL1oBkYT","executionInfo":{"status":"ok","timestamp":1652362447172,"user_tz":-540,"elapsed":11,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"ce04aa02-1fdf-443f-c409-9e9ab6d1de21"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1583, 1)"]},"metadata":{},"execution_count":191}]},{"cell_type":"code","source":["full_y.isna().sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xne-5CK1m4qb","executionInfo":{"status":"ok","timestamp":1652362447172,"user_tz":-540,"elapsed":10,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"fe03f2bf-615a-4e41-fc9a-0591168475e6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["target    0\n","dtype: int64"]},"metadata":{},"execution_count":192}]},{"cell_type":"code","source":["test_timeseries.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"V0urBbeCm6jy","executionInfo":{"status":"ok","timestamp":1652362447173,"user_tz":-540,"elapsed":10,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"37a596ed-5a05-40d4-e04c-ee5e48d9bb47"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(460, 96, 47)"]},"metadata":{},"execution_count":193}]},{"cell_type":"code","source":["np.isnan(test_timeseries).sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EGq5-teGm8Cc","executionInfo":{"status":"ok","timestamp":1652362447173,"user_tz":-540,"elapsed":9,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"36d4a5ca-3b0a-44e0-aa9f-a2554178a3ff"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":194}]},{"cell_type":"code","source":["test_x_img.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6MvIhcxBm79a","executionInfo":{"status":"ok","timestamp":1652362447173,"user_tz":-540,"elapsed":8,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"a47af4e4-4ff3-41af-95fb-40e5c43278a9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(460,)"]},"metadata":{},"execution_count":195}]},{"cell_type":"code","source":["test_x_img.isna().sum()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rz2uwqbDm76t","executionInfo":{"status":"ok","timestamp":1652362447173,"user_tz":-540,"elapsed":7,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"47cade96-b989-407c-dc14-b335de04d1d8"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":196}]},{"cell_type":"markdown","source":["# Quick Start Session"],"metadata":{"id":"UYnFbtk81W-A"}},{"cell_type":"markdown","source":["**Feature set 1 : selected some vars based on high correlation**"],"metadata":{"id":"Ym3GZWU7UqxS"}},{"cell_type":"code","source":["# # trian\n","# easyIO(train_timeseries, os.path.join(folder_path, \"architectures/\" + model_name, \"train_timeseries.pkl\"), op=\"w\")\n","# easyIO(full_x_img, os.path.join(folder_path, \"architectures/\" + model_name, \"full_x_img.pkl\"), op=\"w\")\n","# easyIO(full_y, os.path.join(folder_path, \"architectures/\" + model_name, \"full_y.pkl\"), op=\"w\")\n","# # test\n","# easyIO(test_timeseries, os.path.join(folder_path, \"architectures/\" + model_name, \"test_timeseries.pkl\"), op=\"w\")\n","# easyIO(test_x_img, os.path.join(folder_path, \"architectures/\" + model_name, \"test_x_img.pkl\"), op=\"w\")"],"metadata":{"id":"NonVIDw5njHO"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# ct = ColumnTransformer([\n","#     (\"내부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","#     (\"내부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","#     (\"CO2관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","#     (\"EC관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","#     (\"최근분무량_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","#     (\"화이트 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","#     (\"레드 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","#     (\"블루 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","#     (\"냉방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","#     (\"냉방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","#     (\"난방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","#     (\"난방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","# ])"],"metadata":{"id":"Ly93iZKA07Ml"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# num_vars = [\"내부온도관측치\", \"내부습도관측치\", \"CO2관측치\", \"EC관측치\", \"최근분무량\",\n","#             \"화이트 LED동작강도\", \"레드 LED동작강도\", \"블루 LED동작강도\",\n","#             \"냉방온도\", \"냉방부하\", \"난방온도\", \"난방부하\"]\n","# bin_vars = [\"냉방부하_binary\", \"난방부하_binary\"]\n","# cat_vars = [i[0] for i in ct._transformers]"],"metadata":{"id":"_IETDHbNzpqP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # trian\n","# train_timeseries = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"train_timeseries.pkl\"), op=\"r\")\n","# full_x_img = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"full_x_img.pkl\"), op=\"r\")\n","# full_y = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"full_y.pkl\"), op=\"r\")\n","# # test\n","# test_timeseries = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"test_timeseries.pkl\"), op=\"r\")\n","# test_x_img = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"test_x_img.pkl\"), op=\"r\")"],"metadata":{"id":"87E1-x_YoDbu"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**Feature set 2 : drop catogrical like feature in numeric vars**"],"metadata":{"id":"LHlryUnPUwnb"}},{"cell_type":"code","source":["# # trian\n","# easyIO(train_timeseries, os.path.join(folder_path, \"architectures/\" + model_name, \"train_timeseries.pkl\"), op=\"w\")\n","# easyIO(full_x_img, os.path.join(folder_path, \"architectures/\" + model_name, \"full_x_img.pkl\"), op=\"w\")\n","# easyIO(full_y, os.path.join(folder_path, \"architectures/\" + model_name, \"full_y.pkl\"), op=\"w\")\n","# # test\n","# easyIO(test_timeseries, os.path.join(folder_path, \"architectures/\" + model_name, \"test_timeseries.pkl\"), op=\"w\")\n","# easyIO(test_x_img, os.path.join(folder_path, \"architectures/\" + model_name, \"test_x_img.pkl\"), op=\"w\")"],"metadata":{"id":"3TFnMmPBU3ma"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# ct = ColumnTransformer([\n","#     (\"내부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","#     (\"내부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","#     (\"CO2관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","#     (\"EC관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","#     (\"최근분무량_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","#     (\"화이트 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","#     (\"레드 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","#     (\"블루 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","#     (\"냉방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","#     (\"냉방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","#     (\"난방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","#     (\"난방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","# ])"],"metadata":{"id":"Fp2Qte-2U5ZZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# num_vars = [\"내부온도관측치\", \"내부습도관측치\", \"CO2관측치\", \"EC관측치\", \"최근분무량\",\n","#             \"화이트 LED동작강도\", \"레드 LED동작강도\", \"블루 LED동작강도\",\n","#             \"냉방온도\", \"냉방부하\", \"난방온도\", \"난방부하\"]\n","# bin_vars = [\"냉방부하_binary\", \"난방부하_binary\"]\n","# cat_vars = [i[0] for i in ct._transformers]"],"metadata":{"id":"H_cDKXDLU6gL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # trian\n","# train_timeseries = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"train_timeseries.pkl\"), op=\"r\")\n","# full_x_img = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"full_x_img.pkl\"), op=\"r\")\n","# full_y = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"full_y.pkl\"), op=\"r\")\n","# # test\n","# test_timeseries = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"test_timeseries.pkl\"), op=\"r\")\n","# test_x_img = easyIO(None, os.path.join(folder_path, \"architectures/\" + model_name, \"test_x_img.pkl\"), op=\"r\")"],"metadata":{"id":"_SUVSHelU8Wb"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# cat_like_vars = [\"화이트 LED동작강도\", \"레드 LED동작강도\", \"블루 LED동작강도\", \"냉방온도\", \"난방온도\"]\n","# drop_mask = [False if i in findIdx(num_vars, cat_like_vars) else True for i in list(range(train_timeseries.shape[-1]))]\n","# num_vars = [\"내부온도관측치\", \"내부습도관측치\", \"CO2관측치\", \"EC관측치\", \"최근분무량\", \"냉방부하\", \"난방부하\"]"],"metadata":{"id":"qWvv7uMyT7op"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# train_timeseries = train_timeseries[:,:,drop_mask]\n","# test_timeseries = test_timeseries[:,:,drop_mask]"],"metadata":{"id":"t3AlkcrnVvJB"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["**Feature set 3 : all features and binary vars**"],"metadata":{"id":"gpguCeRQVABT"}},{"cell_type":"code","source":["feature_name = \"allFeatures_allBinaries\"\n","createFolder(folder_path + \"features/\" + feature_name)"],"metadata":{"id":"Vk3IaUHyVUiA"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# # trian\n","# easyIO(train_timeseries, folder_path + \"features/\" + feature_name + \"/train_timeseries\" + \"_\" + feature_name + \".pkl\", op=\"w\")\n","# easyIO(full_x_img, folder_path + \"features/\" + feature_name + \"/full_x_img\" + \"_\" + feature_name + \".pkl\", op=\"w\")\n","# easyIO(full_y, folder_path + \"features/\" + feature_name + \"/full_y\" + \"_\" + feature_name + \".pkl\", op=\"w\")\n","# # test\n","# easyIO(test_timeseries, folder_path + \"features/\" + feature_name + \"/test_timeseries\" + \"_\" + feature_name + \".pkl\", op=\"w\")\n","# easyIO(test_x_img, folder_path + \"features/\" + feature_name + \"/test_x_img\" + \"_\" + feature_name + \".pkl\", op=\"w\")"],"metadata":{"id":"znUpSDtZU_sl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["ct = ColumnTransformer([\n","    (\"내부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부온도관측치\"]),\n","    (\"외부온도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"외부온도관측치\"]),\n","    (\"내부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"내부습도관측치\"]),\n","    (\"외부습도관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"외부습도관측치\"]),\n","    (\"CO2관측치_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"CO2관측치\"]),\n","    (\"EC관측치_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"EC관측치\"]),\n","    (\"최근분무량_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"최근분무량\"]),\n","    (\"화이트 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"화이트 LED동작강도\"]),\n","    (\"레드 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"레드 LED동작강도\"]),\n","    (\"블루 LED동작강도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"블루 LED동작강도\"]),\n","    (\"냉방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방온도\"]),\n","    (\"냉방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"냉방부하\"]),\n","    (\"난방온도_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방온도\"]),\n","    (\"난방부하_discret\", KBinsDiscretizer(100, encode=\"ordinal\", strategy=\"kmeans\"), [\"난방부하\"]),\n","    (\"총추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"총추정광량\"]),\n","    (\"백색광추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"백색광추정광량\"]),\n","    (\"적색광추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"적색광추정광량\"]),\n","    (\"청색광추정광량_discret\", KBinsDiscretizer(10, encode=\"ordinal\", strategy=\"kmeans\"), [\"청색광추정광량\"]),\n","])"],"metadata":{"id":"Ze_N714rVGOa"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["num_vars = [\"내부온도관측치\", \"외부온도관측치\", \"내부습도관측치\", \"외부습도관측치\", \"CO2관측치\", \"EC관측치\", \"최근분무량\",\n","            \"화이트 LED동작강도\", \"레드 LED동작강도\", \"블루 LED동작강도\", \"냉방온도\", \"냉방부하\", \"난방온도\", \"난방부하\",\n","            \"총추정광량\", \"백색광추정광량\", \"적색광추정광량\", \"청색광추정광량\"]\n","bin_vars = [\"EC관측치_binary\", \"최근분무량_binary\", \"화이트 LED동작강도_binary\", \"레드 LED동작강도_binary\", \"블루 LED동작강도_binary\",\n","            \"냉방부하_binary\", \"난방부하_binary\", \"총추정광량_binary\", \"백색광추정광량_binary\", \"적색광추정광량_binary\", \"청색광추정광량_binary\"]\n","cat_vars = [i[0] for i in ct._transformers]"],"metadata":{"id":"joAkjjofVHSt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# trian\n","train_timeseries = easyIO(None, folder_path + \"features/\" + feature_name + \"/train_timeseries\" + \"_\" + feature_name + \".pkl\", op=\"r\")\n","full_x_img = easyIO(None, folder_path + \"features/\" + feature_name + \"/full_x_img\" + \"_\" + feature_name + \".pkl\", op=\"r\")\n","full_y = easyIO(None, folder_path + \"features/\" + feature_name + \"/full_y\" + \"_\" + feature_name + \".pkl\", op=\"r\")\n","# test\n","test_timeseries = easyIO(None, folder_path + \"features/\" + feature_name + \"/test_timeseries\" + \"_\" + feature_name + \".pkl\", op=\"r\")\n","test_x_img = easyIO(None, folder_path + \"features/\" + feature_name + \"/test_x_img\" + \"_\" + feature_name + \".pkl\", op=\"r\")"],"metadata":{"id":"wqe90nQGVIjU"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_timeseries.shape[-1] == len(num_vars) + len(bin_vars) + len(cat_vars)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6cst26VmJUc9","executionInfo":{"status":"ok","timestamp":1652569462627,"user_tz":-540,"elapsed":3,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"fad02234-b7f6-46dc-82bf-2001aa6ea059"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":34}]},{"cell_type":"markdown","metadata":{"id":"TGKabM-UoSJh"},"source":["# Swin Transformer"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9tfqPktToW2p"},"outputs":[],"source":["def window_partition(x, window_size):\n","    _, height, width, channels = x.shape\n","    patch_num_y = height // window_size\n","    patch_num_x = width // window_size\n","    x = tf.reshape(\n","        x, shape=(-1, patch_num_y, window_size, patch_num_x, window_size, channels)\n","    )\n","    x = tf.transpose(x, (0, 1, 3, 2, 4, 5))\n","    windows = tf.reshape(x, shape=(-1, window_size, window_size, channels))\n","    return windows\n","\n","def window_reverse(windows, window_size, height, width, channels):\n","    patch_num_y = height // window_size\n","    patch_num_x = width // window_size\n","    x = tf.reshape(\n","        windows,\n","        shape=(-1, patch_num_y, patch_num_x, window_size, window_size, channels),\n","    )\n","    x = tf.transpose(x, perm=(0, 1, 3, 2, 4, 5))\n","    x = tf.reshape(x, shape=(-1, height, width, channels))\n","    return x\n","\n","class DropPath(layers.Layer):\n","    def __init__(self, drop_prob=None, **kwargs):\n","        super(DropPath, self).__init__(**kwargs)\n","        self.drop_prob = drop_prob\n","    def call(self, x):\n","        input_shape = tf.shape(x)\n","        batch_size = input_shape[0]\n","        rank = x.shape.rank\n","        shape = (batch_size,) + (1,) * (rank - 1)\n","        random_tensor = (1 - self.drop_prob) + tf.random.uniform(shape, dtype=x.dtype)\n","        path_mask = tf.floor(random_tensor)\n","        output = tf.math.divide(x, 1 - self.drop_prob) * path_mask\n","        return output\n","    def get_config(self):\n","        config = super().get_config()\n","        return config"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0Xt9vQrmo70D"},"outputs":[],"source":["class WindowAttention(layers.Layer):\n","    def __init__(\n","        self, dim, window_size, num_heads, qkv_bias=True, dropout_rate=0.0, **kwargs\n","    ):\n","        super(WindowAttention, self).__init__(**kwargs)\n","        self.dim = dim\n","        self.window_size = window_size\n","        self.num_heads = num_heads\n","        self.scale = (dim // num_heads) ** -0.5\n","        self.qkv = layers.Dense(dim * 3, use_bias=qkv_bias)\n","        self.dropout = layers.Dropout(dropout_rate)\n","        self.proj = layers.Dense(dim)\n","    def build(self, input_shape):\n","        num_window_elements = (2 * self.window_size[0] - 1) * (\n","            2 * self.window_size[1] - 1\n","        )\n","        self.relative_position_bias_table = self.add_weight(\n","            shape=(num_window_elements, self.num_heads),\n","            initializer=tf.initializers.Zeros(),\n","            trainable=True,\n","            name=\"name\"\n","        )\n","        coords_h = np.arange(self.window_size[0])\n","        coords_w = np.arange(self.window_size[1])\n","        coords_matrix = np.meshgrid(coords_h, coords_w, indexing=\"ij\")\n","        coords = np.stack(coords_matrix)\n","        coords_flatten = coords.reshape(2, -1)\n","        relative_coords = coords_flatten[:, :, None] - coords_flatten[:, None, :]\n","        relative_coords = relative_coords.transpose([1, 2, 0])\n","        relative_coords[:, :, 0] += self.window_size[0] - 1\n","        relative_coords[:, :, 1] += self.window_size[1] - 1\n","        relative_coords[:, :, 0] *= 2 * self.window_size[1] - 1\n","        relative_position_index = relative_coords.sum(-1)\n","\n","        self.relative_position_index = tf.Variable(\n","            initial_value=tf.convert_to_tensor(relative_position_index), trainable=False\n","        )\n","    def call(self, x, mask=None):\n","        _, size, channels = x.shape\n","        head_dim = channels // self.num_heads\n","        x_qkv = self.qkv(x)\n","        x_qkv = tf.reshape(x_qkv, shape=(-1, size, 3, self.num_heads, head_dim))\n","        x_qkv = tf.transpose(x_qkv, perm=(2, 0, 3, 1, 4))\n","        q, k, v = x_qkv[0], x_qkv[1], x_qkv[2]\n","        q = q * self.scale\n","        k = tf.transpose(k, perm=(0, 1, 3, 2))\n","        attn = q @ k\n","\n","        num_window_elements = self.window_size[0] * self.window_size[1]\n","        relative_position_index_flat = tf.reshape(\n","            self.relative_position_index, shape=(-1,)\n","        )\n","        relative_position_bias = tf.gather(\n","            self.relative_position_bias_table, relative_position_index_flat\n","        )\n","        relative_position_bias = tf.reshape(\n","            relative_position_bias, shape=(num_window_elements, num_window_elements, -1)\n","        )\n","        relative_position_bias = tf.transpose(relative_position_bias, perm=(2, 0, 1))\n","        attn = attn + tf.expand_dims(relative_position_bias, axis=0)\n","\n","        if mask is not None:\n","            nW = mask.get_shape()[0]\n","            mask_float = tf.cast(\n","                tf.expand_dims(tf.expand_dims(mask, axis=1), axis=0), tf.float32\n","            )\n","            attn = (\n","                tf.reshape(attn, shape=(-1, nW, self.num_heads, size, size))\n","                + mask_float\n","            )\n","            attn = tf.reshape(attn, shape=(-1, self.num_heads, size, size))\n","            attn = tf.keras.activations.softmax(attn, axis=-1)\n","        else:\n","            attn = tf.keras.activations.softmax(attn, axis=-1)\n","        attn = self.dropout(attn)\n","\n","        x_qkv = attn @ v\n","        x_qkv = tf.transpose(x_qkv, perm=(0, 2, 1, 3))\n","        x_qkv = tf.reshape(x_qkv, shape=(-1, size, channels))\n","        x_qkv = self.proj(x_qkv)\n","        x_qkv = self.dropout(x_qkv)\n","        return x_qkv\n","    def get_config(self):\n","        config = super().get_config()\n","        return config"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"X7BgJzmUoa92"},"outputs":[],"source":["class SwinTransformer(layers.Layer):\n","    def __init__(\n","        self,\n","        dim,\n","        num_patch,\n","        num_heads,\n","        window_size=7,\n","        shift_size=0,\n","        num_mlp=1024,\n","        qkv_bias=True,\n","        dropout_rate=0.0,\n","        **kwargs,\n","    ):\n","        super(SwinTransformer, self).__init__(**kwargs)\n","\n","        self.dim = dim  # number of input dimensions\n","        self.num_patch = num_patch  # number of embedded patches\n","        self.num_heads = num_heads  # number of attention heads\n","        self.window_size = window_size  # size of window\n","        self.shift_size = shift_size  # size of window shift\n","        self.num_mlp = num_mlp  # number of MLP nodes\n","\n","        self.norm1 = layers.LayerNormalization(epsilon=1e-5)\n","        self.attn = WindowAttention(\n","            dim,\n","            window_size=(self.window_size, self.window_size),\n","            num_heads=num_heads,\n","            qkv_bias=qkv_bias,\n","            dropout_rate=dropout_rate,\n","        )\n","        self.drop_path = DropPath(dropout_rate)\n","        self.norm2 = layers.LayerNormalization(epsilon=1e-5)\n","\n","        self.mlp = Sequential(\n","            [\n","                layers.Dense(num_mlp),\n","                layers.Activation(tf.keras.activations.gelu),\n","                layers.Dropout(dropout_rate),\n","                layers.Dense(dim),\n","                layers.Dropout(dropout_rate),\n","            ]\n","        )\n","\n","        if min(self.num_patch) < self.window_size:\n","            self.shift_size = 0\n","            self.window_size = min(self.num_patch)\n","    def build(self, input_shape):\n","        if self.shift_size == 0:\n","            self.attn_mask = None\n","        else:\n","            height, width = self.num_patch\n","            h_slices = (\n","                slice(0, -self.window_size),\n","                slice(-self.window_size, -self.shift_size),\n","                slice(-self.shift_size, None),\n","            )\n","            w_slices = (\n","                slice(0, -self.window_size),\n","                slice(-self.window_size, -self.shift_size),\n","                slice(-self.shift_size, None),\n","            )\n","            mask_array = np.zeros((1, height, width, 1))\n","            count = 0\n","            for h in h_slices:\n","                for w in w_slices:\n","                    mask_array[:, h, w, :] = count\n","                    count += 1\n","            mask_array = tf.convert_to_tensor(mask_array)\n","\n","            # mask array to windows\n","            mask_windows = window_partition(mask_array, self.window_size)\n","            mask_windows = tf.reshape(\n","                mask_windows, shape=[-1, self.window_size * self.window_size]\n","            )\n","            attn_mask = tf.expand_dims(mask_windows, axis=1) - tf.expand_dims(\n","                mask_windows, axis=2\n","            )\n","            attn_mask = tf.where(attn_mask != 0, -100.0, attn_mask)\n","            attn_mask = tf.where(attn_mask == 0, 0.0, attn_mask)\n","            self.attn_mask = tf.Variable(initial_value=attn_mask, trainable=False)\n","    def call(self, x):\n","        height, width = self.num_patch\n","        _, num_patches_before, channels = x.shape\n","        x_skip = x\n","        x = self.norm1(x)\n","        x = tf.reshape(x, shape=(-1, height, width, channels))\n","        if self.shift_size > 0:\n","            shifted_x = tf.roll(\n","                x, shift=[-self.shift_size, -self.shift_size], axis=[1, 2]\n","            )\n","        else:\n","            shifted_x = x\n","\n","        x_windows = window_partition(shifted_x, self.window_size)\n","        x_windows = tf.reshape(\n","            x_windows, shape=(-1, self.window_size * self.window_size, channels)\n","        )\n","        attn_windows = self.attn(x_windows, mask=self.attn_mask)\n","\n","        attn_windows = tf.reshape(\n","            attn_windows, shape=(-1, self.window_size, self.window_size, channels)\n","        )\n","        shifted_x = window_reverse(\n","            attn_windows, self.window_size, height, width, channels\n","        )\n","        if self.shift_size > 0:\n","            x = tf.roll(\n","                shifted_x, shift=[self.shift_size, self.shift_size], axis=[1, 2]\n","            )\n","        else:\n","            x = shifted_x\n","\n","        x = tf.reshape(x, shape=(-1, height * width, channels))\n","        x = self.drop_path(x)\n","        x = x_skip + x\n","        x_skip = x\n","        x = self.norm2(x)\n","        x = self.mlp(x)\n","        x = self.drop_path(x)\n","        x = x_skip + x\n","        return x\n","    def get_config(self):\n","        config = super().get_config()\n","        return config"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"wwUTvVkVpODN"},"outputs":[],"source":["class PatchExtract(layers.Layer):\n","    def __init__(self, patch_size, **kwargs):\n","        super(PatchExtract, self).__init__(**kwargs)\n","        self.patch_size_x = patch_size[0]\n","        self.patch_size_y = patch_size[1]\n","    def call(self, images):\n","        batch_size = tf.shape(images)[0]\n","        patches = tf.image.extract_patches(\n","            images=images,\n","            sizes=(1, self.patch_size_x, self.patch_size_y, 1),\n","            strides=(1, self.patch_size_x, self.patch_size_y, 1),\n","            rates=(1, 1, 1, 1),\n","            padding=\"VALID\",\n","        )\n","        patch_dim = patches.shape[-1]\n","        patch_num = patches.shape[1]\n","        return tf.reshape(patches, (batch_size, patch_num * patch_num, patch_dim))\n","    def get_config(self):\n","        config = super().get_config()\n","        return config\n","\n","class PatchEmbedding(layers.Layer):\n","    def __init__(self, num_patch, embed_dim, **kwargs):\n","        super(PatchEmbedding, self).__init__(**kwargs)\n","        self.num_patch = num_patch\n","        self.proj = layers.Dense(embed_dim)\n","        self.pos_embed = layers.Embedding(input_dim=num_patch, output_dim=embed_dim)\n","    def call(self, patch):\n","        pos = tf.range(start=0, limit=self.num_patch, delta=1)\n","        return self.proj(patch) + self.pos_embed(pos)\n","    def get_config(self):\n","        config = super().get_config()\n","        return config\n","\n","class PatchMerging(tf.keras.layers.Layer):\n","    def __init__(self, num_patch, embed_dim):\n","        super(PatchMerging, self).__init__()\n","        self.num_patch = num_patch\n","        self.embed_dim = embed_dim\n","        self.linear_trans = layers.Dense(2 * embed_dim, use_bias=False)\n","    def call(self, x):\n","        height, width = self.num_patch\n","        _, _, C = x.get_shape().as_list()\n","        x = tf.reshape(x, shape=(-1, height, width, C))\n","        x0 = x[:, 0::2, 0::2, :]\n","        x1 = x[:, 1::2, 0::2, :]\n","        x2 = x[:, 0::2, 1::2, :]\n","        x3 = x[:, 1::2, 1::2, :]\n","        x = tf.concat((x0, x1, x2, x3), axis=-1)\n","        x = tf.reshape(x, shape=(-1, (height // 2) * (width // 2), 4 * C))\n","        return self.linear_trans(x)\n","    def get_config(self):\n","        config = super().get_config()\n","        return config"]},{"cell_type":"markdown","metadata":{"id":"Esnj5xBcY1DE"},"source":["# NN Model - Swin LSTM (SOTA)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Mkib3o0aY1pn"},"outputs":[],"source":["# img_size = 128\n","# channels = 3\n","\n","# patch_size = (4, 4)  # 2-by-2 sized patches\n","# dropout_rate = 1/2 ** 4  # Dropout rate\n","# num_heads = 16 # Attention heads\n","# embed_dim = 128  # Embedding dimension\n","# num_mlp = 512  # MLP layer size\n","# qkv_bias = True  # Convert embedded patches to query, key, and values with a learnable additive value\n","# window_size = 4  # Size of attention window\n","# shift_size = 2 # Size of shifting window\n","# image_dimension = img_size  # Initial image size\n","\n","# num_patch_x = img_size // patch_size[0]\n","# num_patch_y = img_size // patch_size[1]\n","\n","# dropoutRate = 0.5\n","\n","# def create_model():\n","#     input_list = []\n","#     concat_list = []\n","\n","#     input_list.append(layers.Input(shape=(img_size, img_size, channels), dtype=tf.float32))\n","\n","#     # augmenation layer\n","#     x = RandomColorDistortion(hue_flag=False)(input_list[-1])\n","#     x = RandomAngleDistortion(zoom_factor=0.0, rotation_factor=0.0)(x)\n","#     x = tf.keras.layers.Rescaling(scale=1./255)(x)\n","    \n","#     # PatchExtract : patch size 만큼 잘라 각 channel의 patch 조각들은 column으로 flatten 하고 이미지의 row 및 column은 row로 flatten\n","#     # 이미지가 8 * 8 * 3 이고 patch size가 2 * 2 이면 16 * 12 가 나옴 (16 = 8/2 * 8/2, 12 = 2 * 2 * 3)\n","#     x = PatchExtract(patch_size)(x)\n","#     # PatchEmbedding : 추출된 패치에 대해서 포지션 값을 부여하고 embedding layer에 넣음 (row에 대해 0~n 까지 정수값 부여)\n","#     # embedding layer를 통해 산출된 값과 dense layer를 통해 산출된 값을 더함 (두 layer는 같은 차원)\n","#     x = PatchEmbedding(num_patch_x * num_patch_y, embed_dim)(x)\n","\n","#     # Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim,\n","#         num_patch=(num_patch_x, num_patch_y),\n","#         num_heads=num_heads,\n","#         window_size=window_size,\n","#         shift_size=0,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     # Shifted Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim,\n","#         num_patch=(num_patch_x, num_patch_y),\n","#         num_heads=num_heads,\n","#         window_size=window_size,\n","#         shift_size=shift_size,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     x = PatchMerging((num_patch_x, num_patch_y), embed_dim=embed_dim * 2)(x)\n","\n","#     # Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim * 4,\n","#         num_patch=(num_patch_x//2, num_patch_y//2),\n","#         num_heads=num_heads,\n","#         window_size=window_size//2,\n","#         shift_size=0,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     # Shifted Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim * 4,\n","#         num_patch=(num_patch_x//2, num_patch_y//2),\n","#         num_heads=num_heads,\n","#         window_size=window_size//2,\n","#         shift_size=shift_size//2,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     x = PatchMerging((num_patch_x//2, num_patch_y//2), embed_dim=embed_dim * 4)(x)\n","#     x = layers.GlobalAveragePooling1D()(x)\n","\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(256, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     concat_list.append(layers.Dense(64, activation=\"relu\")(x))\n","\n","\n","#     # create embedding layers\n","#     embed_list = []\n","#     for i in ct._transformers:\n","#         embed_list.append(layers.Embedding(input_dim=i[1].n_bins, output_dim=16, mask_zero=False,\n","#                     embeddings_initializer=tf.keras.initializers.RandomUniform(minval=-1.0, maxval=1.0)))\n","        \n","#     # 3. lstm numeric\n","#     input_list.append(layers.Input(shape=(24, len(num_vars)), dtype=tf.float32))\n","#     lstm_num = input_list[-1]\n","\n","#     input_list.append(layers.Input(shape=(24, len(bin_vars)), dtype=tf.float32))\n","#     lstm_bin = input_list[-1]\n","\n","#     # # lstm - create embedding layers\n","#     # lstm_embed_list = []\n","#     # for cat_var in [i[0] for i in ct._transformers]:\n","#     #     lstm_embed_list.append(layers.Embedding(input_dim=64, output_dim=16, mask_zero=False,\n","#     #                 embeddings_initializer=tf.keras.initializers.RandomUniform(minval=-1.0, maxval=1.0)))\n","\n","#     # 4. lstm category\n","#     dcn_list = []\n","#     for cat_var in [i[0] for i in ct._transformers]:\n","#         input_list.append(layers.Input(shape=(24, 1), dtype=tf.int32))\n","#         x = embed_list[-1](input_list[-1])\n","#         dcn_list.append(tfa.layers.NoisyDense(4)(x))\n","#         # dcn_list.append(x)\n","\n","#     dcn_input = layers.Concatenate(axis=2)(dcn_list)\n","#     dcn1 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate)(dcn_input))\n","#     dcn2 = tfrs.layers.dcn.Cross()(dcn1, layers.Dropout(dropoutRate)(dcn1))\n","#     dcn3 = tfrs.layers.dcn.Cross()(dcn2, layers.Dropout(dropoutRate)(dcn2))\n","\n","#     dcn_concat = layers.Concatenate()([dcn_input, dcn1, dcn2, dcn3])\n","#     x = layers.Dropout(dropoutRate)(dcn_concat)\n","#     x = layers.Dense(16, activation=\"relu\")(x)\n","#     lstm_cat = layers.Reshape((24,-1))(x)\n","\n","#     # lstm_cat = layers.Concatenate()([layers.Reshape((24,-1))(dcn_input), layers.Reshape((24,-1))(dcn1), layers.Reshape((24,-1))(dcn2)])\n","#     # lstm_concat = layers.Concatenate()([lstm_num, lstm_cat])\n","#     # # lstm_concat = lstm_cat\n","#     # lstm_concat = layers.Concatenate()([layers.BatchNormalization()(lstm_concat), lstm_bin])\n","#     lstm_concat = layers.Concatenate()([lstm_num, lstm_cat, lstm_bin])\n","#     # lstm_concat = layers.Concatenate()([lstm_cat])\n","#     # lstm_concat = layers.BatchNormalization()(layers.Concatenate()([lstm_num, lstm_cat, lstm_bin]))\n","#     x = layers.LSTM(128, return_sequences=True, dropout=dropoutRate)(lstm_concat)\n","#     x = layers.LSTM(128, return_sequences=False, dropout=dropoutRate)(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     concat_list.append(layers.Dense(64, activation=\"relu\")(x))\n","\n","#     # x = layers.BatchNormalization()(layers.Concatenate()(concat_list))\n","#     x = layers.Concatenate()(concat_list)\n","\n","#     hidden1 = layers.Dropout(dropoutRate)(x)\n","#     hidden1 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"selu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden1)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1]))\n","#     hidden2 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"relu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1, hidden2]))\n","#     last_layer = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"elu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","\n","#     regressor = layers.Dense(1)(last_layer)\n","\n","#     return Model(input_list, regressor)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zei6A3-Jw87G"},"outputs":[],"source":["# create_model().summary()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QVtRCcWCO1FD"},"outputs":[],"source":["# plot_model(create_model())"]},{"cell_type":"markdown","source":["# NN Model - Swin Dense v1"],"metadata":{"id":"eUXv7hPcTnIV"}},{"cell_type":"code","source":["# img_size = 128\n","# channels = 3\n","\n","# patch_size = (4, 4)  # 2-by-2 sized patches\n","# dropout_rate = 1/2 ** 4  # Dropout rate\n","# num_heads = 16 # Attention heads\n","# embed_dim = 128  # Embedding dimension\n","# num_mlp = 512  # MLP layer size\n","# qkv_bias = True  # Convert embedded patches to query, key, and values with a learnable additive value\n","# window_size = 4  # Size of attention window\n","# shift_size = 2 # Size of shifting window\n","# image_dimension = img_size  # Initial image size\n","\n","# num_patch_x = img_size // patch_size[0]\n","# num_patch_y = img_size // patch_size[1]\n","\n","# dropoutRate = 0.5\n","\n","# def create_model():\n","#     input_list = []\n","#     concat_list = []\n","\n","#     input_list.append(layers.Input(shape=(img_size, img_size, channels), dtype=tf.float32))\n","\n","#     # augmenation layer\n","#     x = RandomColorDistortion(hue_flag=False)(input_list[-1])\n","#     x = layers.RandomFlip(mode=\"horizontal_and_vertical\")(x)\n","#     x = tf.keras.layers.Rescaling(scale=1./255)(x)\n","    \n","#     # PatchExtract : patch size 만큼 잘라 각 channel의 patch 조각들은 column으로 flatten 하고 이미지의 row 및 column은 row로 flatten\n","#     # 이미지가 8 * 8 * 3 이고 patch size가 2 * 2 이면 16 * 12 가 나옴 (16 = 8/2 * 8/2, 12 = 2 * 2 * 3)\n","#     x = PatchExtract(patch_size)(x)\n","#     # PatchEmbedding : 추출된 패치에 대해서 포지션 값을 부여하고 embedding layer에 넣음 (row에 대해 0~n 까지 정수값 부여)\n","#     # embedding layer를 통해 산출된 값과 dense layer를 통해 산출된 값을 더함 (두 layer는 같은 차원)\n","#     x = PatchEmbedding(num_patch_x * num_patch_y, embed_dim)(x)\n","\n","#     # Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim,\n","#         num_patch=(num_patch_x, num_patch_y),\n","#         num_heads=num_heads,\n","#         window_size=window_size,\n","#         shift_size=0,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     # Shifted Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim,\n","#         num_patch=(num_patch_x, num_patch_y),\n","#         num_heads=num_heads,\n","#         window_size=window_size,\n","#         shift_size=shift_size,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     x = PatchMerging((num_patch_x, num_patch_y), embed_dim=embed_dim * 2)(x)\n","\n","#     # Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim * 4,\n","#         num_patch=(num_patch_x//2, num_patch_y//2),\n","#         num_heads=num_heads,\n","#         window_size=window_size//2,\n","#         shift_size=0,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     # Shifted Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim * 4,\n","#         num_patch=(num_patch_x//2, num_patch_y//2),\n","#         num_heads=num_heads,\n","#         window_size=window_size//2,\n","#         shift_size=shift_size//2,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     x = PatchMerging((num_patch_x//2, num_patch_y//2), embed_dim=embed_dim * 4)(x)\n","#     x = layers.GlobalAveragePooling1D()(x)\n","\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(256, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     concat_list.append(layers.Dense(64, activation=\"relu\")(x))\n","\n","#     # create embedding layers\n","#     embed_list = []\n","#     for i in ct._transformers:\n","#         embed_list.append(layers.Embedding(input_dim=i[1].n_bins, output_dim=16, mask_zero=False,\n","#                     embeddings_initializer=tf.keras.initializers.RandomUniform(minval=-1.0, maxval=1.0)))\n","        \n","#     # 3. lstm numeric\n","#     input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(num_vars)), dtype=tf.float32))\n","#     lstm_num = input_list[-1]\n","\n","#     input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(bin_vars)), dtype=tf.float32))\n","#     lstm_bin = input_list[-1]\n","\n","#     # 4. lstm category\n","#     dcn_list = []\n","#     for cat_var in [i[0] for i in ct._transformers]:\n","#         input_list.append(layers.Input(shape=(train_timeseries.shape[1], 1), dtype=tf.int32))\n","#         x = embed_list[-1](input_list[-1])\n","#         dcn_list.append(tfa.layers.NoisyDense(4)(x))\n","\n","#     dcn_input = layers.Concatenate(axis=2)(dcn_list)\n","#     dcn1 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate)(dcn_input))\n","#     dcn2 = tfrs.layers.dcn.Cross()(dcn1, layers.Dropout(dropoutRate)(dcn1))\n","#     dcn3 = tfrs.layers.dcn.Cross()(dcn2, layers.Dropout(dropoutRate)(dcn2))\n","\n","#     dcn_concat = layers.Concatenate()([dcn_input, dcn1, dcn2, dcn3])\n","#     x = layers.Dropout(dropoutRate)(dcn_concat)\n","#     x = layers.Dense(4, activation=\"softmax\")(x)\n","#     lstm_cat = layers.Reshape((train_timeseries.shape[1],-1))(x)\n","\n","#     lstm_concat = layers.Concatenate(name=\"lstm_concat\")([lstm_num, lstm_cat, lstm_bin])\n","#     x = layers.Dropout(dropoutRate)(lstm_concat)\n","#     x = layers.Dense(16, activation=\"relu\")(x)\n","#     x = layers.Flatten()(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(64, activation=\"relu\")(x)\n","#     concat_list.append(x)\n","\n","#     x = layers.Concatenate()(concat_list)\n","\n","#     hidden1 = layers.Dropout(dropoutRate)(x)\n","#     hidden1 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"selu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden1)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1]))\n","#     hidden2 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"relu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1, hidden2]))\n","#     last_layer = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"elu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","\n","#     regressor = layers.Dense(1)(last_layer)\n","\n","#     return Model(input_list, regressor)"],"metadata":{"id":"pY92YiPHTnhR"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# create_model().summary()"],"metadata":{"id":"NVCcQza4ClIk"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# NN Model - Swin Dense v2"],"metadata":{"id":"l3OQodx45X8Q"}},{"cell_type":"code","source":["# img_size = 128\n","# channels = 3\n","\n","# patch_size = (4, 4)  # 2-by-2 sized patches\n","# dropout_rate = 1/2 ** 4  # Dropout rate\n","# num_heads = 16 # Attention heads\n","# embed_dim = 128  # Embedding dimension\n","# num_mlp = 512  # MLP layer size\n","# qkv_bias = True  # Convert embedded patches to query, key, and values with a learnable additive value\n","# window_size = 4  # Size of attention window\n","# shift_size = 2 # Size of shifting window\n","# image_dimension = img_size  # Initial image size\n","\n","# num_patch_x = img_size // patch_size[0]\n","# num_patch_y = img_size // patch_size[1]\n","\n","# dropoutRate = 0.5\n","\n","# def create_model():\n","#     input_list = []\n","#     concat_list = []\n","\n","#     input_list.append(layers.Input(shape=(img_size, img_size, channels), dtype=tf.float32))\n","\n","#     # augmenation layer\n","#     x = RandomColorDistortion(hue_flag=False)(input_list[-1])\n","#     x = layers.RandomFlip(mode=\"horizontal_and_vertical\")(x)\n","#     x = tf.keras.layers.Rescaling(scale=1./255)(x)\n","    \n","#     # PatchExtract : patch size 만큼 잘라 각 channel의 patch 조각들은 column으로 flatten 하고 이미지의 row 및 column은 row로 flatten\n","#     # 이미지가 8 * 8 * 3 이고 patch size가 2 * 2 이면 16 * 12 가 나옴 (16 = 8/2 * 8/2, 12 = 2 * 2 * 3)\n","#     x = PatchExtract(patch_size)(x)\n","#     # PatchEmbedding : 추출된 패치에 대해서 포지션 값을 부여하고 embedding layer에 넣음 (row에 대해 0~n 까지 정수값 부여)\n","#     # embedding layer를 통해 산출된 값과 dense layer를 통해 산출된 값을 더함 (두 layer는 같은 차원)\n","#     x = PatchEmbedding(num_patch_x * num_patch_y, embed_dim)(x)\n","\n","#     # Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim,\n","#         num_patch=(num_patch_x, num_patch_y),\n","#         num_heads=num_heads,\n","#         window_size=window_size,\n","#         shift_size=0,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     # Shifted Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim,\n","#         num_patch=(num_patch_x, num_patch_y),\n","#         num_heads=num_heads,\n","#         window_size=window_size,\n","#         shift_size=shift_size,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     x = PatchMerging((num_patch_x, num_patch_y), embed_dim=embed_dim * 2)(x)\n","\n","#     # Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim * 4,\n","#         num_patch=(num_patch_x//2, num_patch_y//2),\n","#         num_heads=num_heads,\n","#         window_size=window_size//2,\n","#         shift_size=0,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     # Shifted Windows Attention\n","#     x = SwinTransformer(\n","#         dim=embed_dim * 4,\n","#         num_patch=(num_patch_x//2, num_patch_y//2),\n","#         num_heads=num_heads,\n","#         window_size=window_size//2,\n","#         shift_size=shift_size//2,\n","#         num_mlp=num_mlp,\n","#         qkv_bias=qkv_bias,\n","#         dropout_rate=dropout_rate,\n","#     )(x)\n","#     x = PatchMerging((num_patch_x//2, num_patch_y//2), embed_dim=embed_dim * 4)(x)\n","#     x = layers.GlobalAveragePooling1D()(x)\n","\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(256, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     concat_list.append(layers.Dense(64, activation=\"relu\")(x))\n","\n","#     # create embedding layers\n","#     embed_list = []\n","#     for i in ct._transformers:\n","#         embed_list.append(layers.Embedding(input_dim=i[1].n_bins, output_dim=16, mask_zero=False,\n","#                     embeddings_initializer=\"glorot_uniform\"))\n","        \n","#     # 3. lstm numeric\n","#     input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(num_vars)), dtype=tf.float32))\n","#     lstm_num = input_list[-1]\n","\n","#     input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(bin_vars)), dtype=tf.float32))\n","#     lstm_bin = input_list[-1]\n","\n","#     # 4. lstm category\n","#     dcn_list = []\n","#     for idx, cat_var in enumerate([i[0] for i in ct._transformers]):\n","#         input_list.append(layers.Input(shape=(train_timeseries.shape[1], 1), dtype=tf.int32))\n","#         x = embed_list[idx](input_list[-1])\n","#         dcn_list.append(tfa.layers.NoisyDense(4)(x))\n","\n","#     dcn_input = layers.Concatenate(axis=2)(dcn_list)\n","#     dcn1 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate)(dcn_input))\n","#     dcn2 = tfrs.layers.dcn.Cross()(dcn1, layers.Dropout(dropoutRate)(dcn1))\n","\n","#     dcn_concat = layers.Concatenate()([dcn_input, dcn1, dcn2])\n","#     lstm_cat = layers.Reshape((train_timeseries.shape[1],-1))(dcn_concat)\n","\n","#     lstm_concat = layers.Concatenate(name=\"lstm_concat\")([lstm_num, lstm_cat, lstm_bin])\n","#     x = layers.Dropout(dropoutRate)(lstm_concat)\n","#     x = layers.Dense(32, activation=\"relu\")(x)\n","#     x = layers.Flatten()(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(1024, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(64, activation=\"relu\")(x)\n","#     concat_list.append(x)\n","\n","#     x = layers.Concatenate()(concat_list)\n","\n","#     hidden1 = layers.Dropout(dropoutRate)(x)\n","#     hidden1 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"selu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden1)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1]))\n","#     hidden2 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"relu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1, hidden2]))\n","#     last_layer = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"elu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","\n","#     regressor = layers.Dense(1)(last_layer)\n","\n","#     return Model(input_list, regressor)"],"metadata":{"id":"y-cMMZ7F5YOQ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# create_model().summary()"],"metadata":{"id":"Hw0ToaSi54z5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# plot_model(create_model())"],"metadata":{"id":"HDaxbsmnKEen"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# NN Model - Swin(pretrained) Dense V1"],"metadata":{"id":"1Vupa1fD1IOe"}},{"cell_type":"code","source":["# img_size = 224\n","# channels = 3\n","\n","# dropoutRate = 0.5\n","\n","# def create_model():\n","#     input_list = []\n","#     concat_list = []\n","\n","#     input_list.append(layers.Input(shape=(img_size, img_size, channels), dtype=tf.float32))\n","\n","#     # augmenation layer\n","#     x = RandomColorDistortion(hue_flag=False)(input_list[-1])\n","#     x = layers.RandomFlip(mode=\"horizontal_and_vertical\")(x)\n","#     x = tf.keras.layers.Rescaling(scale=1./255)(x)\n","\n","#     x = pretrained_model(x)\n","\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(256, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     concat_list.append(layers.Dense(64, activation=\"relu\")(x))\n","\n","#     # create embedding layers\n","#     embed_list = []\n","#     for i in ct._transformers:\n","#         embed_list.append(layers.Embedding(input_dim=i[1].n_bins, output_dim=16, mask_zero=False, embeddings_initializer=\"glorot_uniform\"))\n","\n","#     input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(num_vars)), dtype=tf.float32))\n","#     lstm_num = input_list[-1]\n","\n","#     input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(bin_vars)), dtype=tf.float32))\n","#     lstm_bin = input_list[-1]\n","\n","#     x = layers.Dropout(dropoutRate)(layers.Concatenate()([lstm_num, lstm_bin]))\n","#     lstm_num_bin = layers.Dense(16, activation=\"relu\")(x)\n","\n","#     # 4. lstm category\n","#     dcn_list = []\n","#     for idx, cat_var in enumerate([i[0] for i in ct._transformers]):\n","#         input_list.append(layers.Input(shape=(train_timeseries.shape[1], 1), dtype=tf.int32))\n","#         x = embed_list[idx](input_list[-1])\n","#         dcn_list.append(tfa.layers.NoisyDense(4)(x))\n","\n","#     dcn_input = layers.Concatenate(axis=2)(dcn_list)\n","#     dcn1 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate/2)(dcn_input))\n","#     dcn2 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate/2)(dcn1))\n","#     dcn3 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate/2)(dcn2))\n","\n","#     dcn_concat = layers.Concatenate()([dcn_input, dcn1, dcn2, dcn3])\n","#     x = layers.Dropout(dropoutRate)(dcn_concat)\n","#     x = layers.Dense(4, activation=\"relu\")(x)\n","#     lstm_cat = layers.Reshape((train_timeseries.shape[1],-1))(x)\n","\n","#     lstm_concat = layers.Concatenate(name=\"lstm_concat\")([lstm_num_bin, lstm_cat])\n","#     x = layers.Dropout(dropoutRate)(lstm_concat)\n","#     x = layers.Dense(32, activation=\"relu\")(x)\n","#     x = layers.Flatten()(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(1024, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(256, activation=\"relu\")(x)\n","#     x = layers.Dropout(dropoutRate)(x)\n","#     x = layers.Dense(64, activation=\"relu\")(x)\n","#     concat_list.append(x)\n","\n","#     x = layers.Concatenate()(concat_list)\n","\n","#     hidden1 = layers.Dropout(dropoutRate)(x)\n","#     hidden1 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"selu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden1)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1]))\n","#     hidden2 = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"relu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","    \n","#     hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1, hidden2]))\n","#     last_layer = tfa.layers.WeightNormalization(\n","#         layers.Dense(64, activation=\"elu\", kernel_initializer=\"lecun_normal\")\n","#     )(hidden2)\n","\n","#     regressor = layers.Dense(1)(last_layer)\n","\n","#     return Model(input_list, regressor)"],"metadata":{"id":"j6nlgEyn1H5v"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["img_size = 224\n","channels = 3\n","\n","dropoutRate = 0.5\n","\n","def create_model():\n","    input_list = []\n","    concat_list = []\n","\n","    input_list.append(layers.Input(shape=(img_size, img_size, channels), dtype=tf.float32))\n","\n","    # augmenation layer\n","    x = RandomColorDistortion(hue_flag=False)(input_list[-1])\n","    x = layers.RandomFlip(mode=\"horizontal_and_vertical\")(x)\n","    x = tf.keras.layers.Rescaling(scale=1./255)(x)\n","\n","    x = tf_hub.KerasLayer(\"https://tfhub.dev/sayakpaul/swin_base_patch4_window7_224_fe/1\", name=\"pretrained\", trainable=False)(x)\n","\n","    x = layers.Dropout(dropoutRate)(x)\n","    x = layers.Dense(256, activation=\"relu\")(x)\n","    x = layers.Dropout(dropoutRate)(x)\n","    concat_list.append(layers.Dense(64, activation=\"relu\")(x))\n","\n","    # create embedding layers\n","    embed_list = []\n","    for i in ct._transformers:\n","        embed_list.append(layers.Embedding(input_dim=i[1].n_bins, output_dim=16, mask_zero=False, embeddings_initializer=\"truncated_normal\"))\n","\n","    input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(num_vars)), dtype=tf.float32))\n","    lstm_num = input_list[-1]\n","\n","    input_list.append(layers.Input(shape=(train_timeseries.shape[1], len(bin_vars)), dtype=tf.float32))\n","    lstm_bin = input_list[-1]\n","\n","    # 4. lstm category\n","    dcn_list = []\n","    for idx, cat_var in enumerate([i[0] for i in ct._transformers]):\n","        input_list.append(layers.Input(shape=(train_timeseries.shape[1], 1), dtype=tf.int32))\n","        x = embed_list[idx](input_list[-1])\n","        dcn_list.append(tfa.layers.NoisyDense(4)(x))\n","\n","    dcn_input = layers.Concatenate(axis=2)(dcn_list)\n","    dcn1 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate)(dcn_input))\n","    dcn2 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate)(dcn1))\n","    dcn3 = tfrs.layers.dcn.Cross()(dcn_input, layers.Dropout(dropoutRate)(dcn2))\n","\n","    dcn_concat = layers.Concatenate()([dcn_input, dcn1, dcn2, dcn3])\n","    x = layers.Dropout(dropoutRate)(dcn_concat)\n","    x = layers.Dense(4, activation=\"softmax\")(x)\n","    lstm_cat = layers.Reshape((train_timeseries.shape[1],-1))(x)\n","\n","    lstm_concat = layers.Concatenate(name=\"lstm_concat\")([lstm_num, lstm_bin, lstm_cat])\n","    x = layers.Dropout(dropoutRate)(lstm_concat)\n","    x = layers.Dense(32, activation=\"relu\")(x)\n","    x = layers.Dropout(dropoutRate)(x)\n","    x = layers.Dense(8, activation=\"relu\")(x)\n","    x = layers.Flatten()(x)\n","    x = layers.Dropout(dropoutRate)(x)\n","    x = layers.Dense(256, activation=\"relu\")(x)\n","    x = layers.Dropout(dropoutRate)(x)\n","    x = layers.Dense(64, activation=\"relu\")(x)\n","    concat_list.append(x)\n","\n","    x = layers.Concatenate()(concat_list)\n","\n","    hidden1 = layers.Dropout(dropoutRate)(x)\n","    hidden1 = tfa.layers.WeightNormalization(\n","        layers.Dense(64, activation=\"swish\", kernel_initializer=\"lecun_normal\")\n","    )(hidden1)\n","    \n","    hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1]))\n","    hidden2 = tfa.layers.WeightNormalization(\n","        layers.Dense(64, activation=\"swish\", kernel_initializer=\"lecun_normal\")\n","    )(hidden2)\n","    \n","    hidden2 = layers.Dropout(dropoutRate)(layers.Concatenate()([x, hidden1, hidden2]))\n","    last_layer = tfa.layers.WeightNormalization(\n","        layers.Dense(64, activation=\"swish\", kernel_initializer=\"lecun_normal\")\n","    )(hidden2)\n","\n","    regressor = layers.Dense(1)(last_layer)\n","\n","    return Model(input_list, regressor)"],"metadata":{"id":"s8p2locFh73d"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["create_model().summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xUUKQ2CJ2lAl","executionInfo":{"status":"ok","timestamp":1652569543701,"user_tz":-540,"elapsed":71405,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"60ab1fd5-f948-4ff2-bd2d-acb230524ec9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"model\"\n","__________________________________________________________________________________________________\n"," Layer (type)                   Output Shape         Param #     Connected to                     \n","==================================================================================================\n"," input_4 (InputLayer)           [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_5 (InputLayer)           [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_6 (InputLayer)           [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_7 (InputLayer)           [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_8 (InputLayer)           [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_9 (InputLayer)           [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_10 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_11 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_12 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_13 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_14 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_15 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_16 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_17 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_18 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_19 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_20 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," input_21 (InputLayer)          [(None, 96, 1)]      0           []                               \n","                                                                                                  \n"," embedding (Embedding)          (None, 96, 1, 16)    1600        ['input_4[0][0]']                \n","                                                                                                  \n"," embedding_1 (Embedding)        (None, 96, 1, 16)    1600        ['input_5[0][0]']                \n","                                                                                                  \n"," embedding_2 (Embedding)        (None, 96, 1, 16)    1600        ['input_6[0][0]']                \n","                                                                                                  \n"," embedding_3 (Embedding)        (None, 96, 1, 16)    1600        ['input_7[0][0]']                \n","                                                                                                  \n"," embedding_4 (Embedding)        (None, 96, 1, 16)    1600        ['input_8[0][0]']                \n","                                                                                                  \n"," embedding_5 (Embedding)        (None, 96, 1, 16)    160         ['input_9[0][0]']                \n","                                                                                                  \n"," embedding_6 (Embedding)        (None, 96, 1, 16)    1600        ['input_10[0][0]']               \n","                                                                                                  \n"," embedding_7 (Embedding)        (None, 96, 1, 16)    160         ['input_11[0][0]']               \n","                                                                                                  \n"," embedding_8 (Embedding)        (None, 96, 1, 16)    160         ['input_12[0][0]']               \n","                                                                                                  \n"," embedding_9 (Embedding)        (None, 96, 1, 16)    160         ['input_13[0][0]']               \n","                                                                                                  \n"," embedding_10 (Embedding)       (None, 96, 1, 16)    160         ['input_14[0][0]']               \n","                                                                                                  \n"," embedding_11 (Embedding)       (None, 96, 1, 16)    1600        ['input_15[0][0]']               \n","                                                                                                  \n"," embedding_12 (Embedding)       (None, 96, 1, 16)    160         ['input_16[0][0]']               \n","                                                                                                  \n"," embedding_13 (Embedding)       (None, 96, 1, 16)    1600        ['input_17[0][0]']               \n","                                                                                                  \n"," embedding_14 (Embedding)       (None, 96, 1, 16)    160         ['input_18[0][0]']               \n","                                                                                                  \n"," embedding_15 (Embedding)       (None, 96, 1, 16)    160         ['input_19[0][0]']               \n","                                                                                                  \n"," embedding_16 (Embedding)       (None, 96, 1, 16)    160         ['input_20[0][0]']               \n","                                                                                                  \n"," embedding_17 (Embedding)       (None, 96, 1, 16)    160         ['input_21[0][0]']               \n","                                                                                                  \n"," noisy_dense (NoisyDense)       (None, 96, 1, 4)     204         ['embedding[0][0]']              \n","                                                                                                  \n"," noisy_dense_1 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_1[0][0]']            \n","                                                                                                  \n"," noisy_dense_2 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_2[0][0]']            \n","                                                                                                  \n"," noisy_dense_3 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_3[0][0]']            \n","                                                                                                  \n"," noisy_dense_4 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_4[0][0]']            \n","                                                                                                  \n"," noisy_dense_5 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_5[0][0]']            \n","                                                                                                  \n"," noisy_dense_6 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_6[0][0]']            \n","                                                                                                  \n"," noisy_dense_7 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_7[0][0]']            \n","                                                                                                  \n"," noisy_dense_8 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_8[0][0]']            \n","                                                                                                  \n"," noisy_dense_9 (NoisyDense)     (None, 96, 1, 4)     204         ['embedding_9[0][0]']            \n","                                                                                                  \n"," noisy_dense_10 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_10[0][0]']           \n","                                                                                                  \n"," noisy_dense_11 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_11[0][0]']           \n","                                                                                                  \n"," noisy_dense_12 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_12[0][0]']           \n","                                                                                                  \n"," noisy_dense_13 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_13[0][0]']           \n","                                                                                                  \n"," noisy_dense_14 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_14[0][0]']           \n","                                                                                                  \n"," noisy_dense_15 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_15[0][0]']           \n","                                                                                                  \n"," noisy_dense_16 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_16[0][0]']           \n","                                                                                                  \n"," noisy_dense_17 (NoisyDense)    (None, 96, 1, 4)     204         ['embedding_17[0][0]']           \n","                                                                                                  \n"," concatenate (Concatenate)      (None, 96, 18, 4)    0           ['noisy_dense[0][0]',            \n","                                                                  'noisy_dense_1[0][0]',          \n","                                                                  'noisy_dense_2[0][0]',          \n","                                                                  'noisy_dense_3[0][0]',          \n","                                                                  'noisy_dense_4[0][0]',          \n","                                                                  'noisy_dense_5[0][0]',          \n","                                                                  'noisy_dense_6[0][0]',          \n","                                                                  'noisy_dense_7[0][0]',          \n","                                                                  'noisy_dense_8[0][0]',          \n","                                                                  'noisy_dense_9[0][0]',          \n","                                                                  'noisy_dense_10[0][0]',         \n","                                                                  'noisy_dense_11[0][0]',         \n","                                                                  'noisy_dense_12[0][0]',         \n","                                                                  'noisy_dense_13[0][0]',         \n","                                                                  'noisy_dense_14[0][0]',         \n","                                                                  'noisy_dense_15[0][0]',         \n","                                                                  'noisy_dense_16[0][0]',         \n","                                                                  'noisy_dense_17[0][0]']         \n","                                                                                                  \n"," dropout_2 (Dropout)            (None, 96, 18, 4)    0           ['concatenate[0][0]']            \n","                                                                                                  \n"," cross (Cross)                  (None, 96, 18, 4)    20          ['concatenate[0][0]',            \n","                                                                  'dropout_2[0][0]']              \n","                                                                                                  \n"," dropout_3 (Dropout)            (None, 96, 18, 4)    0           ['cross[0][0]']                  \n","                                                                                                  \n"," cross_1 (Cross)                (None, 96, 18, 4)    20          ['concatenate[0][0]',            \n","                                                                  'dropout_3[0][0]']              \n","                                                                                                  \n"," dropout_4 (Dropout)            (None, 96, 18, 4)    0           ['cross_1[0][0]']                \n","                                                                                                  \n"," cross_2 (Cross)                (None, 96, 18, 4)    20          ['concatenate[0][0]',            \n","                                                                  'dropout_4[0][0]']              \n","                                                                                                  \n"," concatenate_1 (Concatenate)    (None, 96, 18, 16)   0           ['concatenate[0][0]',            \n","                                                                  'cross[0][0]',                  \n","                                                                  'cross_1[0][0]',                \n","                                                                  'cross_2[0][0]']                \n","                                                                                                  \n"," dropout_5 (Dropout)            (None, 96, 18, 16)   0           ['concatenate_1[0][0]']          \n","                                                                                                  \n"," dense_2 (Dense)                (None, 96, 18, 4)    68          ['dropout_5[0][0]']              \n","                                                                                                  \n"," input_2 (InputLayer)           [(None, 96, 18)]     0           []                               \n","                                                                                                  \n"," input_3 (InputLayer)           [(None, 96, 11)]     0           []                               \n","                                                                                                  \n"," reshape (Reshape)              (None, 96, 72)       0           ['dense_2[0][0]']                \n","                                                                                                  \n"," lstm_concat (Concatenate)      (None, 96, 101)      0           ['input_2[0][0]',                \n","                                                                  'input_3[0][0]',                \n","                                                                  'reshape[0][0]']                \n","                                                                                                  \n"," input_1 (InputLayer)           [(None, 224, 224, 3  0           []                               \n","                                )]                                                                \n","                                                                                                  \n"," dropout_6 (Dropout)            (None, 96, 101)      0           ['lstm_concat[0][0]']            \n","                                                                                                  \n"," random_color_distortion (Rando  (None, 224, 224, 3)  0          ['input_1[0][0]']                \n"," mColorDistortion)                                                                                \n","                                                                                                  \n"," dense_3 (Dense)                (None, 96, 32)       3264        ['dropout_6[0][0]']              \n","                                                                                                  \n"," random_flip (RandomFlip)       (None, 224, 224, 3)  0           ['random_color_distortion[0][0]']\n","                                                                                                  \n"," dropout_7 (Dropout)            (None, 96, 32)       0           ['dense_3[0][0]']                \n","                                                                                                  \n"," rescaling (Rescaling)          (None, 224, 224, 3)  0           ['random_flip[0][0]']            \n","                                                                                                  \n"," dense_4 (Dense)                (None, 96, 8)        264         ['dropout_7[0][0]']              \n","                                                                                                  \n"," pretrained (KerasLayer)        (None, 1024)         86743224    ['rescaling[0][0]']              \n","                                                                                                  \n"," flatten (Flatten)              (None, 768)          0           ['dense_4[0][0]']                \n","                                                                                                  \n"," dropout (Dropout)              (None, 1024)         0           ['pretrained[0][0]']             \n","                                                                                                  \n"," dropout_8 (Dropout)            (None, 768)          0           ['flatten[0][0]']                \n","                                                                                                  \n"," dense (Dense)                  (None, 256)          262400      ['dropout[0][0]']                \n","                                                                                                  \n"," dense_5 (Dense)                (None, 256)          196864      ['dropout_8[0][0]']              \n","                                                                                                  \n"," dropout_1 (Dropout)            (None, 256)          0           ['dense[0][0]']                  \n","                                                                                                  \n"," dropout_9 (Dropout)            (None, 256)          0           ['dense_5[0][0]']                \n","                                                                                                  \n"," dense_1 (Dense)                (None, 64)           16448       ['dropout_1[0][0]']              \n","                                                                                                  \n"," dense_6 (Dense)                (None, 64)           16448       ['dropout_9[0][0]']              \n","                                                                                                  \n"," concatenate_2 (Concatenate)    (None, 128)          0           ['dense_1[0][0]',                \n","                                                                  'dense_6[0][0]']                \n","                                                                                                  \n"," dropout_10 (Dropout)           (None, 128)          0           ['concatenate_2[0][0]']          \n","                                                                                                  \n"," weight_normalization (WeightNo  (None, 64)          16577       ['dropout_10[0][0]']             \n"," rmalization)                                                                                     \n","                                                                                                  \n"," concatenate_3 (Concatenate)    (None, 192)          0           ['concatenate_2[0][0]',          \n","                                                                  'weight_normalization[0][0]']   \n","                                                                                                  \n"," dropout_11 (Dropout)           (None, 192)          0           ['concatenate_3[0][0]']          \n","                                                                                                  \n"," weight_normalization_1 (Weight  (None, 64)          24769       ['dropout_11[0][0]']             \n"," Normalization)                                                                                   \n","                                                                                                  \n"," concatenate_4 (Concatenate)    (None, 256)          0           ['concatenate_2[0][0]',          \n","                                                                  'weight_normalization[0][0]',   \n","                                                                  'weight_normalization_1[0][0]'] \n","                                                                                                  \n"," dropout_12 (Dropout)           (None, 256)          0           ['concatenate_4[0][0]']          \n","                                                                                                  \n"," weight_normalization_2 (Weight  (None, 64)          32961       ['dropout_12[0][0]']             \n"," Normalization)                                                                                   \n","                                                                                                  \n"," dense_10 (Dense)               (None, 1)            65          ['weight_normalization_2[0][0]'] \n","                                                                                                  \n","==================================================================================================\n","Total params: 87,331,484\n","Trainable params: 549,977\n","Non-trainable params: 86,781,507\n","__________________________________________________________________________________________________\n"]}]},{"cell_type":"markdown","metadata":{"id":"r_D3XYVryFls"},"source":["# Training & Inference"]},{"cell_type":"markdown","source":["**define model name**"],"metadata":{"id":"6cHx7NrKZxum"}},{"cell_type":"code","source":["# model_name = \"swin_try1\" -> poor\n","# model_name = \"dropNA_swin_meta_discreteDCN_try2\"\n","# model_name = \"knnRandomnormalNA_swin_meta_discreteDCN_LSTM_try3\"\n","# model_name = \"knnRandomnormalNA_swin_onlyCAT_LSTM_try2\"\n","# model_name = \"knnRandomnormalNA_swin_LSTM_try2\" -> sota\n","# model_name = \"dropNA_swin_Dense_try1\"\n","# model_name = \"knnRandomnormalNA_swin_Dense_try1\"\n","# model_name = \"knnRandomnormalNA_swin_Dense_v2_try1\"\n","model_name = \"knnRandomnormalNA_pretrainedSwin_Dense_v2_try1\"\n","# model_name = \"knnRandomnormalNA_resedualDense_bit_meta_discreteDCN_LSTM_try1\"\n","# model_name = \"knnRandomnormalNA_bit_meta_discreteDCN_LSTM_try1\"\n","# model_name = \"knnRandomnormalNA_simpleCNN_meta_discreteDCN_LSTM_try1\"\n","# model_name = \"randomnormalNA_swin_meta_discreteDCN_try2\" -> poor\n","createFolder(os.path.join(folder_path, \"architectures/\" + model_name))\n","# plot_model(create_model(), to_file=folder_path + \"architectures/\" + model_name + \"/plot_model.png\", show_shapes=True)"],"metadata":{"id":"gXddXxInZsKu"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"gXLZ2Eae0GBh"},"outputs":[],"source":["def get_sample_weight(x, strategy=\"inverse_frequency\", class_transfrom=True, class_bins=10, boxcox_lambda=0.25):\n","    if strategy == \"inverse_frequency\":\n","        # x = pd.cut(x, bins=10).astype(\"object\") if class_transfrom else x\n","        # x = x.apply(lambda x: str(x))\n","        cluster_kmeans = KMeans(n_clusters=class_bins, random_state=42).fit(x)\n","        x = series(cluster_kmeans.predict(full_y))\n","        sample_weight = boxcox(1 / x.value_counts(True).sort_index(), boxcox_lambda)   \n","        sample_weight = dataframe([sample_weight[i] for i in x]).astype(\"float32\")\n","        return (sample_weight / sample_weight.min(), x)\n","def read_image(x):\n","    image = tf.io.read_file(x)\n","    image = tf.io.decode_image(image, channels=channels, expand_animations=False)\n","    image = tf.cast(image, tf.float32)\n","    # image = tf.image.central_crop(image, 0.8)\n","    image = tf.image.resize_with_pad(image, img_size, img_size, antialias=True)\n","    return image\n","def create_dataset(x, y, batch_size, shuffle=True, sample_weight=None):\n","    # if sample_weight is not None:\n","    #     dataset = tf.data.Dataset.from_tensor_slices((x, y, sample_weight))\n","    #     dataset = dataset.map(lambda x, y, sample_weight: (read_image(x), y, sample_weight))\n","    # else:\n","    #     dataset = tf.data.Dataset.from_tensor_slices((x, y))\n","    #     dataset = dataset.map(lambda x, y: (read_image(x), y))\n","    if sample_weight is not None:\n","        dataset = tf.data.Dataset.from_tensor_slices((x, y, sample_weight))\n","        dataset = dataset.map(lambda x, y, sample_weight: ((read_image(x[0]), x[1:]), y, sample_weight))\n","    else:\n","        dataset = tf.data.Dataset.from_tensor_slices((x, y))\n","        dataset = dataset.map(lambda x, y: ((read_image(x[0]), x[1:]), y))\n","    dataset = dataset.shuffle(int(batch_size * 4), reshuffle_each_iteration=True) if shuffle else dataset\n","    dataset = dataset.batch(batch_size)\n","    dataset = dataset.prefetch(2)\n","    return dataset\n","def shape_check_on_tuple(x, check_num_features):\n","    return sum([i.shape[-1] for i in x]) == check_num_features\n","def tf_metrics_nmae(y_true, y_pred):\n","    mae = tf.reduce_mean(tf.math.abs(y_true - y_pred))\n","    return tf.math.divide(mae, tf.reduce_mean(tf.math.abs(y_true)))\n","def tf_metrics_nmae_log(y_true, y_pred):\n","    mae = tf.reduce_mean(tf.math.abs(tf.math.expm1(y_true) - tf.math.expm1(y_pred)))\n","    return tf.math.divide(mae, tf.reduce_mean(tf.math.abs(tf.math.expm1(y_true))))\n","def get_nmae(y_true, y_pred):\n","    mae = np.mean(np.abs(y_true - y_pred))\n","    return mae / np.mean(np.abs(y_true))\n","def warmup_scheduler(epoch, lr):\n","  if epoch < 1:\n","    return 1e-2\n","  elif epoch == 1:\n","    return 1e-3\n","  else:\n","    return lr"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"LOfCGOHa6UGF"},"outputs":[],"source":["def do_fold_training(fold, train_idx, val_idx, sample_weight=None, finetuning=False):\n","    tmp_time = time()\n","    print(\"\\n===== Fold\", fold, \"=====\\n\")\n","\n","    global scaler_list, lstm_scaler_list\n","    lstm_scaler_list.append(MinMaxScaler(feature_range=(0.0, 1.0)))\n","    lstm_scaler_list[-1].fit(np.concatenate([i[:, 0:len(num_vars)] for i in train_timeseries[train_idx]], axis=0))\n","\n","    # ===== train =====\n","    # LSTM features - log trans, batch normalization\n","    lstm_num = np.concatenate([lstm_scaler_list[-1].transform(i[:, 0:len(num_vars)])[np.newaxis, ...] for i in train_timeseries[train_idx]], axis=0)\n","    lstm_bin = np.concatenate([i[:, len(num_vars)+len(cat_vars):len(num_vars)+len(cat_vars)+len(bin_vars)][np.newaxis, ...] for i in train_timeseries[train_idx]], axis=0)\n","    lstm_cat = tuple([np.concatenate([j[np.newaxis, :, i:(i+1)] for j in train_timeseries[train_idx]], axis=0) for i in range(len(num_vars), len(num_vars)+len(cat_vars))])\n","    tmp_x = (\n","        full_x_img.iloc[train_idx].apply(lambda x: get_image_path(x, train=True)),\n","    ) \\\n","    + (lstm_num,) \\\n","    + (lstm_bin,) \\\n","    + lstm_cat\n","\n","    if not shape_check_on_tuple((lstm_num, lstm_bin) + lstm_cat, train_timeseries.shape[-1]):\n","        raise ValueError(\"shape not matched : expected\", train_timeseries.shape[-1])\n","\n","    # # all features\n","    # lstm_num = np.concatenate([lstm_scaler_list[-1].transform(i[:, 0:len(num_vars)])[np.newaxis, ...] for i in train_timeseries[train_idx]], axis=0)\n","    # lstm_cat = tuple([np.concatenate([j[np.newaxis, :, i:(i+1)] for j in train_timeseries[train_idx]], axis=0) for i in range(len(num_vars), len(num_vars) * 2)])\n","    # tmp_x = (\n","    #     full_x.iloc[train_idx][\"id\"].apply(lambda x: get_image_path(x, train=True)),\n","    #     scaler_list[-1].transform(full_x.iloc[train_idx][num_vars]).astype(\"float32\"),\n","    # ) \\\n","    # + tuple([full_x.iloc[train_idx][[i[0]]] for i in ct._transformers]) \\\n","    # + (lstm_num,) \\\n","    # + lstm_cat\n","    tmp_y = full_y.iloc[train_idx][[target_var]]\n","    train_ds = create_dataset(tmp_x, tmp_y, batch_size, True, sample_weight)\n","\n","    # ===== validation =====\n","    # LSTM features - log trans, batch normalization\n","    lstm_num = np.concatenate([lstm_scaler_list[-1].transform(i[:, 0:len(num_vars)])[np.newaxis, ...] for i in train_timeseries[val_idx]], axis=0)\n","    lstm_bin = np.concatenate([i[:, len(num_vars)+len(cat_vars):len(num_vars)+len(cat_vars)+len(bin_vars)][np.newaxis, ...] for i in train_timeseries[val_idx]], axis=0)\n","    lstm_cat = tuple([np.concatenate([j[np.newaxis, :, i:(i+1)] for j in train_timeseries[val_idx]], axis=0) for i in range(len(num_vars), len(num_vars)+len(cat_vars))])\n","    tmp_x = (\n","        full_x_img[val_idx].apply(lambda x: get_image_path(x, train=True)),\n","    ) \\\n","    + (lstm_num,) \\\n","    + (lstm_bin,) \\\n","    + lstm_cat\n","\n","    if not shape_check_on_tuple((lstm_num, lstm_bin) + lstm_cat, train_timeseries.shape[-1]):\n","        raise ValueError(\"shape not matched : expected\", train_timeseries.shape[-1])\n","    # # all features\n","    # lstm_num = np.concatenate([lstm_scaler_list[-1].transform(i[:, 0:len(num_vars)])[np.newaxis, ...] for i in train_timeseries[val_idx]], axis=0)\n","    # lstm_cat = tuple([np.concatenate([j[np.newaxis, :, i:(i+1)] for j in train_timeseries[val_idx]], axis=0) for i in range(len(num_vars), len(num_vars) * 2)])\n","    # tmp_x = (\n","    #     full_x.iloc[val_idx][\"id\"].apply(lambda x: get_image_path(x, train=True)),\n","    #     scaler_list[-1].transform(full_x.iloc[val_idx][num_vars]).astype(\"float32\")\n","    # ) \\\n","    # + tuple([full_x.iloc[val_idx][[i[0]]] for i in ct._transformers]) \\\n","    # + (lstm_num,) \\\n","    # + lstm_cat\n","\n","    tmp_y = full_y.iloc[val_idx][[target_var]]\n","    val_ds = create_dataset(tmp_x, tmp_y, batch_size, False)\n","    del tmp_x, tmp_y\n","\n","    cb_tensorboard = tf_callbacks.TensorBoard(log_dir=\"./tmp_tb\", histogram_freq=1)\n","    \n","    try:\n","        wandb.tensorboard.patch(root_logdir=\"./tmp_tb\")\n","    except:\n","        pass\n","    wandb.init(\n","        project=\"dacon_plant_leaf_weight\",\n","        group=model_name,\n","        name=\"fold_\" + str(fold)\n","    ); wandb.config.step = 0\n","\n","\n","    total_iter = int(np.ceil(train_idx.shape[0] / batch_size) * epochs)\n","    SCHEDULE_BOUNDARIES = [int(total_iter*0.1), int(total_iter*0.2), int(total_iter*0.4), int(total_iter*0.6), int(total_iter*0.8)]\n","    lr_schedule = tf.keras.optimizers.schedules.PiecewiseConstantDecay(\n","        boundaries=SCHEDULE_BOUNDARIES,\n","        values=[3e-3, 1e-3, 5e-4, 1e-4, 5e-5, 1e-5],\n","    )\n","\n","    cb_earlyStopping = tf_callbacks.EarlyStopping(patience=patient_epochs, monitor='val_tf_metrics_nmae_log', mode='min')\n","    # cb_reduceLR = tf_callbacks.ReduceLROnPlateau(patience=patient_lr, factor=0.5, min_lr=1e-5)\n","    # cb_LRscheduler = tf_callbacks.LearningRateScheduler(warmup_scheduler)\n","    cb_modelsave = tf_callbacks.ModelCheckpoint(filepath=checkpoint_filepath, monitor='val_tf_metrics_nmae_log', mode='min',\n","                                                save_weights_only=True, save_best_only=True)\n","\n","    model = create_model()\n","    model.compile(\n","        loss=tf.keras.losses.MeanAbsoluteError(),\n","        # loss=tf_losses_rmse,\n","        optimizer=tfa.optimizers.AdamW(learning_rate=lr_schedule, weight_decay=weight_decay),\n","        metrics=[tf_metrics_nmae_log]\n","    )\n","\n","    print(\"start training\")\n","    history = model.fit(train_ds, validation_data=val_ds, epochs=epochs, verbose=0,\n","            callbacks=[cb_earlyStopping, cb_modelsave, cb_tensorboard, TqdmCallback(verbose=1)])\n","    model.load_weights(checkpoint_filepath)\n","    print(\"end training\")\n","    # model.trainable = False\n","\n","    if finetuning:\n","        # model.trainable = True\n","        model.get_layer(name=\"pretrained\").trainable=True\n","        epochs_finetuning = int(epochs * 0.2)\n","        model.compile(\n","            loss=tf.keras.losses.MeanAbsoluteError(),\n","            # loss=tf_losses_rmse,\n","            optimizer=tfa.optimizers.AdamW(learning_rate=1e-6, weight_decay=weight_decay),\n","            metrics=[tf_metrics_nmae_log]\n","        )\n","        model.fit(train_ds, validation_data=val_ds, epochs=epochs_finetuning, verbose=0,\n","                callbacks=[cb_modelsave, TqdmCallback(verbose=1)])\n","        model.load_weights(checkpoint_filepath)\n","        # model.trainable = False\n","\n","    model_list.append(model)\n","    history_list.append(history)\n","    fold_metric.append(model.evaluate(val_ds, return_dict=True, verbose=0))\n","    print(fold_metric[-1])\n","    global val_pred\n","    val_pred[train_idx, 0] += model.predict(val_ds)[:,0]\n","    del train_ds, val_ds\n","\n","    # ===== test =====\n","    # LSTM feature - log trans, batch normalization\n","    lstm_num = np.concatenate([lstm_scaler_list[-1].transform(i[:, 0:len(num_vars)])[np.newaxis, ...] for i in test_timeseries], axis=0)\n","    lstm_bin = np.concatenate([i[:, len(num_vars)+len(cat_vars):len(num_vars)+len(cat_vars)+len(bin_vars)][np.newaxis, ...] for i in test_timeseries], axis=0)\n","    lstm_cat = tuple([np.concatenate([j[np.newaxis, :, i:(i+1)] for j in test_timeseries], axis=0) for i in range(len(num_vars), len(num_vars)+len(cat_vars))])\n","    tmp_x = (\n","        test_x_img.apply(lambda x: get_image_path(x, train=False)),\n","    ) \\\n","    + (lstm_num,) \\\n","    + (lstm_bin,) \\\n","    + lstm_cat\n","\n","    if not shape_check_on_tuple((lstm_num, lstm_bin) + lstm_cat, train_timeseries.shape[-1]):\n","        raise ValueError(\"shape not matched : expected\", train_timeseries.shape[-1])\n","    \n","    # # all feature\n","    # lstm_num = np.concatenate([lstm_scaler_list[-1].transform(i[:, 0:len(num_vars)])[np.newaxis, ...] for i in test_timeseries], axis=0)\n","    # lstm_cat = tuple([np.concatenate([j[np.newaxis, :, i:(i+1)] for j in test_timeseries], axis=0) for i in range(len(num_vars), len(num_vars) * 2)])\n","    # tmp_x = (\n","    #     test_x[\"id\"].apply(lambda x: get_image_path(x, train=False)),\n","    #     scaler_list[-1].transform(test_x[num_vars]).astype(\"float32\")\n","    # ) \\\n","    # + tuple([test_x[[i[0]]] for i in ct._transformers]) \\\n","    # + (lstm_num,) \\\n","    # + lstm_cat\n","\n","    tmp_y = None\n","    test_ds = create_dataset(tmp_x, tmp_y, batch_size, False)\n","\n","    pred = model.predict(test_ds)\n","    global result_pred\n","    result_pred += np.expm1(pred) / n_folds\n","    \n","    val_nmae = get_nmae(np.expm1(full_y[target_var].iloc[val_idx].to_numpy()), np.expm1(val_pred[train_idx, 0]))\n","    print(\"NMAE :\", val_nmae)\n","    wandb.log({\"fold\": fold,\n","               \"loss\": fold_metric[-1][\"loss\"],\n","               \"tf_metrics_nmae_log\": fold_metric[-1][\"tf_metrics_nmae_log\"],\n","               \"NMAE\": val_nmae})\n","    wandb.finish()\n","\n","    print(\"Fold \" + str(fold) + \" Time (minutes) : \", round((time() - tmp_time) / 60, 3))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"daegVcyt0rLL"},"outputs":[],"source":["# learning parameter setting\n","epochs = 50\n","patient_epochs = 25\n","# patient_lr = 2\n","batch_size = 8\n","# eta = 1e-3\n","weight_decay = 1e-4\n","checkpoint_filepath = './tmp_checkpoint/fold_checkpoint'\n","optimizer_name = \"AdamW\"\n","val_pred = np.zeros(shape=(full_x_img.shape[0], 1))\n","result_pred = np.zeros(shape=(test_x_img.shape[0], 1))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"9JjgNTFTGmES"},"outputs":[],"source":["# knn_scaler = MinMaxScaler()\n","# sil = []\n","# kmax = 20\n","\n","# # dissimilarity would not be defined for a single cluster, thus, minimum number of clusters should be 2\n","# for k in range(2, kmax+1):\n","#     model_kmeans = skl_kmeans(n_clusters=k, random_state=42)\n","#     model_kmeans.fit(knn_scaler.fit_transform(np.expm1(full_y)))\n","#     sil.append(skl_silhouette_score(knn_scaler.transform(np.expm1(full_y)), model_kmeans.labels_, metric='euclidean'))\n","# print(series(sil, index=range(2, kmax+1)).sort_index(ascending=True))"]},{"cell_type":"code","source":["knn_scaler = MinMaxScaler()\n","# best k = 7\n","model_kmeans = skl_kmeans(n_clusters=7, random_state=42)\n","strat_vec = model_kmeans.fit(knn_scaler.fit_transform(np.expm1(full_y))).labels_"],"metadata":{"id":"FHCgSezXtNXu"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000,"referenced_widgets":["1f95cc9c30c6429580742aee9088bb46","8493745dbbee42598f9098ec5dad336d","a3fc773df397448a960239092300e9bf","8780eb781a0b459597d417ad005b8546","842eb40364654316ba9f4fa19f6ba303","c6ab7130a3a04fb192d244664b2454c0","038f4013594e47409af7f96b6a91f949","3516837e9fab4126bc1e2efb3283b488","a1422857fa51444380ab37d1f9788557","05be345fe93145179188e700035cd7f4","23fdb52eac2b491d9e9b45400a3ba7c0","8b2282a1f4b741398dd6fa773b9ea319","f1928f4901ca44afaa62232997b4cfb6","966c188b17074e8584599cbcc67fd3e9","a318ac48a7344692942ce847a153257c","357c8b33e671456b80c17d2fc156cdad","70500b3f8fe04d44b4fa0924b517daad","3359850c605d40818bedd0c28eb905d3","5354c0b533a441f5812f584fee0e1926","07db3899ca584f2481206039c35b3b8b","844e75616b1448d2bb2004a03659a306","fee97411def44689ad9e0f5255e1158e","69bdebaffe354b29b082f57d82496978","53ea2619f7d04348b666f6f16028e971","e4e7ff15c9234aa4be41219bdbe5b0cc","b975b73e8c644b1f99c9fc1c14612c09","d5e302ede69a418eb7cacfbd7b379b4a","d3764beb3781448aab08db7224f0b77c","7e603c8f70c54cfb9b493f3fec91f244","bc08785a8d354bb8b1d152df0f61c27f","79b39875bf2f48c9a8bdfed14b08766d","fe46e5a3eb6842fc8c47b5cfbd514012","4df913b0e3c140369ae6112dc74f120d","6137e5d9f28247b585c4c2ac013063a3","14cb6cffbe8d4157833ad4f3cd7f482a","361fe3d5a9004244aaddc3fd9a06ad12","ac9b2ab6f87e476480dbd7aa8162e19b","2b30f8b3cf7348e8a045061438ac7e6c","f7b9d8470e8841a68f1379f80e97625a","cd33b505c9224657b4062529dee49cc1","5d3c51ba707444cca061b8fd570c2e43","7223d9f076164bc6be3dd6d633c2104f","5ba9ae8e66fc4a93a9141239d8a38a24","2b705f5e0e01411da336b86bb0127899","ff162150e86a41f39dd0591e4305bd82","f3463ef1095e41dba1f839dbe0b409cf","d9cc44bd3ca44a7ba25c15055cf40e87","b921c88ff7d84aeda4d950294ae6a9fb","46140ceefe76474f9338ee735488a633","6fb48af3baea4317a76349fdd970f039","df9864cf00e94507908a9aa779fd0e4f","56157cb8b0274a6ba1f4259feab22b42","db94a5acbdd5402cb432bb075572648f","e8e453abbc6346059fbf188dbb453999","f05aca29b8fc422691753736b25b3f79","34d747fdf54f4d2e8865eeeb60271472","2bf65a0e5b0849289a582d0138ed60d4","cabee26d5ec94f2aa5fbb1c8c5d3a213","a5be84d979a64c8ea42951c0ec74fec4","4ea32b84d4d146249e07692f792571f0","7c417d68e20f4be089d077554bc2248a","cabc2f56df8e4c3db5feef07efba16bd","59e6e16850714539b20be1c14165f28f","5bca88dd1b8549368e97f962a9df1415","fa9a13ab95ee414aa9d528e98abe7b07","663532c06ede48968e1cb005b855634d","e5d58d69d0864b378ee088e6e56900db","7b1504d38b214865a10c6590cb67267c","b78f010248af4f0eb71c65f387978063","a9259d84c9e04a94a6c02bf4e1d70187","d7d2058e3e914e65a87c60bf5d2a6f6b","be7b2dadb6684b10afa1313cb8e651ef","3e16c0d575294b8dabdaa572eb2795d7","ce864be4de9c4817a0556a73da366eea","0111366461944f709bd75f7cfb6c9d2e","f95ff3a784dc410fa763c351d6035201","0392a83434ad47fdabb28d95f540a801","4e279d3b22404a99b163449253d84c93","37f7229ddf794f3a98208eee0f29f82e","2ca7a7d7c7ed45e08af431a338a68947","02732c1bd3574d85a080013f8f859a7a","52f05410d0974ce3ba669fb82b6f4f26","b83b8ea46e7a48d2ae478d6b14e7ccfe","1a80cb470ab94d7e9dc82b4986c7bb4e","0d2eb57c55584373aea64a1f42876904","e71afcb7a1b245c693d1872d5de739ff","5e8c1f0402c54ad9b266e0a62a797065","e2951c11a7154eb0922c1a71dd2aa187","c036bad1c8a54f2ea201ec1ee09c751f","22088a7dc1354a728d830855d6536c32","b6a6fa4fe2b24e6f91c0bc1a7dd799d1","4b07b3f3f8784db4a515853eb7d63c82","efca97845876476c8c09fd2e2fb3fb71","7ab6562d740b42acbe9abc4d1de91fcf","ebeff912a17a44d3894f1282d14d1c7a","0186d2df9f0a4023a1dc3b59cc7d6dd8","5136fab29070495592cb727388b6945f","3baf3b450c564b99ad4fbee86256e4c0","a90f7cb057224acbbc4931976e136347","d9bcd9440ab84567ac995ff05321380e","baeac31562d24768ba2c5153169f12e3","f5d93f6f6eee483c8c4da73f05b7047e","e62f2596d6e44edfb8454568c1d61223","ee310051e53d45819c025a57138751ce","2cc0afa266774b25a9ec4f8b9b284b0a","6856b788c59041519e863f5633e278c9","b974694457eb4c62b3ac9b06a9f3913d","064aa3fce836472f9254dcd45a72d7ec","05ef9678741f49b280b9647d795d3666","763c2e18aa0349c897ad40c0e26a99fb","b9e549ba33c644adbe497ba1cb94fc06","44a3c6eceae24abbb2949412457168d1","262660c7fd8b46fb9a90f2a7783fe040","921fc3788d6a48e0a7dfa7e127ac6267","7d750296daa04b96838e235804651511","c4c3b480295a412cb22cf81cddd047ee","aa9269b30db34c0fad26f88e7c44fcaa","5d5d17f4f31a4196aca0188787ed5057","16b6b1dc3bbc4ecc996d4ec7078ad565","bcff9e0568914d4e8a4cfad58dd75eab","9e689883d44348cfa5a190dc2a6f5ca8","ec00b31c1d2e4455887c038019148395","b403a0d059c84e2faff349ab10cd38e1","647f8f7baa224024b233672903aaf0e2","c0ba029a5f2d4f5891d79aa0520f6b1f","801cf67866ab4e6287ec9e0b9468e0c5","cea131f3b2a44dbe9252475b0c5a93f4","df63696154df4208893536ba4be286d3","cdfb5939a9ba4d57b7fc863b69df2458","917d7649d9d8468198e342d4d6a89186","274d973dd7ef4f77aaafe48817de3a1a","29ebf52100484be498444b6b6418598b","fb3885143aaf4b80b0b677e2c2d4f88e","c40dfecfe0ce49b5b4e9409df2ac091f","f5e0588347ae472496d973a97614117f","c83aa2cc77eb4689923e757cca0804eb","ca7c0136165540e89337c62b1057a9f4","27dca7c2bb5f4322a89d2c6233e8d544","951eb4b0528d4ed6a54a194fde1c6bdc","2772f6635cbc47e48064c850d6755e6f","b679ec2de9ff470a8a23251586da9ce7","a7c396acbd9f4b94b4e682cae5fe7cdf","b6cd20d7907f48998cc2180b1d8d3c6c","20b8c3c9ec184a0193c5f41ad7936f08","c0c507a7f5204c38a8cd634896f60959","f57ee7d895d84605902d5240063f48bb","f92b45c949c748d7b3434faab561a613","7246bbd2333a4a4d82cbeebd5b4e0da5","d6c0719fb6644d859b4b09d3390b708d","34218108cbfb4d95afa37b62829dcada"]},"id":"mwuIx4ET0rJG","outputId":"55d76b96-065f-4fc5-d97d-a9a6642ff025","executionInfo":{"status":"ok","timestamp":1652600338553,"user_tz":-540,"elapsed":30753772,"user":{"displayName":"김영준","userId":"06606532799291918175"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["[debug] memory usage:   3930.184 MB\n","\n","===== Fold 0 =====\n","\n"]},{"output_type":"stream","name":"stderr","text":["\u001b[34m\u001b[1mwandb\u001b[0m: Currently logged in as: \u001b[33mfrony\u001b[0m. Use \u001b[1m`wandb login --relogin`\u001b[0m to force relogin\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.12.16"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20220514_230630-2badxpna</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2badxpna\" target=\"_blank\">fold_0</a></strong> to <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["start training\n"]},{"output_type":"display_data","data":{"text/plain":["0epoch [00:00, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1f95cc9c30c6429580742aee9088bb46"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["0batch [00:00, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8b2282a1f4b741398dd6fa773b9ea319"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["end training\n","{'loss': 0.18940001726150513, 'tf_metrics_nmae_log': 0.16917864978313446}\n","NMAE : 0.16143194\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='28.167 MB of 28.167 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=1.0, m…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"69bdebaffe354b29b082f57d82496978"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>▁</td></tr><tr><td>fold</td><td>▁</td></tr><tr><td>global_step</td><td>▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███</td></tr><tr><td>loss</td><td>▁</td></tr><tr><td>tf_metrics_nmae_log</td><td>▁</td></tr><tr><td>train/epoch_learning_rate</td><td>████▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_loss</td><td>█▄▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/global_step</td><td>▁▁▁▁▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇████</td></tr><tr><td>validation/epoch_loss</td><td>█▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>█▃▃▃▂▂▂▁▁▁▁▁▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>█▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>█▃▃▃▂▂▂▁▁▁▁▁▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂</td></tr><tr><td>validation/global_step</td><td>▁▂▁▁▁▁▁▁▁▅▅▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>0.16143</td></tr><tr><td>fold</td><td>0</td></tr><tr><td>global_step</td><td>7950</td></tr><tr><td>loss</td><td>0.1894</td></tr><tr><td>tf_metrics_nmae_log</td><td>0.16918</td></tr><tr><td>train/epoch_learning_rate</td><td>1e-05</td></tr><tr><td>train/epoch_loss</td><td>0.33815</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>0.33478</td></tr><tr><td>train/global_step</td><td>49</td></tr><tr><td>validation/epoch_loss</td><td>0.21696</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>0.20558</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>0.21696</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>0.20558</td></tr><tr><td>validation/global_step</td><td>49</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Synced <strong style=\"color:#cdcd00\">fold_0</strong>: <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2badxpna\" target=\"_blank\">https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2badxpna</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 2 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20220514_230630-2badxpna/logs</code>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Fold 0 Time (minutes) :  102.916\n","[debug] memory usage:   6257.242 MB\n","@Memory leaked : 2327.05859375\n","[debug] memory usage:   6257.242 MB\n","\n","===== Fold 1 =====\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.12.16"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20220515_004920-1sxbtzr3</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/1sxbtzr3\" target=\"_blank\">fold_1</a></strong> to <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["start training\n"]},{"output_type":"display_data","data":{"text/plain":["0epoch [00:00, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"79b39875bf2f48c9a8bdfed14b08766d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["0batch [00:00, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7223d9f076164bc6be3dd6d633c2104f"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3600s vs `on_train_batch_end` time: 0.4592s). Check your callbacks.\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3600s vs `on_train_batch_end` time: 0.4592s). Check your callbacks.\n"]},{"output_type":"stream","name":"stdout","text":["end training\n","{'loss': 0.16604308784008026, 'tf_metrics_nmae_log': 0.15468810498714447}\n","NMAE : 0.15276167\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='28.976 MB of 28.976 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=1.0, m…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"db94a5acbdd5402cb432bb075572648f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>▁</td></tr><tr><td>fold</td><td>▁</td></tr><tr><td>global_step</td><td>▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███</td></tr><tr><td>loss</td><td>▁</td></tr><tr><td>tf_metrics_nmae_log</td><td>▁</td></tr><tr><td>train/epoch_learning_rate</td><td>████▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_loss</td><td>█▄▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>█▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/global_step</td><td>▁▁▁▁▂▂▂▂▂▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███</td></tr><tr><td>validation/epoch_loss</td><td>█▇▆▃▂▃▃▂▂▂▂▂▂▂▁▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>█▆▇▄▂▄▅▂▂▂▂▂▂▂▁▂▂▁▁▁▁▂▁▁▁▁▂▁▁▂▂▁▂▂▂▂▂▂▂▃</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>█▇▆▃▂▃▃▂▂▂▂▂▂▂▁▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>█▆▇▄▂▄▅▂▂▂▂▂▂▂▁▂▂▁▁▁▁▂▁▁▁▁▂▁▁▂▂▁▂▂▂▂▂▂▂▃</td></tr><tr><td>validation/global_step</td><td>▁▁▁▂▁▁▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▁▁▁▁▁█▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>0.15276</td></tr><tr><td>fold</td><td>1</td></tr><tr><td>global_step</td><td>7950</td></tr><tr><td>loss</td><td>0.16604</td></tr><tr><td>tf_metrics_nmae_log</td><td>0.15469</td></tr><tr><td>train/epoch_learning_rate</td><td>1e-05</td></tr><tr><td>train/epoch_loss</td><td>0.30652</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>0.30758</td></tr><tr><td>train/global_step</td><td>49</td></tr><tr><td>validation/epoch_loss</td><td>0.22687</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>0.22314</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>0.22687</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>0.22314</td></tr><tr><td>validation/global_step</td><td>49</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Synced <strong style=\"color:#cdcd00\">fold_1</strong>: <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/1sxbtzr3\" target=\"_blank\">https://wandb.ai/frony/dacon_plant_leaf_weight/runs/1sxbtzr3</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 2 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20220515_004920-1sxbtzr3/logs</code>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Fold 1 Time (minutes) :  102.267\n","[debug] memory usage:   8843.199 MB\n","@Memory leaked : 2585.95703125\n","[debug] memory usage:   8843.199 MB\n","\n","===== Fold 2 =====\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.12.16"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20220515_023139-3qiogxhq</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/3qiogxhq\" target=\"_blank\">fold_2</a></strong> to <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["start training\n"]},{"output_type":"display_data","data":{"text/plain":["0epoch [00:00, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7c417d68e20f4be089d077554bc2248a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["0batch [00:00, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"be7b2dadb6684b10afa1313cb8e651ef"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3652s vs `on_train_batch_end` time: 0.4700s). Check your callbacks.\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3652s vs `on_train_batch_end` time: 0.4700s). Check your callbacks.\n"]},{"output_type":"stream","name":"stdout","text":["end training\n","{'loss': 0.17320486903190613, 'tf_metrics_nmae_log': 0.1302429586648941}\n","NMAE : 0.13084014\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='28.930 MB of 28.930 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=1.0, m…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b83b8ea46e7a48d2ae478d6b14e7ccfe"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>▁</td></tr><tr><td>fold</td><td>▁</td></tr><tr><td>global_step</td><td>▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███</td></tr><tr><td>loss</td><td>▁</td></tr><tr><td>tf_metrics_nmae_log</td><td>▁</td></tr><tr><td>train/epoch_learning_rate</td><td>████▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_loss</td><td>█▄▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/global_step</td><td>▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇████</td></tr><tr><td>validation/epoch_loss</td><td>█▃▃▂▂▂▃▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>█▂▃▂▂▂▃▃▂▁▂▂▁▁▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▃</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>█▃▃▂▂▂▃▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>█▂▃▂▂▂▃▃▂▁▂▂▁▁▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▃</td></tr><tr><td>validation/global_step</td><td>▁▂▁▁▁▁▁▁▅▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>0.13084</td></tr><tr><td>fold</td><td>2</td></tr><tr><td>global_step</td><td>7950</td></tr><tr><td>loss</td><td>0.1732</td></tr><tr><td>tf_metrics_nmae_log</td><td>0.13024</td></tr><tr><td>train/epoch_learning_rate</td><td>1e-05</td></tr><tr><td>train/epoch_loss</td><td>0.31273</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>0.29127</td></tr><tr><td>train/global_step</td><td>49</td></tr><tr><td>validation/epoch_loss</td><td>0.27181</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>0.24871</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>0.27181</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>0.24871</td></tr><tr><td>validation/global_step</td><td>49</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Synced <strong style=\"color:#cdcd00\">fold_2</strong>: <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/3qiogxhq\" target=\"_blank\">https://wandb.ai/frony/dacon_plant_leaf_weight/runs/3qiogxhq</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 2 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20220515_023139-3qiogxhq/logs</code>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Fold 2 Time (minutes) :  101.864\n","[debug] memory usage:  11996.090 MB\n","@Memory leaked : 3152.890625\n","[debug] memory usage:  11996.090 MB\n","\n","===== Fold 3 =====\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.12.16"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20220515_041333-2hdirj94</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2hdirj94\" target=\"_blank\">fold_3</a></strong> to <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["start training\n"]},{"output_type":"display_data","data":{"text/plain":["0epoch [00:00, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6a6fa4fe2b24e6f91c0bc1a7dd799d1"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["0batch [00:00, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f5d93f6f6eee483c8c4da73f05b7047e"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3775s vs `on_train_batch_end` time: 0.4734s). Check your callbacks.\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3775s vs `on_train_batch_end` time: 0.4734s). Check your callbacks.\n"]},{"output_type":"stream","name":"stdout","text":["end training\n","{'loss': 0.1890655905008316, 'tf_metrics_nmae_log': 0.15228894352912903}\n","NMAE : 0.1484474\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='24.156 MB of 24.156 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=1.0, m…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"262660c7fd8b46fb9a90f2a7783fe040"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>▁</td></tr><tr><td>fold</td><td>▁</td></tr><tr><td>global_step</td><td>▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇████</td></tr><tr><td>loss</td><td>▁</td></tr><tr><td>tf_metrics_nmae_log</td><td>▁</td></tr><tr><td>train/epoch_learning_rate</td><td>█████▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_loss</td><td>█▄▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>█▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/global_step</td><td>▁▁▁▁▂▂▂▃▃▃▃▃▃▄▄▄▅▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇▇███</td></tr><tr><td>validation/epoch_loss</td><td>█▆▄▄▂▂▃▂▂▃▁▂▁▂▁▁▁▂▂▂▁▁▂▂▁▂▁▁▂▂▂▂▂▁▂▁▂▁▂▂</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>█▇▅▃▃▃▄▂▂▃▂▂▂▂▁▁▁▂▂▂▁▁▂▂▁▂▁▂▂▃▂▂▂▂▂▁▂▁▂▂</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>█▆▄▄▂▂▃▂▂▃▁▂▁▂▁▁▁▂▂▂▁▁▂▂▁▂▁▁▂▂▂▂▂▁▂▁▂▁▂▂</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>█▇▅▃▃▃▄▂▂▃▂▂▂▂▁▁▁▂▂▂▁▁▂▂▁▂▁▂▂▃▂▂▂▂▂▁▂▁▂▂</td></tr><tr><td>validation/global_step</td><td>▁▁▁▃▁▃▁▁▁▁▁▁▁▆▁▁▁██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>0.14845</td></tr><tr><td>fold</td><td>3</td></tr><tr><td>global_step</td><td>6837</td></tr><tr><td>loss</td><td>0.18907</td></tr><tr><td>tf_metrics_nmae_log</td><td>0.15229</td></tr><tr><td>train/epoch_learning_rate</td><td>1e-05</td></tr><tr><td>train/epoch_loss</td><td>0.29335</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>0.27827</td></tr><tr><td>train/global_step</td><td>42</td></tr><tr><td>validation/epoch_loss</td><td>0.23219</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>0.21378</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>0.23219</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>0.21378</td></tr><tr><td>validation/global_step</td><td>42</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Synced <strong style=\"color:#cdcd00\">fold_3</strong>: <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2hdirj94\" target=\"_blank\">https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2hdirj94</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 2 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20220515_041333-2hdirj94/logs</code>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Fold 3 Time (minutes) :  92.47\n","[debug] memory usage:  15054.676 MB\n","@Memory leaked : 3058.5859375\n","[debug] memory usage:  15054.676 MB\n","\n","===== Fold 4 =====\n","\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Tracking run with wandb version 0.12.16"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Run data is saved locally in <code>/content/wandb/run-20220515_054605-2ep16w3t</code>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Syncing run <strong><a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2ep16w3t\" target=\"_blank\">fold_4</a></strong> to <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight\" target=\"_blank\">Weights & Biases</a> (<a href=\"https://wandb.me/run\" target=\"_blank\">docs</a>)<br/>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["start training\n"]},{"output_type":"display_data","data":{"text/plain":["0epoch [00:00, ?epoch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9e689883d44348cfa5a190dc2a6f5ca8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["0batch [00:00, ?batch/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"29ebf52100484be498444b6b6418598b"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3869s vs `on_train_batch_end` time: 0.5004s). Check your callbacks.\n"]},{"output_type":"stream","name":"stderr","text":["WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.3869s vs `on_train_batch_end` time: 0.5004s). Check your callbacks.\n"]},{"output_type":"stream","name":"stdout","text":["end training\n","{'loss': 0.18809600174427032, 'tf_metrics_nmae_log': 0.1459011286497116}\n","NMAE : 0.1474064\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Waiting for W&B process to finish... <strong style=\"color:green\">(success).</strong>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["VBox(children=(Label(value='28.587 MB of 28.587 MB uploaded (0.000 MB deduped)\\r'), FloatProgress(value=1.0, m…"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b6cd20d7907f48998cc2180b1d8d3c6c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["<style>\n","    table.wandb td:nth-child(1) { padding: 0 10px; text-align: left ; width: auto;} td:nth-child(2) {text-align: left ; width: 100%}\n","    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: flex-start; width: 100% }\n","    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }\n","    </style>\n","<div class=\"wandb-row\"><div class=\"wandb-col\"><h3>Run history:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>▁</td></tr><tr><td>fold</td><td>▁</td></tr><tr><td>global_step</td><td>▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇███</td></tr><tr><td>loss</td><td>▁</td></tr><tr><td>tf_metrics_nmae_log</td><td>▁</td></tr><tr><td>train/epoch_learning_rate</td><td>████▃▃▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_loss</td><td>█▄▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>█▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>train/global_step</td><td>▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇████</td></tr><tr><td>validation/epoch_loss</td><td>█▇▄▄▂▃▄▂▂▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▂▂▂▂▂▁▂</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>█▇▃▂▂▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▂▂▂▂▂▂▂▂</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>█▇▄▄▂▃▄▂▂▂▂▁▂▂▂▂▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▂▂▂▂▂▁▂</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>█▇▃▂▂▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▂▂▂▂▂▂▂▂</td></tr><tr><td>validation/global_step</td><td>▁▁▁▁▁▁▁▁▁▁▃▃▁▁▁▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁</td></tr></table><br/></div><div class=\"wandb-col\"><h3>Run summary:</h3><br/><table class=\"wandb\"><tr><td>NMAE</td><td>0.14741</td></tr><tr><td>fold</td><td>4</td></tr><tr><td>global_step</td><td>7950</td></tr><tr><td>loss</td><td>0.1881</td></tr><tr><td>tf_metrics_nmae_log</td><td>0.1459</td></tr><tr><td>train/epoch_learning_rate</td><td>1e-05</td></tr><tr><td>train/epoch_loss</td><td>0.30872</td></tr><tr><td>train/epoch_tf_metrics_nmae_log</td><td>0.31107</td></tr><tr><td>train/global_step</td><td>49</td></tr><tr><td>validation/epoch_loss</td><td>0.2167</td></tr><tr><td>validation/epoch_tf_metrics_nmae_log</td><td>0.20436</td></tr><tr><td>validation/evaluation_loss_vs_iterations</td><td>0.2167</td></tr><tr><td>validation/evaluation_tf_metrics_nmae_log_vs_iterations</td><td>0.20436</td></tr><tr><td>validation/global_step</td><td>49</td></tr></table><br/></div></div>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Synced <strong style=\"color:#cdcd00\">fold_4</strong>: <a href=\"https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2ep16w3t\" target=\"_blank\">https://wandb.ai/frony/dacon_plant_leaf_weight/runs/2ep16w3t</a><br/>Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 2 other file(s)"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["Find logs at: <code>./wandb/run-20220515_054605-2ep16w3t/logs</code>"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Fold 4 Time (minutes) :  112.795\n","[debug] memory usage:  17681.938 MB\n","@Memory leaked : 2627.26171875\n"]}],"source":["model_list = []\n","scaler_list = []\n","lstm_scaler_list = []\n","history_list = []\n","fold_metric = []\n","seed_everything()\n","\n","n_folds = 5\n","kfolds_spliter = StratifiedKFold(n_folds, shuffle=True, random_state=8282)\n","\n","start_time_training = time()\n","# fold training\n","for fold, (train_idx, val_idx) in enumerate(kfolds_spliter.split(range(full_y.shape[0]), strat_vec)):\n","    start_mem = memory_usage()\n","    do_fold_training(fold, train_idx, val_idx, None, finetuning=False)\n","    tf.keras.backend.clear_session()\n","    gc.collect()\n","    end_mem = memory_usage()\n","    print(\"@Memory leaked :\", end_mem - start_mem)\n","end_time_training = time()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"NnOGdKSOlbpw"},"outputs":[],"source":["tf.keras.backend.clear_session()\n","wandb.finish()"]},{"cell_type":"markdown","metadata":{"id":"TcZzeIdsifNA"},"source":["# Submission"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zDsblek_S42T"},"outputs":[],"source":["submission = read_csv(folder_path + \"train_test_set/sample_submission.csv\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"aPQ_MyH8CTZc","colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"status":"ok","timestamp":1652600339049,"user_tz":-540,"elapsed":7,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"c0e2e5d1-14c0-4cff-edd8-a46acb53769c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["  img_name  leaf_weight\n","0  001.png            0\n","1  002.png            0\n","2  003.png            0\n","3  004.png            0\n","4  005.png            0"],"text/html":["\n","  <div id=\"df-d204a28d-49fb-4d78-824a-8e68ff460725\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>img_name</th>\n","      <th>leaf_weight</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>001.png</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>002.png</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>003.png</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>004.png</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>005.png</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d204a28d-49fb-4d78-824a-8e68ff460725')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-d204a28d-49fb-4d78-824a-8e68ff460725 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-d204a28d-49fb-4d78-824a-8e68ff460725');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":58}],"source":["submission.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"bP3lvRM74wgs"},"outputs":[],"source":["submission[\"leaf_weight\"] = result_pred[:,0]\n","submission[\"leaf_weight\"][submission[\"leaf_weight\"] <= 0] = (submission[\"leaf_weight\"][submission[\"leaf_weight\"] > 0]).min()\n","submission.to_csv(folder_path + \"architectures/\" + model_name + \"/testResult_\" + model_name + \".csv\", index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"zVk5QO_k3GWh","colab":{"base_uri":"https://localhost:8080/","height":282},"executionInfo":{"status":"ok","timestamp":1652602457938,"user_tz":-540,"elapsed":307,"user":{"displayName":"김영준","userId":"06606532799291918175"}},"outputId":"8a989ee0-dd3a-4c30-8b6b-afe1cc236e6c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<matplotlib.axes._subplots.AxesSubplot at 0x7f37072fcad0>"]},"metadata":{},"execution_count":67},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["submission[\"leaf_weight\"].hist()"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":["bi5RrJ13y11C","4kPoYaEW-VNV","1YabxNE7gPsR","JNEEXszigDeY","NAhgen7zgmM5","gVw1gnJSgDuR","N0VL1Z7a73Rc","LWHjrCl7MrEt","T8aMMvKUNReq","DJ_wQSHffv2d","-dneoNYlf0dp","HtEKbKWG7dnZ","Sv6hj7cT5PR5","dzczjMD_5UbD","ZGkufV4tegkg","M926gqsUf_D9","TGKabM-UoSJh","Esnj5xBcY1DE","eUXv7hPcTnIV","l3OQodx45X8Q"],"machine_shape":"hm","name":"plant_leaf_weight_prediction의 사본","provenance":[],"authorship_tag":"ABX9TyP3vrWlbCJANPb/ofL4mI8/"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"1f95cc9c30c6429580742aee9088bb46":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8493745dbbee42598f9098ec5dad336d","IPY_MODEL_a3fc773df397448a960239092300e9bf","IPY_MODEL_8780eb781a0b459597d417ad005b8546"],"layout":"IPY_MODEL_842eb40364654316ba9f4fa19f6ba303"}},"8493745dbbee42598f9098ec5dad336d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c6ab7130a3a04fb192d244664b2454c0","placeholder":"​","style":"IPY_MODEL_038f4013594e47409af7f96b6a91f949","value":"100%"}},"a3fc773df397448a960239092300e9bf":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3516837e9fab4126bc1e2efb3283b488","max":50,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a1422857fa51444380ab37d1f9788557","value":50}},"8780eb781a0b459597d417ad005b8546":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_05be345fe93145179188e700035cd7f4","placeholder":"​","style":"IPY_MODEL_23fdb52eac2b491d9e9b45400a3ba7c0","value":" 50/50 [1:39:27&lt;00:00, 116.81s/epoch, loss=0.338, tf_metrics_nmae_log=0.335, val_loss=0.217, val_tf_metrics_nmae_log=0.206]"}},"842eb40364654316ba9f4fa19f6ba303":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c6ab7130a3a04fb192d244664b2454c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"038f4013594e47409af7f96b6a91f949":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3516837e9fab4126bc1e2efb3283b488":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a1422857fa51444380ab37d1f9788557":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"05be345fe93145179188e700035cd7f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23fdb52eac2b491d9e9b45400a3ba7c0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8b2282a1f4b741398dd6fa773b9ea319":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f1928f4901ca44afaa62232997b4cfb6","IPY_MODEL_966c188b17074e8584599cbcc67fd3e9","IPY_MODEL_a318ac48a7344692942ce847a153257c"],"layout":"IPY_MODEL_357c8b33e671456b80c17d2fc156cdad"}},"f1928f4901ca44afaa62232997b4cfb6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_70500b3f8fe04d44b4fa0924b517daad","placeholder":"​","style":"IPY_MODEL_3359850c605d40818bedd0c28eb905d3","value":" 99%"}},"966c188b17074e8584599cbcc67fd3e9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_5354c0b533a441f5812f584fee0e1926","max":159,"min":0,"orientation":"horizontal","style":"IPY_MODEL_07db3899ca584f2481206039c35b3b8b","value":159}},"a318ac48a7344692942ce847a153257c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_844e75616b1448d2bb2004a03659a306","placeholder":"​","style":"IPY_MODEL_fee97411def44689ad9e0f5255e1158e","value":" 158/159 [01:25&lt;00:00, 4.11batch/s, loss=0.338, tf_metrics_nmae_log=0.335]"}},"357c8b33e671456b80c17d2fc156cdad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"70500b3f8fe04d44b4fa0924b517daad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3359850c605d40818bedd0c28eb905d3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5354c0b533a441f5812f584fee0e1926":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"07db3899ca584f2481206039c35b3b8b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"844e75616b1448d2bb2004a03659a306":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fee97411def44689ad9e0f5255e1158e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"69bdebaffe354b29b082f57d82496978":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_53ea2619f7d04348b666f6f16028e971","IPY_MODEL_e4e7ff15c9234aa4be41219bdbe5b0cc"],"layout":"IPY_MODEL_b975b73e8c644b1f99c9fc1c14612c09"}},"53ea2619f7d04348b666f6f16028e971":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d5e302ede69a418eb7cacfbd7b379b4a","placeholder":"​","style":"IPY_MODEL_d3764beb3781448aab08db7224f0b77c","value":"31.175 MB of 31.175 MB uploaded (0.000 MB deduped)\r"}},"e4e7ff15c9234aa4be41219bdbe5b0cc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_7e603c8f70c54cfb9b493f3fec91f244","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bc08785a8d354bb8b1d152df0f61c27f","value":1}},"b975b73e8c644b1f99c9fc1c14612c09":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d5e302ede69a418eb7cacfbd7b379b4a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d3764beb3781448aab08db7224f0b77c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7e603c8f70c54cfb9b493f3fec91f244":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bc08785a8d354bb8b1d152df0f61c27f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"79b39875bf2f48c9a8bdfed14b08766d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fe46e5a3eb6842fc8c47b5cfbd514012","IPY_MODEL_4df913b0e3c140369ae6112dc74f120d","IPY_MODEL_6137e5d9f28247b585c4c2ac013063a3"],"layout":"IPY_MODEL_14cb6cffbe8d4157833ad4f3cd7f482a"}},"fe46e5a3eb6842fc8c47b5cfbd514012":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_361fe3d5a9004244aaddc3fd9a06ad12","placeholder":"​","style":"IPY_MODEL_ac9b2ab6f87e476480dbd7aa8162e19b","value":"100%"}},"4df913b0e3c140369ae6112dc74f120d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2b30f8b3cf7348e8a045061438ac7e6c","max":50,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f7b9d8470e8841a68f1379f80e97625a","value":50}},"6137e5d9f28247b585c4c2ac013063a3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cd33b505c9224657b4062529dee49cc1","placeholder":"​","style":"IPY_MODEL_5d3c51ba707444cca061b8fd570c2e43","value":" 50/50 [1:39:25&lt;00:00, 117.49s/epoch, loss=0.307, tf_metrics_nmae_log=0.308, val_loss=0.227, val_tf_metrics_nmae_log=0.223]"}},"14cb6cffbe8d4157833ad4f3cd7f482a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"361fe3d5a9004244aaddc3fd9a06ad12":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ac9b2ab6f87e476480dbd7aa8162e19b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2b30f8b3cf7348e8a045061438ac7e6c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7b9d8470e8841a68f1379f80e97625a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cd33b505c9224657b4062529dee49cc1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5d3c51ba707444cca061b8fd570c2e43":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7223d9f076164bc6be3dd6d633c2104f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5ba9ae8e66fc4a93a9141239d8a38a24","IPY_MODEL_2b705f5e0e01411da336b86bb0127899","IPY_MODEL_ff162150e86a41f39dd0591e4305bd82"],"layout":"IPY_MODEL_f3463ef1095e41dba1f839dbe0b409cf"}},"5ba9ae8e66fc4a93a9141239d8a38a24":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d9cc44bd3ca44a7ba25c15055cf40e87","placeholder":"​","style":"IPY_MODEL_b921c88ff7d84aeda4d950294ae6a9fb","value":" 99%"}},"2b705f5e0e01411da336b86bb0127899":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_46140ceefe76474f9338ee735488a633","max":159,"min":0,"orientation":"horizontal","style":"IPY_MODEL_6fb48af3baea4317a76349fdd970f039","value":159}},"ff162150e86a41f39dd0591e4305bd82":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_df9864cf00e94507908a9aa779fd0e4f","placeholder":"​","style":"IPY_MODEL_56157cb8b0274a6ba1f4259feab22b42","value":" 158/159 [01:26&lt;00:00, 4.15batch/s, loss=0.306, tf_metrics_nmae_log=0.307]"}},"f3463ef1095e41dba1f839dbe0b409cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d9cc44bd3ca44a7ba25c15055cf40e87":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b921c88ff7d84aeda4d950294ae6a9fb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"46140ceefe76474f9338ee735488a633":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6fb48af3baea4317a76349fdd970f039":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"df9864cf00e94507908a9aa779fd0e4f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"56157cb8b0274a6ba1f4259feab22b42":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"db94a5acbdd5402cb432bb075572648f":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_e8e453abbc6346059fbf188dbb453999","IPY_MODEL_f05aca29b8fc422691753736b25b3f79"],"layout":"IPY_MODEL_34d747fdf54f4d2e8865eeeb60271472"}},"e8e453abbc6346059fbf188dbb453999":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2bf65a0e5b0849289a582d0138ed60d4","placeholder":"​","style":"IPY_MODEL_cabee26d5ec94f2aa5fbb1c8c5d3a213","value":"31.145 MB of 31.145 MB uploaded (0.000 MB deduped)\r"}},"f05aca29b8fc422691753736b25b3f79":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_a5be84d979a64c8ea42951c0ec74fec4","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4ea32b84d4d146249e07692f792571f0","value":1}},"34d747fdf54f4d2e8865eeeb60271472":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2bf65a0e5b0849289a582d0138ed60d4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cabee26d5ec94f2aa5fbb1c8c5d3a213":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a5be84d979a64c8ea42951c0ec74fec4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4ea32b84d4d146249e07692f792571f0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7c417d68e20f4be089d077554bc2248a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cabc2f56df8e4c3db5feef07efba16bd","IPY_MODEL_59e6e16850714539b20be1c14165f28f","IPY_MODEL_5bca88dd1b8549368e97f962a9df1415"],"layout":"IPY_MODEL_fa9a13ab95ee414aa9d528e98abe7b07"}},"cabc2f56df8e4c3db5feef07efba16bd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_663532c06ede48968e1cb005b855634d","placeholder":"​","style":"IPY_MODEL_e5d58d69d0864b378ee088e6e56900db","value":"100%"}},"59e6e16850714539b20be1c14165f28f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7b1504d38b214865a10c6590cb67267c","max":50,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b78f010248af4f0eb71c65f387978063","value":50}},"5bca88dd1b8549368e97f962a9df1415":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a9259d84c9e04a94a6c02bf4e1d70187","placeholder":"​","style":"IPY_MODEL_d7d2058e3e914e65a87c60bf5d2a6f6b","value":" 50/50 [1:39:01&lt;00:00, 119.43s/epoch, loss=0.313, tf_metrics_nmae_log=0.291, val_loss=0.272, val_tf_metrics_nmae_log=0.249]"}},"fa9a13ab95ee414aa9d528e98abe7b07":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"663532c06ede48968e1cb005b855634d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e5d58d69d0864b378ee088e6e56900db":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7b1504d38b214865a10c6590cb67267c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b78f010248af4f0eb71c65f387978063":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a9259d84c9e04a94a6c02bf4e1d70187":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d7d2058e3e914e65a87c60bf5d2a6f6b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"be7b2dadb6684b10afa1313cb8e651ef":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3e16c0d575294b8dabdaa572eb2795d7","IPY_MODEL_ce864be4de9c4817a0556a73da366eea","IPY_MODEL_0111366461944f709bd75f7cfb6c9d2e"],"layout":"IPY_MODEL_f95ff3a784dc410fa763c351d6035201"}},"3e16c0d575294b8dabdaa572eb2795d7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0392a83434ad47fdabb28d95f540a801","placeholder":"​","style":"IPY_MODEL_4e279d3b22404a99b163449253d84c93","value":" 99%"}},"ce864be4de9c4817a0556a73da366eea":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_37f7229ddf794f3a98208eee0f29f82e","max":159,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2ca7a7d7c7ed45e08af431a338a68947","value":159}},"0111366461944f709bd75f7cfb6c9d2e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_02732c1bd3574d85a080013f8f859a7a","placeholder":"​","style":"IPY_MODEL_52f05410d0974ce3ba669fb82b6f4f26","value":" 158/159 [01:27&lt;00:00, 3.94batch/s, loss=0.313, tf_metrics_nmae_log=0.292]"}},"f95ff3a784dc410fa763c351d6035201":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0392a83434ad47fdabb28d95f540a801":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4e279d3b22404a99b163449253d84c93":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"37f7229ddf794f3a98208eee0f29f82e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ca7a7d7c7ed45e08af431a338a68947":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"02732c1bd3574d85a080013f8f859a7a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52f05410d0974ce3ba669fb82b6f4f26":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b83b8ea46e7a48d2ae478d6b14e7ccfe":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_1a80cb470ab94d7e9dc82b4986c7bb4e","IPY_MODEL_0d2eb57c55584373aea64a1f42876904"],"layout":"IPY_MODEL_e71afcb7a1b245c693d1872d5de739ff"}},"1a80cb470ab94d7e9dc82b4986c7bb4e":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5e8c1f0402c54ad9b266e0a62a797065","placeholder":"​","style":"IPY_MODEL_e2951c11a7154eb0922c1a71dd2aa187","value":"31.145 MB of 31.145 MB uploaded (0.000 MB deduped)\r"}},"0d2eb57c55584373aea64a1f42876904":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_c036bad1c8a54f2ea201ec1ee09c751f","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_22088a7dc1354a728d830855d6536c32","value":1}},"e71afcb7a1b245c693d1872d5de739ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5e8c1f0402c54ad9b266e0a62a797065":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e2951c11a7154eb0922c1a71dd2aa187":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c036bad1c8a54f2ea201ec1ee09c751f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"22088a7dc1354a728d830855d6536c32":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b6a6fa4fe2b24e6f91c0bc1a7dd799d1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4b07b3f3f8784db4a515853eb7d63c82","IPY_MODEL_efca97845876476c8c09fd2e2fb3fb71","IPY_MODEL_7ab6562d740b42acbe9abc4d1de91fcf"],"layout":"IPY_MODEL_ebeff912a17a44d3894f1282d14d1c7a"}},"4b07b3f3f8784db4a515853eb7d63c82":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0186d2df9f0a4023a1dc3b59cc7d6dd8","placeholder":"​","style":"IPY_MODEL_5136fab29070495592cb727388b6945f","value":" 86%"}},"efca97845876476c8c09fd2e2fb3fb71":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"danger","description":"","description_tooltip":null,"layout":"IPY_MODEL_3baf3b450c564b99ad4fbee86256e4c0","max":50,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a90f7cb057224acbbc4931976e136347","value":43}},"7ab6562d740b42acbe9abc4d1de91fcf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d9bcd9440ab84567ac995ff05321380e","placeholder":"​","style":"IPY_MODEL_baeac31562d24768ba2c5153169f12e3","value":" 43/50 [1:29:31&lt;14:30, 124.39s/epoch, loss=0.293, tf_metrics_nmae_log=0.278, val_loss=0.232, val_tf_metrics_nmae_log=0.214]"}},"ebeff912a17a44d3894f1282d14d1c7a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0186d2df9f0a4023a1dc3b59cc7d6dd8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5136fab29070495592cb727388b6945f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3baf3b450c564b99ad4fbee86256e4c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a90f7cb057224acbbc4931976e136347":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d9bcd9440ab84567ac995ff05321380e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"baeac31562d24768ba2c5153169f12e3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f5d93f6f6eee483c8c4da73f05b7047e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e62f2596d6e44edfb8454568c1d61223","IPY_MODEL_ee310051e53d45819c025a57138751ce","IPY_MODEL_2cc0afa266774b25a9ec4f8b9b284b0a"],"layout":"IPY_MODEL_6856b788c59041519e863f5633e278c9"}},"e62f2596d6e44edfb8454568c1d61223":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b974694457eb4c62b3ac9b06a9f3913d","placeholder":"​","style":"IPY_MODEL_064aa3fce836472f9254dcd45a72d7ec","value":" 99%"}},"ee310051e53d45819c025a57138751ce":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_05ef9678741f49b280b9647d795d3666","max":159,"min":0,"orientation":"horizontal","style":"IPY_MODEL_763c2e18aa0349c897ad40c0e26a99fb","value":159}},"2cc0afa266774b25a9ec4f8b9b284b0a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b9e549ba33c644adbe497ba1cb94fc06","placeholder":"​","style":"IPY_MODEL_44a3c6eceae24abbb2949412457168d1","value":" 158/159 [01:31&lt;00:00, 3.83batch/s, loss=0.293, tf_metrics_nmae_log=0.279]"}},"6856b788c59041519e863f5633e278c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b974694457eb4c62b3ac9b06a9f3913d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"064aa3fce836472f9254dcd45a72d7ec":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"05ef9678741f49b280b9647d795d3666":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"763c2e18aa0349c897ad40c0e26a99fb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b9e549ba33c644adbe497ba1cb94fc06":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"44a3c6eceae24abbb2949412457168d1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"262660c7fd8b46fb9a90f2a7783fe040":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_921fc3788d6a48e0a7dfa7e127ac6267","IPY_MODEL_7d750296daa04b96838e235804651511"],"layout":"IPY_MODEL_c4c3b480295a412cb22cf81cddd047ee"}},"921fc3788d6a48e0a7dfa7e127ac6267":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_aa9269b30db34c0fad26f88e7c44fcaa","placeholder":"​","style":"IPY_MODEL_5d5d17f4f31a4196aca0188787ed5057","value":"28.349 MB of 28.349 MB uploaded (0.000 MB deduped)\r"}},"7d750296daa04b96838e235804651511":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_16b6b1dc3bbc4ecc996d4ec7078ad565","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bcff9e0568914d4e8a4cfad58dd75eab","value":1}},"c4c3b480295a412cb22cf81cddd047ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aa9269b30db34c0fad26f88e7c44fcaa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5d5d17f4f31a4196aca0188787ed5057":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"16b6b1dc3bbc4ecc996d4ec7078ad565":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bcff9e0568914d4e8a4cfad58dd75eab":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9e689883d44348cfa5a190dc2a6f5ca8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ec00b31c1d2e4455887c038019148395","IPY_MODEL_b403a0d059c84e2faff349ab10cd38e1","IPY_MODEL_647f8f7baa224024b233672903aaf0e2"],"layout":"IPY_MODEL_c0ba029a5f2d4f5891d79aa0520f6b1f"}},"ec00b31c1d2e4455887c038019148395":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_801cf67866ab4e6287ec9e0b9468e0c5","placeholder":"​","style":"IPY_MODEL_cea131f3b2a44dbe9252475b0c5a93f4","value":"100%"}},"b403a0d059c84e2faff349ab10cd38e1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_df63696154df4208893536ba4be286d3","max":50,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cdfb5939a9ba4d57b7fc863b69df2458","value":50}},"647f8f7baa224024b233672903aaf0e2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_917d7649d9d8468198e342d4d6a89186","placeholder":"​","style":"IPY_MODEL_274d973dd7ef4f77aaafe48817de3a1a","value":" 50/50 [1:48:57&lt;00:00, 132.23s/epoch, loss=0.309, tf_metrics_nmae_log=0.311, val_loss=0.217, val_tf_metrics_nmae_log=0.204]"}},"c0ba029a5f2d4f5891d79aa0520f6b1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"801cf67866ab4e6287ec9e0b9468e0c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cea131f3b2a44dbe9252475b0c5a93f4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"df63696154df4208893536ba4be286d3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cdfb5939a9ba4d57b7fc863b69df2458":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"917d7649d9d8468198e342d4d6a89186":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"274d973dd7ef4f77aaafe48817de3a1a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"29ebf52100484be498444b6b6418598b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fb3885143aaf4b80b0b677e2c2d4f88e","IPY_MODEL_c40dfecfe0ce49b5b4e9409df2ac091f","IPY_MODEL_f5e0588347ae472496d973a97614117f"],"layout":"IPY_MODEL_c83aa2cc77eb4689923e757cca0804eb"}},"fb3885143aaf4b80b0b677e2c2d4f88e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ca7c0136165540e89337c62b1057a9f4","placeholder":"​","style":"IPY_MODEL_27dca7c2bb5f4322a89d2c6233e8d544","value":"100%"}},"c40dfecfe0ce49b5b4e9409df2ac091f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_951eb4b0528d4ed6a54a194fde1c6bdc","max":159,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2772f6635cbc47e48064c850d6755e6f","value":159}},"f5e0588347ae472496d973a97614117f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b679ec2de9ff470a8a23251586da9ce7","placeholder":"​","style":"IPY_MODEL_a7c396acbd9f4b94b4e682cae5fe7cdf","value":" 159/159 [01:34&lt;00:00, 4.67batch/s, loss=0.309, tf_metrics_nmae_log=0.311]"}},"c83aa2cc77eb4689923e757cca0804eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ca7c0136165540e89337c62b1057a9f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"27dca7c2bb5f4322a89d2c6233e8d544":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"951eb4b0528d4ed6a54a194fde1c6bdc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2772f6635cbc47e48064c850d6755e6f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b679ec2de9ff470a8a23251586da9ce7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a7c396acbd9f4b94b4e682cae5fe7cdf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b6cd20d7907f48998cc2180b1d8d3c6c":{"model_module":"@jupyter-widgets/controls","model_name":"VBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"VBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"VBoxView","box_style":"","children":["IPY_MODEL_20b8c3c9ec184a0193c5f41ad7936f08","IPY_MODEL_c0c507a7f5204c38a8cd634896f60959"],"layout":"IPY_MODEL_f57ee7d895d84605902d5240063f48bb"}},"20b8c3c9ec184a0193c5f41ad7936f08":{"model_module":"@jupyter-widgets/controls","model_name":"LabelModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"LabelModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"LabelView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f92b45c949c748d7b3434faab561a613","placeholder":"​","style":"IPY_MODEL_7246bbd2333a4a4d82cbeebd5b4e0da5","value":"31.147 MB of 31.147 MB uploaded (0.000 MB deduped)\r"}},"c0c507a7f5204c38a8cd634896f60959":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_d6c0719fb6644d859b4b09d3390b708d","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_34218108cbfb4d95afa37b62829dcada","value":1}},"f57ee7d895d84605902d5240063f48bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f92b45c949c748d7b3434faab561a613":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7246bbd2333a4a4d82cbeebd5b4e0da5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d6c0719fb6644d859b4b09d3390b708d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"34218108cbfb4d95afa37b62829dcada":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}}}}},"nbformat":4,"nbformat_minor":0}